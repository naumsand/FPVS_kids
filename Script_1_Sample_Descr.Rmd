---
title: "Sample description"
output: 
  rmdformats::material:
    highlight: kate
    css: web_style.css
    thumbnails: false
    lightbox: true
    gallery: true
    cards: true
    self_contained: no
    number_sections: no
    code_folding: hide
    fig_caption: yes
---

```{r setup, include=FALSE}

# Set general settings for Markdown file 
  options(max.print="75")

  knitr::opts_chunk$set(echo=TRUE,
  	             #cache=TRUE,
                 prompt=FALSE,
                 tidy=TRUE,
                 comment=NA,
                 message=FALSE,
                 warning=FALSE,
                 results = FALSE,
  	             fig.align="center")
  knitr::opts_knit$set(width=75)

# Swipe environment
  rm(list=ls())
  
# Load packages
  library(eeptools)
  library(expss)
  library(gtsummary)
  library(miceadds)
  library(rmdformats)
  library(summarytools)
  library(XLConnect)
  


  
      
```


```{r, load_data, include=FALSE}
  
# Load questionnaire data
  qn_data = readWorksheetFromFile("./data/qn_data.xlsx",
                             sheet = 1,
                             startCol = 1,
                             endCol = 0)
  
# Re-code gender
  qn_data$sex[qn_data$sex == 1] = "Male"
  qn_data$sex[qn_data$sex == 2] = "Female"
  
# Re-code training group
  qn_data$group[qn_data$group == "ZE"] = "TG"
  qn_data$group[qn_data$group == "SB"] = "CG"

# Define N/A data
  qn_data[qn_data==-99] = NA
  
# Calculate age (Extract age from birth/test date)
  qn_data$age = as.numeric(cbind(age_calc(as.Date(qn_data$birth_date),
                                     as.Date(qn_data$test_date), units = "years"))) 
  
# Exclude participants with no FPVS max-face data
  qn_data = subset(qn_data, EEG_Max == 1)
```

<div align="center">

```{r demog_table, results = 'asis', align = "center"}

# http://www.danieldsjoberg.com/gtsummary/

# Select srceening variables
  qn_data_demog = subset(qn_data, select = c(group, age, sex, T_Self_Report, train_weeks, CPM, PPVT_perc))

# Apply labels
  qn_data_demog = apply_labels(qn_data_demog,
                      age = "Age",
                      sex = "Sex",
                      PPVT_perc = "PPVT (percentiles)",
                      T_Self_Report = "Training time (min)",
                      train_weeks = "Training duration (weeks)")

# Prepare table
  demog_table =
    tbl_summary(
      qn_data_demog,
      by = group, # split table by group
      missing = "no" # don't list missing data separately
    ) %>%
    add_n() %>% # add column with total number of non-missing observations
    add_p() %>% # test for a difference between groups
    modify_header(label = "**Variable**") %>% # update the column header
    bold_labels()
  
# Print table 
  demog_table
  
```

</div>
