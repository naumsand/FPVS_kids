<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

    
    
    <title>grad-int</title>
    <!-- Material Design fonts -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">

        <script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
        <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <script src="site_libs/navigation-1.1/codefolding.js"></script>
        <link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
        <script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
        <link href="site_libs/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
        <link href="site_libs/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap_material-0.1/material.min.js"></script>
        <script src="site_libs/bootstrap_material-0.1/ripples.min.js"></script>
        <link href="site_libs/material-0.1/material.css" rel="stylesheet" />
        <script src="site_libs/material-0.1/material.js"></script>
        <script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
        <link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
        <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
        <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
        <link rel="stylesheet" href="web_style.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
        <script>
      $(document).ready(function () {
	  	  	  window.initializeCodeFolding("hide" === "show");
	        });
    </script>
    
    <!-- code download -->
    

    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .pages .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .pages .tabset-dropdown > .nav-tabs > li.active > a {
	  background-color: transparent !important;
	  color: #000000 !important;
      }
      
      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
	  color: #00A698 !important;
	  font-weight: 300 !important;
	  font-size: 14px;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
      }
    </style>
    
</head>

<body>

  <div class="header-panel shadow z-2">
    <div class="container-fluid">
      <div class="row">
        <div class="col-xs-3">
	  	  <div id="header">
	    <h1 class="title">grad-int</h1>
	    	    	    	  </div>
	  	</div>
      </div>
    </div>
  </div>
  
  <div class="container-fluid main-container">
    <div class="row">

<nav class="col-xs-3 menu">
<div id="toc">
<ul>
<li><a href="#select-rois">Select ROIs</a></li>
<li><a href="#frequency-domain-analysis">Frequency-domain analysis</a></li>
<li><a href="#time-domain-analyses">Time-domain analyses</a></li>
<li><a href="#session-info">Session info</a></li>
</ul>
</div>
</nav>
      
<div class="pages col-xs-9">

        
<div class="row">

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Introduction
  </a>
</li>
<li>
  <a href="Script_1_Sample_Descr.html">
    <span class="glyphicon glyphicon glyphicon glyphicon-education"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="Script_2_FPVS_Behav.html">
    <span class="glyphicon glyphicon glyphicon glyphicon-hand-up"></span>
     
    ERT
  </a>
</li>
<li>
  <a href="Script_3_Max_Int.html">
    <span class="glyphicon glyphicon glyphicon glyphicon-eye-open"></span>
     
    max-int
  </a>
</li>
<li>
  <a href="Script_4_Grad_Int.html">
    <span class="glyphicon glyphicon glyphicon glyphicon-eye-close"></span>
     
    grad-int
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://osf.io/8vuwt/">
    <span class="ai ai ai ai-osf ai-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:sandra.naumann@hu-berlin.de">
    <span class="fas fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">
</div>

    
<div class="row">

<div class="col-xs-10">
<div id="select-rois" class="section level1 tabset tabset-pills">
<h1 class="tabset tabset-pills">Select ROIs</h1>
<div id="z-scores-base-response" class="section level2">
<h2>Z-scores: Base response</h2>
<p>We examined grand-averaged Z-scores separated for base and expression change response (based on Leleu et al., 2018) to identify at which channel the FFT power was largest to decide for ROIs (blue indicates largest Z-scores):</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="co"># Separate and order for base and expression change response</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>ga_z_score_base =<span class="st"> </span>ga_z_score_chan[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)]</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a>ga_z_score_base =<span class="st"> </span>ga_z_score_base[<span class="kw">with</span>(ga_z_score_base, <span class="kw">order</span>(<span class="op">-</span>base)), ]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="co"># https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="co"># Mark channels with very large Z-scores for odd and base condition</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a>ga_z_score_base <span class="op">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">base =</span> <span class="kw">cell_spec</span>(base, <span class="st">&quot;html&quot;</span>, <span class="dt">color =</span> <span class="kw">ifelse</span>(base <span class="op">&gt;</span><span class="st"> </span><span class="dv">8</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">kable</span>(<span class="dt">format =</span> <span class="st">&quot;html&quot;</span>, <span class="dt">escape =</span> F) <span class="op">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">position =</span> <span class="st">&quot;center&quot;</span>, </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a>        <span class="dt">font_size =</span> <span class="dv">10</span>, <span class="dt">fixed_thead =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Channel
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
base
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
40
</td>
<td style="text-align:left;">
O1
</td>
<td style="text-align:left;">
<span style="     color: blue !important;">14.5498488996922</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
39
</td>
<td style="text-align:left;">
PO8
</td>
<td style="text-align:left;">
<span style="     color: blue !important;">10.9111753728604</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
38
</td>
<td style="text-align:left;">
PO7
</td>
<td style="text-align:left;">
<span style="     color: blue !important;">9.75235924886213</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
PO10
</td>
<td style="text-align:left;">
<span style="     color: blue !important;">8.47310030195341</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
PO4
</td>
<td style="text-align:left;">
<span style="     color: black !important;">7.96460287988708</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
33
</td>
<td style="text-align:left;">
P8
</td>
<td style="text-align:left;">
<span style="     color: black !important;">7.77607174904427</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
PO9
</td>
<td style="text-align:left;">
<span style="     color: black !important;">7.31170971925871</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
32
</td>
<td style="text-align:left;">
P7
</td>
<td style="text-align:left;">
<span style="     color: black !important;">6.01731613878999</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
36
</td>
<td style="text-align:left;">
PO3
</td>
<td style="text-align:left;">
<span style="     color: black !important;">5.83202962048895</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
29
</td>
<td style="text-align:left;">
Pz
</td>
<td style="text-align:left;">
<span style="     color: black !important;">4.94444951921128</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
31
</td>
<td style="text-align:left;">
P4
</td>
<td style="text-align:left;">
<span style="     color: black !important;">4.67396043260194</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
Cz
</td>
<td style="text-align:left;">
<span style="     color: black !important;">4.32700149041584</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
FC2
</td>
<td style="text-align:left;">
<span style="     color: black !important;">4.2425823046189</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
AF3
</td>
<td style="text-align:left;">
<span style="     color: black !important;">4.11544420415133</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
FC1
</td>
<td style="text-align:left;">
<span style="     color: black !important;">4.02638456189964</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
F3
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.74722590863583</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
Fz
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.68311877974947</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
A2
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.65736517521642</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
27
</td>
<td style="text-align:left;">
TP7
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.62152107711637</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
AF4
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.56282613578983</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Fp1
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.47280322058125</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
C4
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.38771507468713</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
FC6
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.25486465235288</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
28
</td>
<td style="text-align:left;">
TP8
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.25233962401415</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
F8
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.24849408374421</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Fp2
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.24443639448464</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
C3
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.2023389288058</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
A1
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.19285980092106</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
26
</td>
<td style="text-align:left;">
CP6
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.18882475372415</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
F4
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.1865575063221</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
FC5
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.14932791721017</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
30
</td>
<td style="text-align:left;">
P3
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.09166014913335</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
F7
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.08197863874955</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
41
</td>
<td style="text-align:left;">
O2
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.86020833000036</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
FT8
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.756145875865</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
CP2
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.66095211713574</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
FT7
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.62130333374915</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
42
</td>
<td style="text-align:left;">
Oz
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.45828059470683</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
T8
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.38915394701682</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
CP1
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.85456187630452</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
T7
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.80933517819327</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
CP5
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.70576976600312</span>
</td>
</tr>
</tbody>
</table>
</div>
<div id="z-scores-expression-change-response" class="section level2">
<h2>Z-scores: Expression change response</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="co"># Separate and order for base and expression change response</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>ga_z_score_expr =<span class="st"> </span>ga_z_score_chan[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a>ga_z_score_expr =<span class="st"> </span>ga_z_score_expr[<span class="kw">with</span>(ga_z_score_expr, <span class="kw">order</span>(<span class="op">-</span>expr)), ]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>ga_z_score_expr <span class="op">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">expr =</span> <span class="kw">cell_spec</span>(expr, <span class="st">&quot;html&quot;</span>, <span class="dt">color =</span> <span class="kw">ifelse</span>(expr <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="st">    </span><span class="kw">kable</span>(<span class="dt">format =</span> <span class="st">&quot;html&quot;</span>, <span class="dt">escape =</span> F) <span class="op">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&quot;striped&quot;</span>, <span class="st">&quot;hover&quot;</span>, <span class="st">&quot;responsive&quot;</span>), <span class="dt">position =</span> <span class="st">&quot;center&quot;</span>, </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>        <span class="dt">font_size =</span> <span class="dv">10</span>, <span class="dt">fixed_thead =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="table table-striped table-hover table-responsive" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Channel
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
expr
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
40
</td>
<td style="text-align:left;">
O1
</td>
<td style="text-align:left;">
<span style="     color: blue !important;">7.0903242407897</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
39
</td>
<td style="text-align:left;">
PO8
</td>
<td style="text-align:left;">
<span style="     color: blue !important;">5.41508371720947</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
38
</td>
<td style="text-align:left;">
PO7
</td>
<td style="text-align:left;">
<span style="     color: blue !important;">4.40906235859895</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
PO10
</td>
<td style="text-align:left;">
<span style="     color: blue !important;">4.28855978564821</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
33
</td>
<td style="text-align:left;">
P8
</td>
<td style="text-align:left;">
<span style="     color: blue !important;">4.1554561313826</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
PO4
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.8805388494761</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
PO9
</td>
<td style="text-align:left;">
<span style="     color: black !important;">3.32236989898111</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
32
</td>
<td style="text-align:left;">
P7
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.86821193384361</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
36
</td>
<td style="text-align:left;">
PO3
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.77838417655512</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
31
</td>
<td style="text-align:left;">
P4
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.65526306658362</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
29
</td>
<td style="text-align:left;">
Pz
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.41475360582353</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
AF3
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.40846676974111</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
FC6
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.38560436697616</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
FC2
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.37580540869817</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
AF4
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.36528992679043</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
C4
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.30235424621935</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
Cz
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.27623655287456</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
F7
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.21940867979595</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Fp2
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.21408646693438</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
Fz
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.20765821106777</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
A2
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.16922626981036</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
Fp1
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.15607183940131</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
F8
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.1476069601974</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
41
</td>
<td style="text-align:left;">
O2
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.13923194977793</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
FC1
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.12437874644583</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
26
</td>
<td style="text-align:left;">
CP6
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.09533816344302</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
FC5
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.07888054448806</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
F3
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.06303033937404</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
FT8
</td>
<td style="text-align:left;">
<span style="     color: black !important;">2.02417810431995</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
F4
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.97361657034786</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
28
</td>
<td style="text-align:left;">
TP8
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.92572922976101</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
C3
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.77996411861957</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
T8
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.7440589125287</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
27
</td>
<td style="text-align:left;">
TP7
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.68786191959973</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
CP2
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.68367270646314</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
FT7
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.63286601169727</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
CP1
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.5622403255173</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
A1
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.54994620996047</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
30
</td>
<td style="text-align:left;">
P3
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.49383643687119</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
CP5
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.31310070139428</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
T7
</td>
<td style="text-align:left;">
<span style="     color: black !important;">1.17891572996085</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
42
</td>
<td style="text-align:left;">
Oz
</td>
<td style="text-align:left;">
<span style="     color: black !important;">0.985755004466565</span>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="frequency-domain-analysis" class="section level1 tabset">
<h1 class="tabset">Frequency-domain analysis</h1>
<div id="signal-to-noise-ratio" class="section level2">
<h2>Signal-to-noise-ratio</h2>
<div id="snr-by-emotion" class="section level3">
<h3>SNR by emotion</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co"># For the plot: #</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="co"># https://mran.microsoft.com/snapshot/2016-03-19/web/packages/ggspectra/vignettes/user-guide.html</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="co">## 20 % intensity</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>grad_snr_twent_hap =<span class="st"> </span><span class="kw">subset</span>(grad_snr_twent, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a>snr_hap_twent =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, grad_snr_twent_hap, mean)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a>grad_snr_twent_ang =<span class="st"> </span><span class="kw">subset</span>(grad_snr_twent, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a>snr_ang_twent =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, grad_snr_twent_ang, mean)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a>grad_twent_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;20%&#39;)+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_twent, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#000000&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_twent, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#0098ff&quot;</span>, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">19</span>, <span class="dv">6</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a>    <span class="dv">19</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a>    <span class="fl">3.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency (Hz)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">20</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a>    <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a><span class="co"># axis.title.x = element_blank())</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a>grad_twent_hap</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/SNR_plot_hap_ang-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_twent_happy_angry.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="co">## 100% intensity</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>grad_snr_oneh_hap =<span class="st"> </span><span class="kw">subset</span>(grad_snr_oneh, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>snr_hap_oneh =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, grad_snr_oneh_hap, mean)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a>grad_snr_oneh_ang =<span class="st"> </span><span class="kw">subset</span>(grad_snr_oneh, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a>snr_ang_oneh =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, grad_snr_oneh_ang, mean)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a>grad_oneh_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;20%&#39;)+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#000000&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#0098ff&quot;</span>, </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">19</span>, <span class="dv">6</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a>    <span class="dv">19</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a>    <span class="fl">3.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency (Hz)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">20</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true"></a>    <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true"></a><span class="co"># axis.title.x = element_blank())</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true"></a></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true"></a>grad_oneh_hap</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/SNR_plot_hap_ang-2.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_oneh_happy_angry.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a>lim_<span class="dv">1</span> =<span class="st"> </span><span class="fl">0.8</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>lim_<span class="dv">2</span> =<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a><span class="co"># For the plot: #</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a><span class="co"># https://mran.microsoft.com/snapshot/2016-03-19/web/packages/ggspectra/vignettes/user-guide.html</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a><span class="co">## 20 % intensity</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a>grad_snr_twent_hap =<span class="st"> </span><span class="kw">subset</span>(grad_snr_twent, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a>snr_hap_twent =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, grad_snr_twent_hap, mean)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true"></a>grad_snr_twent_ang =<span class="st"> </span><span class="kw">subset</span>(grad_snr_twent, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true"></a>snr_ang_twent =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, grad_snr_twent_ang, mean)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true"></a>grad_twent_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;100%&#39;)+</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> grad_snr_twent_ang, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#000000&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>, </span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_twent, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#0098ff&quot;</span>, </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true"></a>    <span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true"></a>    lim_<span class="dv">2</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency (Hz)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">30</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true"></a>    <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true"></a><span class="co"># axis.title.x = element_blank())</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true"></a>grad_twent_hap</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/SNR_plot_hap_ang_zoom-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_twent_happy_angry_zoom.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a><span class="co">## 100% intensity</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>grad_snr_oneh_hap =<span class="st"> </span><span class="kw">subset</span>(grad_snr_oneh, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>snr_hap_oneh =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, grad_snr_oneh_hap, mean)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a>grad_snr_oneh_ang =<span class="st"> </span><span class="kw">subset</span>(grad_snr_oneh, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a>snr_ang_oneh =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, grad_snr_oneh_ang, mean)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a>grad_oneh_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;100%&#39;)+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> grad_snr_oneh_ang, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#000000&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>, </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#0098ff&quot;</span>, </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true"></a>    <span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true"></a>    lim_<span class="dv">2</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency (Hz)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, </span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">30</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true"></a>    <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true"></a><span class="co"># axis.title.x = element_blank())</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true"></a>grad_oneh_hap</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/SNR_plot_hap_ang_zoom-2.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_oneh_happy_angry_zoom.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
</div>
<div id="snr-by-group-emotion" class="section level3">
<h3>SNR by group / emotion</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co"># For the plot: #</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a><span class="co"># https://mran.microsoft.com/snapshot/2016-03-19/web/packages/ggspectra/vignettes/user-guide.html</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a><span class="co">## 20 % intensity</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a>twent_snr_hap_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_twent_ze, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a>snr_hap_ze_twent =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, twent_snr_hap_ze, mean)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a>twent_snr_hap_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_twent_ct, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a>snr_hap_ct_twent =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, twent_snr_hap_ct, mean)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a>grad_twent_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;20%&#39;)+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ze_twent, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ze_twent, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">80</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ct_twent, </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ct_twent, </span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">80</span>, </span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">19</span>, <span class="dv">6</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true"></a>    <span class="dv">19</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true"></a>    <span class="fl">3.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency (Hz)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, </span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">25</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true"></a>    <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true"></a><span class="co"># axis.title.x = element_blank())</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true"></a>grad_twent_hap</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_twent_happy.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true"></a><span class="co">## 40% intensity</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true"></a></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true"></a>fort_snr_hap_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_fort_ze, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true"></a>snr_hap_ze_fort =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, fort_snr_hap_ze, mean)</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true"></a>fort_snr_hap_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_fort_ct, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true"></a>snr_hap_ct_fort =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, fort_snr_hap_ct, mean)</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true"></a></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true"></a>grad_fort_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;40%&#39;)+</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ze_fort, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ze_fort, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">70</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ct_fort, </span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ct_fort, </span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">70</span>, </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">19</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, </span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true"></a>    <span class="dv">19</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, </span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true"></a>    <span class="fl">3.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># xlab ( &#39;Frequency (Hz)&#39;) +</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true"></a><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), </span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true"></a>    <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true"></a></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true"></a><span class="co">## 70% intensity</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true"></a></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true"></a>sixt_snr_hap_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_sixt_ze, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true"></a>snr_hap_ze_sixt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, sixt_snr_hap_ze, mean)</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true"></a></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true"></a>sixt_snr_hap_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_sixt_ct, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true"></a>snr_hap_ct_sixt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, sixt_snr_hap_ct, mean)</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true"></a></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true"></a>grad_sixt_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;70%&#39;)+</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ze_sixt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ze_sixt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">70</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ct_sixt, </span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ct_sixt, </span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">70</span>, </span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">19</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, </span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true"></a>    <span class="dv">19</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, </span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true"></a>    <span class="fl">3.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># xlab ( &#39;Frequency (Hz)&#39;) +</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true"></a><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), </span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true"></a>    <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true"></a></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true"></a><span class="co">## 80 % intensity</span></span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true"></a></span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true"></a>eigt_snr_hap_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_eigt_ze, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true"></a>snr_hap_ze_eigt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, eigt_snr_hap_ze, mean)</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true"></a></span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true"></a>eigt_snr_hap_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_eigt_ct, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true"></a>snr_hap_ct_eigt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, eigt_snr_hap_ct, mean)</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true"></a></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true"></a>grad_eigt_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;80%&#39;)+</span></span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ze_eigt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ze_eigt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">span =</span> <span class="dv">70</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ct_eigt, </span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ct_eigt, </span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">span =</span> <span class="dv">70</span>, </span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">19</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, </span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true"></a>    <span class="dv">19</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, </span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true"></a>    <span class="fl">3.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># xlab ( &#39;Frequency (Hz)&#39;) +</span></span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true"></a><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), </span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true"></a>    <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true"></a></span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true"></a><span class="co">## 100% intensity</span></span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true"></a></span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true"></a>oneh_snr_hap_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_oneh_ze, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true"></a>snr_hap_ze_oneh =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, oneh_snr_hap_ze, mean)</span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true"></a></span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true"></a>oneh_snr_hap_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_oneh_ct, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true"></a>snr_hap_ct_oneh =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, oneh_snr_hap_ct, mean)</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true"></a></span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true"></a>grad_oneh_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;100%&#39;)+</span></span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ze_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ze_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">70</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ct_oneh, </span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ct_oneh, </span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">70</span>, </span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">19</span>, <span class="dv">6</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, </span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true"></a>    <span class="dv">19</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, </span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true"></a>    <span class="fl">3.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency (Hz)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, </span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">25</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true"></a>    <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true"></a><span class="co"># axis.title.x = element_blank())</span></span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true"></a></span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true"></a>grad_oneh_hap</span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true"></a></span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_oneh_happy.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb9-119"><a href="#cb9-119" aria-hidden="true"></a></span>
<span id="cb9-120"><a href="#cb9-120" aria-hidden="true"></a><span class="co"># Create legend</span></span>
<span id="cb9-121"><a href="#cb9-121" aria-hidden="true"></a></span>
<span id="cb9-122"><a href="#cb9-122" aria-hidden="true"></a><span class="co"># snr_leg = get_legend(ggplot(data = grad_snr_oneh, aes(y=SNR, x = freq, color =</span></span>
<span id="cb9-123"><a href="#cb9-123" aria-hidden="true"></a><span class="co"># electrode))+ geom_point(size = 2, shape = 21, stroke = 2)+</span></span>
<span id="cb9-124"><a href="#cb9-124" aria-hidden="true"></a><span class="co"># scale_color_manual(values=c(&#39;gray39&#39;,&#39;#B3742E&#39;, &#39;#8583D3&#39;), labels = c(&#39;Oz&#39;,</span></span>
<span id="cb9-125"><a href="#cb9-125" aria-hidden="true"></a><span class="co"># &#39;PO10 angry&#39;, &#39;PO10 happy&#39;), name = &#39;&#39;)+ theme(panel.background =</span></span>
<span id="cb9-126"><a href="#cb9-126" aria-hidden="true"></a><span class="co"># element_rect(fill = &#39;transparent&#39;), plot.background = element_rect(fill =</span></span>
<span id="cb9-127"><a href="#cb9-127" aria-hidden="true"></a><span class="co"># &#39;transparent&#39;, color = NA)))</span></span>
<span id="cb9-128"><a href="#cb9-128" aria-hidden="true"></a></span>
<span id="cb9-129"><a href="#cb9-129" aria-hidden="true"></a><span class="co"># Display plot</span></span>
<span id="cb9-130"><a href="#cb9-130" aria-hidden="true"></a>snr_grad_sing_plots =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(grad_twent_hap, grad_fort_hap, grad_sixt_hap, </span>
<span id="cb9-131"><a href="#cb9-131" aria-hidden="true"></a>    grad_eigt_hap, grad_oneh_hap, <span class="dt">nrow =</span> <span class="dv">5</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb9-132"><a href="#cb9-132" aria-hidden="true"></a><span class="co"># snr_grad_w_leg = cowplot::plot_grid(snr_grad_sing_plots, snr_leg, rel_widths =</span></span>
<span id="cb9-133"><a href="#cb9-133" aria-hidden="true"></a><span class="co"># c(1.5, .5))</span></span>
<span id="cb9-134"><a href="#cb9-134" aria-hidden="true"></a></span>
<span id="cb9-135"><a href="#cb9-135" aria-hidden="true"></a>snr_grad_sing_plots</span>
<span id="cb9-136"><a href="#cb9-136" aria-hidden="true"></a></span>
<span id="cb9-137"><a href="#cb9-137" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb9-138"><a href="#cb9-138" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_groups_happ.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="co"># For the plot: #</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a><span class="co"># https://mran.microsoft.com/snapshot/2016-03-19/web/packages/ggspectra/vignettes/user-guide.html</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>lim_<span class="dv">1</span> =<span class="st"> </span><span class="fl">0.8</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a>lim_<span class="dv">2</span> =<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a><span class="co">## 20 % intensity</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>twent_snr_hap_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_twent_ze, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a>snr_hap_ze_twent =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, twent_snr_hap_ze, mean)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a>twent_snr_hap_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_twent_ct, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a>snr_hap_ct_twent =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, twent_snr_hap_ct, mean)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a>grad_twent_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;100%&#39;)+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ze_twent, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>, </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ze_twent, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ct_twent, </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ct_twent, </span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, </span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true"></a>    <span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true"></a>    lim_<span class="dv">2</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency (Hz)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">50</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true"></a>    <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true"></a><span class="co"># axis.title.x = element_blank())</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true"></a>grad_twent_hap</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true"></a></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_twent_happy_zoom.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true"></a><span class="co">## 40% intensity</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true"></a>fort_snr_hap_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_fort_ze, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true"></a>snr_hap_ze_fort =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, fort_snr_hap_ze, mean)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true"></a>fort_snr_hap_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_fort_ct, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true"></a>snr_hap_ct_fort =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, fort_snr_hap_ct, mean)</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true"></a></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true"></a>grad_fort_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;40%&#39;)+</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ze_fort, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ze_fort, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ct_fort, </span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ct_fort, </span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, </span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, </span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true"></a>    <span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true"></a>    lim_<span class="dv">2</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># xlab ( &#39;Frequency (Hz)&#39;) +</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true"></a><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), </span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true"></a>    <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true"></a></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true"></a><span class="co">## 60% intensity</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true"></a></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true"></a>sixt_snr_hap_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_sixt_ze, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true"></a>snr_hap_ze_sixt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, sixt_snr_hap_ze, mean)</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true"></a></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true"></a>sixt_snr_hap_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_sixt_ct, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true"></a>snr_hap_ct_sixt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, sixt_snr_hap_ct, mean)</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true"></a></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true"></a>grad_sixt_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;60%&#39;)+</span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ze_sixt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ze_sixt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">stroke =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ct_sixt, </span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ct_sixt, </span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, </span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">stroke =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, </span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true"></a>    <span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true"></a>    lim_<span class="dv">2</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># xlab ( &#39;Frequency (Hz)&#39;) +</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true"></a><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), </span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true"></a>    <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true"></a></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true"></a><span class="co">## 80 % intensity</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true"></a></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true"></a>eigt_snr_hap_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_eigt_ze, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true"></a>snr_hap_ze_eigt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, eigt_snr_hap_ze, mean)</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true"></a></span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true"></a>eigt_snr_hap_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_eigt_ct, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true"></a>snr_hap_ct_eigt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, eigt_snr_hap_ct, mean)</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true"></a></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true"></a>grad_eigt_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;80%&#39;)+</span></span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ze_eigt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ze_eigt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ct_eigt, </span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ct_eigt, </span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, </span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, </span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true"></a>    <span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true"></a>    lim_<span class="dv">2</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># xlab ( &#39;Frequency (Hz)&#39;) +</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true"></a><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), </span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true"></a>    <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true"></a></span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true"></a><span class="co">## 100% intensity</span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true"></a></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true"></a>oneh_snr_hap_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_oneh_ze, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true"></a>snr_hap_ze_oneh =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, oneh_snr_hap_ze, mean)</span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true"></a></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true"></a>oneh_snr_hap_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_oneh_ct, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true"></a>snr_hap_ct_oneh =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, oneh_snr_hap_ct, mean)</span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true"></a></span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true"></a>grad_oneh_hap =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;100%&#39;)+</span></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ze_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>, </span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ze_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_hap_ct_oneh, </span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_hap_ct_oneh, </span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, </span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, </span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true"></a>    <span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true"></a>    lim_<span class="dv">2</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency (Hz)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, </span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">50</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true"></a>    <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true"></a><span class="co"># axis.title.x = element_blank())</span></span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true"></a></span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true"></a>grad_oneh_hap</span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true"></a></span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_oneh_happy_zoom.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true"></a></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true"></a></span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true"></a><span class="co"># Create legend</span></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true"></a></span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true"></a><span class="co"># snr_leg = get_legend(ggplot(data = grad_snr_oneh, aes(y=SNR, x = freq, color =</span></span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true"></a><span class="co"># electrode))+ geom_point(size = 2, shape = 21, stroke = 2)+</span></span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true"></a><span class="co"># scale_color_manual(values=c(&#39;gray39&#39;,&#39;#B3742E&#39;, &#39;#8583D3&#39;), labels = c(&#39;Oz&#39;,</span></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true"></a><span class="co"># &#39;PO10 angry&#39;, &#39;PO10 happy&#39;), name = &#39;&#39;)+ theme(panel.background =</span></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true"></a><span class="co"># element_rect(fill = &#39;transparent&#39;), plot.background = element_rect(fill =</span></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true"></a><span class="co"># &#39;transparent&#39;, color = NA)))</span></span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true"></a></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true"></a><span class="co"># Display plot</span></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true"></a>snr_grad_sing_plots =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(grad_twent_hap, grad_fort_hap, grad_sixt_hap, </span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true"></a>    grad_eigt_hap, grad_oneh_hap, <span class="dt">nrow =</span> <span class="dv">5</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true"></a><span class="co"># snr_grad_w_leg = cowplot::plot_grid(snr_grad_sing_plots, snr_leg, rel_widths =</span></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true"></a><span class="co"># c(1.5, .5))</span></span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true"></a></span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true"></a>snr_grad_sing_plots</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true"></a></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_groups_happy_zoom.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="co"># For the plot: #</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="co"># https://mran.microsoft.com/snapshot/2016-03-19/web/packages/ggspectra/vignettes/user-guide.html</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a><span class="co">## 20 % intensity</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>twent_snr_ang_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_twent_ze, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>snr_ang_ze_twent =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, twent_snr_ang_ze, mean)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>twent_snr_ang_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_twent_ct, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>snr_ang_ct_twent =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, twent_snr_ang_ct, mean)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true"></a>grad_twent_ang =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;20%&#39;)+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ze_twent, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ze_twent, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">80</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ct_twent, </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ct_twent, </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">80</span>, </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">19</span>, <span class="dv">6</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true"></a>    <span class="dv">19</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, </span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true"></a>    <span class="fl">3.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency (Hz)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, </span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">25</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true"></a>    <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true"></a><span class="co"># axis.title.x = element_blank())</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true"></a>grad_twent_hap</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true"></a></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_twent_angry.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true"></a><span class="co">## 40% intensity</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true"></a>fort_snr_ang_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_fort_ze, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true"></a>snr_ang_ze_fort =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, fort_snr_ang_ze, mean)</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true"></a>fort_snr_ang_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_fort_ct, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true"></a>snr_ang_ct_fort =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, fort_snr_ang_ct, mean)</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true"></a>grad_fort_ang =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;40%&#39;)+</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ze_fort, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ze_fort, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">70</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ct_fort, </span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ct_fort, </span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">70</span>, </span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">19</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, </span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true"></a>    <span class="dv">19</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, </span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true"></a>    <span class="fl">3.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># xlab ( &#39;Frequency (Hz)&#39;) +</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true"></a><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), </span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true"></a>    <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true"></a></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true"></a><span class="co">## 70% intensity</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true"></a>sixt_snr_ang_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_sixt_ze, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true"></a>snr_ang_ze_sixt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, sixt_snr_ang_ze, mean)</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true"></a></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true"></a>sixt_snr_ang_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_sixt_ct, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true"></a>snr_ang_ct_sixt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, sixt_snr_ang_ct, mean)</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true"></a></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true"></a>grad_sixt_ang =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;70%&#39;)+</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ze_sixt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ze_sixt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">70</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ct_sixt, </span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ct_sixt, </span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">70</span>, </span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">19</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, </span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true"></a>    <span class="dv">19</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, </span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true"></a>    <span class="fl">3.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># xlab ( &#39;Frequency (Hz)&#39;) +</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true"></a><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), </span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true"></a>    <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true"></a></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true"></a><span class="co">## 80 % intensity</span></span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true"></a></span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true"></a>eigt_snr_ang_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_eigt_ze, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true"></a>snr_ang_ze_eigt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, eigt_snr_ang_ze, mean)</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true"></a></span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true"></a>eigt_snr_ang_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_eigt_ct, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true"></a>snr_ang_ct_eigt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, eigt_snr_ang_ct, mean)</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true"></a></span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true"></a>grad_eigt_ang =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;80%&#39;)+</span></span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ze_eigt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ze_eigt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">span =</span> <span class="dv">70</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ct_eigt, </span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ct_eigt, </span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">span =</span> <span class="dv">70</span>, </span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">19</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, </span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true"></a>    <span class="dv">19</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, </span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true"></a>    <span class="fl">3.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># xlab ( &#39;Frequency (Hz)&#39;) +</span></span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true"></a><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), </span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true"></a>    <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true"></a></span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true"></a><span class="co">## 100% intensity</span></span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true"></a></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true"></a>oneh_snr_ang_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_oneh_ze, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true"></a>snr_ang_ze_oneh =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, oneh_snr_ang_ze, mean)</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true"></a></span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true"></a>oneh_snr_ang_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_oneh_ct, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true"></a>snr_ang_ct_oneh =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, oneh_snr_ang_ct, mean)</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true"></a></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true"></a>grad_oneh_ang =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;100%&#39;)+</span></span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ze_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ze_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">80</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ct_oneh, </span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ct_oneh, </span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">80</span>, </span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">19</span>, <span class="dv">6</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, </span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true"></a>    <span class="dv">19</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, </span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true"></a>    <span class="fl">3.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency (Hz)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, </span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">25</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true"></a>    <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true"></a><span class="co"># axis.title.x = element_blank())</span></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true"></a></span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true"></a>grad_oneh_hap</span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true"></a></span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_oneh_angry.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true"></a></span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true"></a><span class="co"># Create legend</span></span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true"></a></span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true"></a><span class="co"># snr_leg = get_legend(ggplot(data = grad_snr_oneh, aes(y=SNR, x = freq, color =</span></span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true"></a><span class="co"># electrode))+ geom_point(size = 2, shape = 21, stroke = 2)+</span></span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true"></a><span class="co"># scale_color_manual(values=c(&#39;gray39&#39;,&#39;#B3742E&#39;, &#39;#8583D3&#39;), labels = c(&#39;Oz&#39;,</span></span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true"></a><span class="co"># &#39;PO10 angry&#39;, &#39;PO10 angry&#39;), name = &#39;&#39;)+ theme(panel.background =</span></span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true"></a><span class="co"># element_rect(fill = &#39;transparent&#39;), plot.background = element_rect(fill =</span></span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true"></a><span class="co"># &#39;transparent&#39;, color = NA)))</span></span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true"></a></span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true"></a><span class="co"># Display plot</span></span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true"></a>snr_grad_sing_plots =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(grad_twent_ang, grad_fort_ang, grad_sixt_ang, </span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true"></a>    grad_eigt_ang, grad_oneh_ang, <span class="dt">nrow =</span> <span class="dv">5</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true"></a><span class="co"># snr_grad_w_leg = cowplot::plot_grid(snr_grad_sing_plots, snr_leg, rel_widths =</span></span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true"></a><span class="co"># c(1.5, .5))</span></span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true"></a></span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true"></a>snr_grad_sing_plots</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="co"># For the plot: #</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a><span class="co"># https://mran.microsoft.com/snapshot/2016-03-19/web/packages/ggspectra/vignettes/user-guide.html</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a>lim_<span class="dv">1</span> =<span class="st"> </span><span class="fl">0.8</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>lim_<span class="dv">2</span> =<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a><span class="co">## 20 % intensity</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a>twent_snr_ang_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_twent_ze, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a>snr_ang_ze_twent =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, twent_snr_ang_ze, mean)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a>twent_snr_ang_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_twent_ct, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a>snr_ang_ct_twent =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, twent_snr_ang_ct, mean)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true"></a>grad_twent_ang =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;20%&#39;)+</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ze_twent, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>, </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ze_twent, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ct_twent, </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ct_twent, </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, </span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true"></a>    <span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true"></a>    lim_<span class="dv">2</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency (Hz)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, </span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">50</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true"></a>    <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true"></a><span class="co"># axis.title.x = element_blank())</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true"></a>grad_twent_ang</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_twent_angry_zoom.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true"></a></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true"></a><span class="co">## 40% intensity</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true"></a>fort_snr_ang_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_fort_ze, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true"></a>snr_ang_ze_fort =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, fort_snr_ang_ze, mean)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true"></a></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true"></a>fort_snr_ang_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_fort_ct, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true"></a>snr_ang_ct_fort =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, fort_snr_ang_ct, mean)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true"></a>grad_fort_ang =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;40%&#39;)+</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ze_fort, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ze_fort, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ct_fort, </span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ct_fort, </span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, </span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, </span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true"></a>    <span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true"></a>    lim_<span class="dv">2</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># xlab ( &#39;Frequency (Hz)&#39;) +</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true"></a><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), </span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true"></a>    <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true"></a></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true"></a><span class="co">## 60% intensity</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true"></a></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true"></a>sixt_snr_ang_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_sixt_ze, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true"></a>snr_ang_ze_sixt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, sixt_snr_ang_ze, mean)</span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true"></a></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true"></a>sixt_snr_ang_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_sixt_ct, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true"></a>snr_ang_ct_sixt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, sixt_snr_ang_ct, mean)</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true"></a></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true"></a>grad_sixt_ang =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;60%&#39;)+</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ze_sixt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ze_sixt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">stroke =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ct_sixt, </span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ct_sixt, </span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, </span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">stroke =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, </span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true"></a>    <span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true"></a>    lim_<span class="dv">2</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># xlab ( &#39;Frequency (Hz)&#39;) +</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true"></a><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), </span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true"></a>    <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true"></a></span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true"></a><span class="co">## 80 % intensity</span></span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true"></a></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true"></a>eigt_snr_ang_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_eigt_ze, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true"></a>snr_ang_ze_eigt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, eigt_snr_ang_ze, mean)</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true"></a></span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true"></a>eigt_snr_ang_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_eigt_ct, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true"></a>snr_ang_ct_eigt =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, eigt_snr_ang_ct, mean)</span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true"></a></span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true"></a>grad_eigt_ang =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;80%&#39;)+</span></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ze_eigt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ze_eigt, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ct_eigt, </span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ct_eigt, </span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, </span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, </span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true"></a>    <span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true"></a>    lim_<span class="dv">2</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="co"># xlab ( &#39;Frequency (Hz)&#39;) +</span></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true"></a><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), </span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true"></a>    <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true"></a></span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true"></a><span class="co">## 100% intensity</span></span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true"></a></span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true"></a>oneh_snr_ang_ze =<span class="st"> </span><span class="kw">subset</span>(grad_snr_oneh_ze, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true"></a>snr_ang_ze_oneh =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, oneh_snr_ang_ze, mean)</span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true"></a></span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true"></a>oneh_snr_ang_ct =<span class="st"> </span><span class="kw">subset</span>(grad_snr_oneh_ct, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true"></a>snr_ang_ct_oneh =<span class="st"> </span><span class="kw">aggregate</span>(SNR <span class="op">~</span><span class="st"> </span>freq <span class="op">+</span><span class="st"> </span>emotion, oneh_snr_ang_ct, mean)</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true"></a></span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true"></a>grad_oneh_ang =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;100%&#39;)+</span></span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true"></a><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ze_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>, </span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true"></a>    <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ze_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;#D97909&quot;</span>, </span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true"></a>    <span class="dt">fill =</span> <span class="st">&quot;#D97909&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> snr_ang_ct_oneh, </span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">color =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_peaks</span>(<span class="dt">data =</span> snr_ang_ct_oneh, </span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true"></a>    <span class="kw">aes</span>(<span class="dt">x =</span> freq, <span class="dt">y =</span> SNR), <span class="dt">colour =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray53&quot;</span>, <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">span =</span> <span class="dv">20</span>, </span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">stroke =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, </span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true"></a>    <span class="dv">5</span>), <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true"></a>    lim_<span class="dv">2</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Frequency (Hz)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">0</span>, </span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">50</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, </span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true"></a>    <span class="dt">color =</span> <span class="ot">NA</span>))</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true"></a><span class="co"># axis.title.x = element_blank())</span></span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true"></a></span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true"></a>grad_oneh_ang</span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true"></a></span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_oneh_angry_zoom.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true"></a></span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true"></a><span class="co"># Create legend</span></span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true"></a></span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true"></a><span class="co"># snr_leg = get_legend(ggplot(data = grad_snr_oneh, aes(y=SNR, x = freq, color =</span></span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true"></a><span class="co"># electrode))+ geom_point(size = 2, shape = 21, stroke = 2)+</span></span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true"></a><span class="co"># scale_color_manual(values=c(&#39;gray39&#39;,&#39;#B3742E&#39;, &#39;#8583D3&#39;), labels = c(&#39;Oz&#39;,</span></span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true"></a><span class="co"># &#39;PO10 angry&#39;, &#39;PO10 angry&#39;), name = &#39;&#39;)+ theme(panel.background =</span></span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true"></a><span class="co"># element_rect(fill = &#39;transparent&#39;), plot.background = element_rect(fill =</span></span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true"></a><span class="co"># &#39;transparent&#39;, color = NA)))</span></span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true"></a></span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true"></a><span class="co"># Display plot</span></span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true"></a>snr_grad_sing_plots =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(grad_twent_ang, grad_fort_ang, grad_sixt_ang, </span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true"></a>    grad_eigt_ang, grad_oneh_ang, <span class="dt">nrow =</span> <span class="dv">5</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true"></a><span class="co"># snr_grad_w_leg = cowplot::plot_grid(snr_grad_sing_plots, snr_leg, rel_widths =</span></span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true"></a><span class="co"># c(1.5, .5))</span></span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true"></a></span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true"></a>snr_grad_sing_plots</span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true"></a></span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/SNR_grad_groups_angry_zoom.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
</div>
</div>
<div id="bca" class="section level2 tabset tabset-pills">
<h2 class="tabset tabset-pills">BCA</h2>
<div id="base-response" class="section level3 tabset tabset-pills">
<h3 class="tabset tabset-pills">Base response</h3>
<div id="visualization" class="section level4">
<h4>Visualization</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="co"># Create data summary</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>grad_base_plot_prep =<span class="st"> </span><span class="kw">data_summary</span>(grad_base_plot, <span class="dt">varname =</span> <span class="st">&quot;bca&quot;</span>, <span class="dt">groupnames =</span> <span class="kw">c</span>(<span class="st">&quot;ROI&quot;</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a>    <span class="st">&quot;emotion&quot;</span>, <span class="st">&quot;intens&quot;</span>))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a><span class="co"># grad_base_plot_prep$bca = abs(grad_base_plot_prep$bca)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true"></a><span class="co"># Plot expr response differences for emotions</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true"></a>expr_plot =<span class="st"> </span><span class="kw">ggplot</span>(grad_base_plot_prep, <span class="kw">aes</span>(<span class="dt">x =</span> intens, <span class="dt">y =</span> bca, <span class="dt">fill =</span> emotion)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> bca, <span class="dt">ymax =</span> bca <span class="op">+</span><span class="st"> </span>se), <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>ROI) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;BCA [uV]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#0098ff&quot;</span>, <span class="st">&quot;#333333&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true"></a>expr_plot</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/BCA_base_resp_plot_emotions-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_base_emotion.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
</div>
<div id="lmm" class="section level4">
<h4>LMM</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="co"># https://benwhalley.github.io/just-enough-r/extending-traditional-rm-anova.html</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true"></a>grad_base_lmm =<span class="st"> </span>grad_base_stats <span class="op">%&gt;%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">convert_as_factor</span>(ID)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true"></a>grad_base_lmm<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(grad_base_lmm<span class="op">$</span>emotion)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true"></a>grad_base_lmm<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(grad_base_lmm<span class="op">$</span>group)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true"></a>grad_base_lmm<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(grad_base_lmm<span class="op">$</span>intens, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, <span class="st">&quot;60%&quot;</span>, </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true"></a>    <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true"></a>grad_base_lmm<span class="op">$</span>ROI =<span class="st"> </span><span class="kw">factor</span>(grad_base_lmm<span class="op">$</span>ROI)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true"></a><span class="co"># Define effect treatment contrasts</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_base_lmm<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_base_lmm<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_base_lmm<span class="op">$</span>ROI) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">2</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_base_lmm<span class="op">$</span>intens) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">5</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true"></a>mod_base_lmer =<span class="st"> </span><span class="kw">lmer</span>(bca <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_base_lmm, </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true"></a>mod_base_lmer_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_base_lmer)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true"></a>mod_base_lmer_res =<span class="st"> </span><span class="kw">subset</span>(mod_base_lmer_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true"></a>    etasq, omegasq, partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true"></a>mod_base_lmer_res =<span class="st"> </span><span class="kw">head</span>(mod_base_lmer_res, <span class="dv">-1</span>)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_base_lmer_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">1218</td>
<td align="right">1.83</td>
<td align="right">0.18</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">2.74</td>
<td align="right">0.03</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">group</td>
<td align="right">1</td>
<td align="right">43</td>
<td align="right">1.96</td>
<td align="right">0.17</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">7.94</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">0.50</td>
<td align="right">0.73</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">emotion:group</td>
<td align="right">1</td>
<td align="right">1218</td>
<td align="right">2.31</td>
<td align="right">0.13</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens:group</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">0.86</td>
<td align="right">0.49</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">emotion:ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">0.43</td>
<td align="right">0.65</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">0.28</td>
<td align="right">0.97</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">group:ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">3.47</td>
<td align="right">0.03</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">1.27</td>
<td align="right">0.28</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">0.44</td>
<td align="right">0.90</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">emotion:group:ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">0.11</td>
<td align="right">0.89</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens:group:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">0.26</td>
<td align="right">0.98</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">0.25</td>
<td align="right">0.98</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="co"># Post-hoc tests</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a>m.roi =<span class="st"> </span><span class="kw">emmeans</span>(mod_base_lmer, <span class="st">&quot;ROI&quot;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a>ROI =<span class="st"> </span><span class="kw">contrast</span>(m.roi, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(ROI)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
null.value
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
adj.p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ROI
</td>
<td style="text-align:left;">
lOT - MO
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
1218
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
0.80
</td>
</tr>
<tr>
<td style="text-align:left;">
ROI
</td>
<td style="text-align:left;">
lOT - rOT
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.10
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
1218
</td>
<td style="text-align:right;">
-3.08
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
ROI
</td>
<td style="text-align:left;">
MO - rOT
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
-0.12
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
1218
</td>
<td style="text-align:right;">
-3.73
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_base_lmer, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>poly_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;poly&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(poly_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">linear</td>
<td align="right">0</td>
<td align="right">-0.17</td>
<td align="right">0.09</td>
<td align="right">1218</td>
<td align="right">-1.8</td>
<td align="right">0.07</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">quadratic</td>
<td align="right">0</td>
<td align="right">-0.14</td>
<td align="right">0.11</td>
<td align="right">1218</td>
<td align="right">-1.2</td>
<td align="right">0.21</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">cubic</td>
<td align="right">0</td>
<td align="right">-0.25</td>
<td align="right">0.09</td>
<td align="right">1218</td>
<td align="right">-2.7</td>
<td align="right">0.01</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_base_lmer, pairwise <span class="op">~</span><span class="st"> </span>group <span class="op">|</span><span class="st"> </span>ROI)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">ROI</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">lOT</td>
<td align="right">-0.23</td>
<td align="right">0.11</td>
<td align="right">53</td>
<td align="right">-2.0</td>
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">MO</td>
<td align="right">-0.06</td>
<td align="right">0.11</td>
<td align="right">53</td>
<td align="right">-0.5</td>
<td align="right">0.62</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">rOT</td>
<td align="right">-0.16</td>
<td align="right">0.11</td>
<td align="right">53</td>
<td align="right">-1.4</td>
<td align="right">0.16</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="expression-change-response" class="section level3 tabset tabset-pills">
<h3 class="tabset tabset-pills">Expression change response</h3>
<div id="visualization-1" class="section level4">
<h4>Visualization</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="co"># Create data summary</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a>grad_expr_plot_prep =<span class="st"> </span><span class="kw">data_summary</span>(grad_expr_plot, <span class="dt">varname =</span> <span class="st">&quot;bca&quot;</span>, <span class="dt">groupnames =</span> <span class="kw">c</span>(<span class="st">&quot;ROI&quot;</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a>    <span class="st">&quot;emotion&quot;</span>, <span class="st">&quot;intens&quot;</span>))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a><span class="co"># grad_expr_plot_prep$bca = abs(grad_expr_plot_prep$bca)</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a><span class="co"># Plot expr response differences for emotions</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a>expr_plot =<span class="st"> </span><span class="kw">ggplot</span>(grad_expr_plot_prep, <span class="kw">aes</span>(<span class="dt">x =</span> intens, <span class="dt">y =</span> bca, <span class="dt">fill =</span> emotion)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> bca, <span class="dt">ymax =</span> bca <span class="op">+</span><span class="st"> </span>se), <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>ROI) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;BCA [uV]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#0098ff&quot;</span>, <span class="st">&quot;#333333&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true"></a></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true"></a>expr_plot</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/BCA_expr_resp_plot_emotions-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_emotion.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="co"># Create data summary</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>grad_expr_plot_prep =<span class="st"> </span><span class="kw">data_summary</span>(grad_expr_plot, <span class="dt">varname =</span> <span class="st">&quot;bca&quot;</span>, <span class="dt">groupnames =</span> <span class="kw">c</span>(<span class="st">&quot;ROI&quot;</span>, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a>    <span class="st">&quot;emotion&quot;</span>, <span class="st">&quot;intens&quot;</span>, <span class="st">&quot;group&quot;</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a><span class="co"># grad_expr_plot_prep$bca = abs(grad_expr_plot_prep$bca)</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true"></a><span class="co"># Plot expr response differences for emotions</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true"></a>expr_plot =<span class="st"> </span><span class="kw">ggplot</span>(grad_expr_plot_prep, <span class="kw">aes</span>(<span class="dt">x =</span> intens, <span class="dt">y =</span> bca, <span class="dt">fill =</span> group)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> bca, <span class="dt">ymax =</span> bca <span class="op">+</span><span class="st"> </span>se), <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>emotion <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true"></a><span class="st">    </span>ROI) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;BCA [uV]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;gray53&quot;</span>, </span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true"></a>    <span class="st">&quot;#D97909&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="fl">1.5</span>), <span class="dt">guide =</span> <span class="kw">guide_prism_minor</span>()) <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">10</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true"></a>expr_plot</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_groups.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a>lim_<span class="dv">1</span> =<span class="st"> </span><span class="dv">-1</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a>lim_<span class="dv">2</span> =<span class="st"> </span><span class="fl">1.3</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a><span class="co"># Subset for expr</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a>grad_topo_expr =<span class="st"> </span><span class="kw">subset</span>(grad_topo, manip <span class="op">==</span><span class="st"> &quot;expr&quot;</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true"></a><span class="co"># grad_topo_expr$amplitude = abs(grad_topo_expr$amplitude)</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true"></a><span class="co"># Subset for emotions</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true"></a>grad_topo_expr_hap =<span class="st"> </span><span class="kw">subset</span>(grad_topo_expr, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true"></a><span class="co"># Add montage</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true"></a>grad_topo_expr_hap =<span class="st"> </span><span class="kw">electrode_locations</span>(grad_topo_expr_hap, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true"></a><span class="co"># 20 %</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true"></a>grad_topo_expr_hap_twent =<span class="st"> </span><span class="kw">subset</span>(grad_topo_expr_hap, intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true"></a>topo_hap_expr_twent =<span class="st"> </span><span class="kw">ggplot</span>(grad_topo_expr_hap_twent, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>, </span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, lim_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;BCA (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co">#+</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true"></a><span class="co"># facet_grid(~group)</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true"></a>topo_hap_expr_twent</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/BCA_expr_resp_topo_hap-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_hap_twent.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a><span class="co"># 40 %</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true"></a>grad_topo_expr_hap_fort =<span class="st"> </span><span class="kw">subset</span>(grad_topo_expr_hap, intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true"></a>topo_hap_expr_fort =<span class="st"> </span><span class="kw">ggplot</span>(grad_topo_expr_hap_fort, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>, </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, lim_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;BCA (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co">#+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true"></a><span class="co"># facet_grid(~group)</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true"></a>topo_hap_expr_fort</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/BCA_expr_resp_topo_hap-2.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_hap_fort.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a><span class="co"># 60 %</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a>grad_topo_expr_hap_sixt =<span class="st"> </span><span class="kw">subset</span>(grad_topo_expr_hap, intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true"></a>topo_hap_expr_sixt =<span class="st"> </span><span class="kw">ggplot</span>(grad_topo_expr_hap_sixt, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>, </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, lim_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;BCA (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co">#+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true"></a><span class="co"># facet_grid(~group)</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true"></a>topo_hap_expr_sixt</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/BCA_expr_resp_topo_hap-3.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_hap_sixt.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a><span class="co"># 80 %</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a>grad_topo_expr_hap_eigt =<span class="st"> </span><span class="kw">subset</span>(grad_topo_expr_hap, intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true"></a>topo_hap_expr_eigt =<span class="st"> </span><span class="kw">ggplot</span>(grad_topo_expr_hap_eigt, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>, </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, lim_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;BCA (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co">#+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true"></a><span class="co"># facet_grid(~group)</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true"></a>topo_hap_expr_eigt</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/BCA_expr_resp_topo_hap-4.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_hap_eigt.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a><span class="co"># 100 %</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true"></a>grad_topo_expr_hap_oneh =<span class="st"> </span><span class="kw">subset</span>(grad_topo_expr_hap, intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true"></a>topo_hap_expr_oneh =<span class="st"> </span><span class="kw">ggplot</span>(grad_topo_expr_hap_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>, </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, lim_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;BCA (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co">#+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true"></a><span class="co"># facet_grid(~group)</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true"></a>topo_hap_expr_oneh</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/BCA_expr_resp_topo_hap-5.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_hap_oneh.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true"></a><span class="co"># Get legend</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true"></a>topo_leg =<span class="st"> </span><span class="kw">get_legend</span>(<span class="kw">ggplot</span>(grad_topo_expr_hap_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true"></a>    <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true"></a>    lim_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;BCA (&quot;</span>, </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true"></a>    mu, <span class="st">&quot;V)&quot;</span>))))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_hap_topo_legend.png&quot;</span>, topo_leg, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a>lim_<span class="dv">1</span> =<span class="st"> </span><span class="fl">-0.3</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a>lim_<span class="dv">2</span> =<span class="st"> </span><span class="fl">3.5</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true"></a><span class="co"># Subset for base</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true"></a>grad_topo_expr =<span class="st"> </span><span class="kw">subset</span>(grad_topo, manip <span class="op">==</span><span class="st"> &quot;expr&quot;</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true"></a>grad_topo_expr<span class="op">$</span>amplitude =<span class="st"> </span><span class="kw">abs</span>(grad_topo_expr<span class="op">$</span>amplitude)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true"></a><span class="co"># Subset for emotions</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true"></a>grad_topo_expr_ang =<span class="st"> </span><span class="kw">subset</span>(grad_topo_expr, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span>)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true"></a><span class="co"># Add montage</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true"></a>grad_topo_expr_ang =<span class="st"> </span><span class="kw">electrode_locations</span>(grad_topo_expr_ang, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true"></a><span class="co"># 20 %</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true"></a>grad_topo_expr_ang_twent =<span class="st"> </span><span class="kw">subset</span>(grad_topo_expr_ang, intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true"></a>topo_ang_expr_twent =<span class="st"> </span><span class="kw">ggplot</span>(grad_topo_expr_ang_twent, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>, </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, lim_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;BCA (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co">#+</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true"></a><span class="co"># facet_grid(~group)</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true"></a></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true"></a>topo_ang_expr_twent</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/BCA_expr_resp_topo_ang-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_ang_twent.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a><span class="co"># 40 %</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a>grad_topo_expr_ang_fort =<span class="st"> </span><span class="kw">subset</span>(grad_topo_expr_ang, intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a>topo_ang_expr_fort =<span class="st"> </span><span class="kw">ggplot</span>(grad_topo_expr_ang_fort, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>, </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, lim_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;BCA (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co">#+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true"></a><span class="co"># facet_grid(~group)</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true"></a>topo_ang_expr_fort</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/BCA_expr_resp_topo_ang-2.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_ang_fort.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a><span class="co"># 60 %</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a>grad_topo_expr_ang_sixt =<span class="st"> </span><span class="kw">subset</span>(grad_topo_expr_ang, intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true"></a>topo_ang_expr_sixt =<span class="st"> </span><span class="kw">ggplot</span>(grad_topo_expr_ang_sixt, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>, </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, lim_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;BCA (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co">#+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true"></a><span class="co"># facet_grid(~group)</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true"></a>topo_ang_expr_sixt</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/BCA_expr_resp_topo_ang-3.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_ang_sixt.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true"></a><span class="co"># 80 %</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true"></a>grad_topo_expr_ang_eigt =<span class="st"> </span><span class="kw">subset</span>(grad_topo_expr_ang, intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true"></a>topo_ang_expr_eigt =<span class="st"> </span><span class="kw">ggplot</span>(grad_topo_expr_ang_eigt, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>, </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, lim_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;BCA (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co">#+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true"></a><span class="co"># facet_grid(~group)</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true"></a>topo_ang_expr_eigt</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/BCA_expr_resp_topo_ang-4.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_ang_eigt.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true"></a><span class="co"># 100 %</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true"></a>grad_topo_expr_ang_oneh =<span class="st"> </span><span class="kw">subset</span>(grad_topo_expr_ang, intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true"></a>topo_ang_expr_oneh =<span class="st"> </span><span class="kw">ggplot</span>(grad_topo_expr_ang_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="co"># ggtitle(&#39;happy&#39;)+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true"></a><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>, </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true"></a>    <span class="dt">head_size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, lim_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;BCA (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co">#+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true"></a><span class="co"># facet_grid(~group)</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true"></a></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true"></a>topo_ang_expr_oneh</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/BCA_expr_resp_topo_ang-5.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_ang_oneh.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true"></a><span class="co"># Get legend</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true"></a>topo_leg =<span class="st"> </span><span class="kw">get_legend</span>(<span class="kw">ggplot</span>(grad_topo_expr_ang_oneh, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true"></a>    <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="fl">1.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(lim_<span class="dv">1</span>, </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true"></a>    lim_<span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;BCA (&quot;</span>, </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true"></a>    mu, <span class="st">&quot;V)&quot;</span>))))</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_expr_ang_topo_legend.png&quot;</span>, topo_leg, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span></code></pre></div>
</div>
<div id="lmm-1" class="section level4">
<h4>LMM</h4>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="co"># https://benwhalley.github.io/just-enough-r/extending-traditional-rm-anova.html</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true"></a>grad_expr_lmm =<span class="st"> </span>grad_expr_stats <span class="op">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">convert_as_factor</span>(ID)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true"></a>grad_expr_lmm<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm<span class="op">$</span>emotion)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true"></a>grad_expr_lmm<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm<span class="op">$</span>group)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true"></a>grad_expr_lmm<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm<span class="op">$</span>intens, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, <span class="st">&quot;60%&quot;</span>, </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true"></a>    <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true"></a>grad_expr_lmm<span class="op">$</span>ROI =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm<span class="op">$</span>ROI)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true"></a><span class="co"># Define effect treatment contrasts</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm<span class="op">$</span>ROI) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">2</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm<span class="op">$</span>intens) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">5</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true"></a></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true"></a>mod_expr_lmer =<span class="st"> </span><span class="kw">lmer</span>(bca <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_expr_lmm, </span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true"></a></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true"></a></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_expr_lmer)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">subset</span>(mod_expr_lmer_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, </span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true"></a>    etasq, omegasq, partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">head</span>(mod_expr_lmer_res, <span class="dv">-1</span>)</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_expr_lmer_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">1218</td>
<td align="right">0.04</td>
<td align="right">0.85</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">5.29</td>
<td align="right">0.00</td>
<td align="right">0.02</td>
</tr>
<tr class="odd">
<td align="left">group</td>
<td align="right">1</td>
<td align="right">57</td>
<td align="right">0.05</td>
<td align="right">0.82</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">6.74</td>
<td align="right">0.00</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">2.58</td>
<td align="right">0.04</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">emotion:group</td>
<td align="right">1</td>
<td align="right">1218</td>
<td align="right">1.29</td>
<td align="right">0.26</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens:group</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">2.28</td>
<td align="right">0.06</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">emotion:ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">1.43</td>
<td align="right">0.24</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">1.19</td>
<td align="right">0.30</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">group:ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">0.37</td>
<td align="right">0.69</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">1.00</td>
<td align="right">0.41</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">1.01</td>
<td align="right">0.43</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">emotion:group:ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">0.25</td>
<td align="right">0.78</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens:group:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">1.38</td>
<td align="right">0.20</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">0.57</td>
<td align="right">0.81</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="co"># Calculate and show post-hoc tests</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_expr_lmer, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true"></a>main_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(main_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">statistic</th>
<th align="right">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 40%</td>
<td align="right">0</td>
<td align="right">-0.04</td>
<td align="right">0.1</td>
<td align="right">1218</td>
<td align="right">-0.38</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 60%</td>
<td align="right">0</td>
<td align="right">-0.18</td>
<td align="right">0.1</td>
<td align="right">1218</td>
<td align="right">-1.94</td>
<td align="right">0.30</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 80%</td>
<td align="right">0</td>
<td align="right">-0.24</td>
<td align="right">0.1</td>
<td align="right">1218</td>
<td align="right">-2.55</td>
<td align="right">0.08</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 100%</td>
<td align="right">0</td>
<td align="right">-0.42</td>
<td align="right">0.1</td>
<td align="right">1218</td>
<td align="right">-4.38</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">40% - 60%</td>
<td align="right">0</td>
<td align="right">-0.15</td>
<td align="right">0.1</td>
<td align="right">1218</td>
<td align="right">-1.56</td>
<td align="right">0.53</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">40% - 80%</td>
<td align="right">0</td>
<td align="right">-0.21</td>
<td align="right">0.1</td>
<td align="right">1218</td>
<td align="right">-2.17</td>
<td align="right">0.19</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true"></a>poly_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;poly&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(poly_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">linear</td>
<td align="right">0</td>
<td align="right">1.04</td>
<td align="right">0.21</td>
<td align="right">1218</td>
<td align="right">4.89</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">quadratic</td>
<td align="right">0</td>
<td align="right">0.19</td>
<td align="right">0.25</td>
<td align="right">1218</td>
<td align="right">0.74</td>
<td align="right">0.46</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">cubic</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.21</td>
<td align="right">1218</td>
<td align="right">0.02</td>
<td align="right">0.98</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true"></a>m.roi =<span class="st"> </span><span class="kw">emmeans</span>(mod_expr_lmer, <span class="st">&quot;ROI&quot;</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true"></a>ROI =<span class="st"> </span><span class="kw">contrast</span>(m.roi, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(ROI, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">statistic</th>
<th align="right">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ROI</td>
<td align="left">lOT - MO</td>
<td align="right">0</td>
<td align="right">0.12</td>
<td align="right">0.07</td>
<td align="right">1218</td>
<td align="right">1.6</td>
<td align="right">0.25</td>
</tr>
<tr class="even">
<td align="left">ROI</td>
<td align="left">lOT - rOT</td>
<td align="right">0</td>
<td align="right">-0.15</td>
<td align="right">0.07</td>
<td align="right">1218</td>
<td align="right">-2.1</td>
<td align="right">0.10</td>
</tr>
<tr class="odd">
<td align="left">ROI</td>
<td align="left">MO - rOT</td>
<td align="right">0</td>
<td align="right">-0.27</td>
<td align="right">0.07</td>
<td align="right">1218</td>
<td align="right">-3.7</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true"></a><span class="co"># https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true"></a>int_emo_int =<span class="st"> </span><span class="kw">emmip</span>(mod_expr_lmer, emotion <span class="op">~</span><span class="st"> </span>intens, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#0098ff&quot;</span>, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true"></a>    <span class="st">&quot;#333333&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true"></a>    <span class="dv">3</span>))</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true"></a>int_emo_int</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_expr-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/int_emo_int.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_expr_lmer, pairwise <span class="op">~</span><span class="st"> </span>emotion <span class="op">|</span><span class="st"> </span>intens)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">intens</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">happy - angry</td>
<td align="left">20%</td>
<td align="right">-0.08</td>
<td align="right">0.13</td>
<td align="right">1218</td>
<td align="right">-0.58</td>
<td align="right">0.56</td>
</tr>
<tr class="even">
<td align="left">happy - angry</td>
<td align="left">40%</td>
<td align="right">0.00</td>
<td align="right">0.13</td>
<td align="right">1218</td>
<td align="right">0.01</td>
<td align="right">0.99</td>
</tr>
<tr class="odd">
<td align="left">happy - angry</td>
<td align="left">60%</td>
<td align="right">0.09</td>
<td align="right">0.13</td>
<td align="right">1218</td>
<td align="right">0.68</td>
<td align="right">0.50</td>
</tr>
<tr class="even">
<td align="left">happy - angry</td>
<td align="left">80%</td>
<td align="right">0.26</td>
<td align="right">0.13</td>
<td align="right">1218</td>
<td align="right">1.93</td>
<td align="right">0.05</td>
</tr>
<tr class="odd">
<td align="left">happy - angry</td>
<td align="left">100%</td>
<td align="right">-0.34</td>
<td align="right">0.13</td>
<td align="right">1218</td>
<td align="right">-2.51</td>
<td align="right">0.01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="bca-with-pdi" class="section level2 tabset tabset-pills">
<h2 class="tabset tabset-pills">BCA with PDI</h2>
<!--- PDI = physical dissimilarity index --->
<div id="base-response-1" class="section level3">
<h3>Base response</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true"></a><span class="co"># https://benwhalley.github.io/just-enough-r/extending-traditional-rm-anova.html</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true"></a>grad_base_lmm_pdi =<span class="st"> </span>grad_base_stats_pdi <span class="op">%&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">convert_as_factor</span>(ID)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true"></a>grad_base_lmm_pdi<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(grad_base_lmm_pdi<span class="op">$</span>emotion)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true"></a>grad_base_lmm_pdi<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(grad_base_lmm_pdi<span class="op">$</span>group)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true"></a>grad_base_lmm_pdi<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(grad_base_lmm_pdi<span class="op">$</span>intens, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true"></a>    <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true"></a>grad_base_lmm_pdi<span class="op">$</span>ROI =<span class="st"> </span><span class="kw">factor</span>(grad_base_lmm_pdi<span class="op">$</span>ROI)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true"></a><span class="co"># Define effect treatment contrasts</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_base_lmm_pdi<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_base_lmm_pdi<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_base_lmm_pdi<span class="op">$</span>ROI) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">2</span>)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_base_lmm_pdi<span class="op">$</span>intens) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">5</span>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true"></a>mod_base_lmer =<span class="st"> </span><span class="kw">lmer</span>(bca <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_base_lmm_pdi, </span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true"></a></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true"></a>mod_base_lmer_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_base_lmer)</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true"></a>mod_base_lmer_res =<span class="st"> </span><span class="kw">subset</span>(mod_base_lmer_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, </span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true"></a>    etasq, omegasq, partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true"></a>mod_base_lmer_res =<span class="st"> </span><span class="kw">head</span>(mod_base_lmer_res, <span class="dv">-1</span>)</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_base_lmer_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">1218</td>
<td align="right">4.65</td>
<td align="right">0.03</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">342.18</td>
<td align="right">0.00</td>
<td align="right">0.53</td>
</tr>
<tr class="odd">
<td align="left">group</td>
<td align="right">1</td>
<td align="right">45</td>
<td align="right">2.07</td>
<td align="right">0.16</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">2.84</td>
<td align="right">0.06</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">0.45</td>
<td align="right">0.77</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">emotion:group</td>
<td align="right">1</td>
<td align="right">1218</td>
<td align="right">1.28</td>
<td align="right">0.26</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens:group</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">2.32</td>
<td align="right">0.06</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">emotion:ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">0.95</td>
<td align="right">0.39</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">0.34</td>
<td align="right">0.95</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">group:ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">1.90</td>
<td align="right">0.15</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">0.41</td>
<td align="right">0.80</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">0.63</td>
<td align="right">0.75</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">emotion:group:ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">0.01</td>
<td align="right">0.99</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens:group:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">0.53</td>
<td align="right">0.83</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">0.05</td>
<td align="right">1.00</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true"></a><span class="co"># Post-hoc tests</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true"></a>m.emo =<span class="st"> </span><span class="kw">emmeans</span>(mod_base_lmer, <span class="st">&quot;emotion&quot;</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true"></a>emo =<span class="st"> </span><span class="kw">contrast</span>(m.emo, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emo, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="left">happy - angry</td>
<td align="right">0</td>
<td align="right">-0.02</td>
<td align="right">0.01</td>
<td align="right">1218</td>
<td align="right">-2.1</td>
<td align="right">0.03</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true"></a>m.int =<span class="st"> </span><span class="kw">emmeans</span>(mod_base_lmer, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true"></a>int =<span class="st"> </span><span class="kw">contrast</span>(m.int, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(int)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
null.value
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
adj.p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
intens
</td>
<td style="text-align:left;">
20% - 40%
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
1218
</td>
<td style="text-align:right;">
24.0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
intens
</td>
<td style="text-align:left;">
20% - 60%
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
1218
</td>
<td style="text-align:right;">
28.6
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
intens
</td>
<td style="text-align:left;">
20% - 80%
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
1218
</td>
<td style="text-align:right;">
30.8
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
intens
</td>
<td style="text-align:left;">
20% - 100%
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.37
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
1218
</td>
<td style="text-align:right;">
32.6
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
intens
</td>
<td style="text-align:left;">
40% - 60%
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
1218
</td>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
intens
</td>
<td style="text-align:left;">
40% - 80%
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
1218
</td>
<td style="text-align:right;">
6.8
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_base_lmer, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true"></a>poly_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;poly&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(poly_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">linear</td>
<td align="right">0</td>
<td align="right">-0.82</td>
<td align="right">0.03</td>
<td align="right">1218</td>
<td align="right">-32.2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">quadratic</td>
<td align="right">0</td>
<td align="right">0.53</td>
<td align="right">0.03</td>
<td align="right">1218</td>
<td align="right">17.6</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">cubic</td>
<td align="right">0</td>
<td align="right">-0.22</td>
<td align="right">0.03</td>
<td align="right">1218</td>
<td align="right">-8.5</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_base_lmer, pairwise <span class="op">~</span><span class="st"> </span>group <span class="op">|</span><span class="st"> </span>intens)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">intens</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">20%</td>
<td align="right">-0.07</td>
<td align="right">0.02</td>
<td align="right">97</td>
<td align="right">-2.71</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">40%</td>
<td align="right">-0.03</td>
<td align="right">0.02</td>
<td align="right">97</td>
<td align="right">-1.23</td>
<td align="right">0.22</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">60%</td>
<td align="right">-0.01</td>
<td align="right">0.02</td>
<td align="right">97</td>
<td align="right">-0.32</td>
<td align="right">0.75</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">80%</td>
<td align="right">-0.01</td>
<td align="right">0.02</td>
<td align="right">97</td>
<td align="right">-0.44</td>
<td align="right">0.66</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">100%</td>
<td align="right">-0.01</td>
<td align="right">0.02</td>
<td align="right">97</td>
<td align="right">-0.55</td>
<td align="right">0.58</td>
</tr>
</tbody>
</table>
</div>
<div id="expression-change-response-1" class="section level3">
<h3>Expression change response</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true"></a><span class="co"># https://benwhalley.github.io/just-enough-r/extending-traditional-rm-anova.html</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true"></a>grad_expr_lmm_pdi =<span class="st"> </span>grad_expr_stats_pdi <span class="op">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">convert_as_factor</span>(ID)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true"></a>grad_expr_lmm_pdi<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm_pdi<span class="op">$</span>emotion)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true"></a>grad_expr_lmm_pdi<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm_pdi<span class="op">$</span>group)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true"></a>grad_expr_lmm_pdi<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm_pdi<span class="op">$</span>intens, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true"></a>    <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true"></a>grad_expr_lmm_pdi<span class="op">$</span>ROI =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm_pdi<span class="op">$</span>ROI)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true"></a><span class="co"># Define effect treatment contrasts</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm_pdi<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm_pdi<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm_pdi<span class="op">$</span>ROI) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">2</span>)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm_pdi<span class="op">$</span>intens) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">5</span>)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true"></a>mod_expr_lmer =<span class="st"> </span><span class="kw">lmer</span>(bca <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_expr_lmm_pdi, </span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_expr_lmer)</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">subset</span>(mod_expr_lmer_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, </span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true"></a>    etasq, omegasq, partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">head</span>(mod_expr_lmer_res, <span class="dv">-1</span>)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_expr_lmer_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">1218</td>
<td align="right">0.44</td>
<td align="right">0.51</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">2.28</td>
<td align="right">0.06</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">group</td>
<td align="right">1</td>
<td align="right">65</td>
<td align="right">0.16</td>
<td align="right">0.69</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">2.41</td>
<td align="right">0.09</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">0.91</td>
<td align="right">0.46</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">emotion:group</td>
<td align="right">1</td>
<td align="right">1218</td>
<td align="right">0.16</td>
<td align="right">0.69</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens:group</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">0.81</td>
<td align="right">0.52</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">emotion:ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">1.62</td>
<td align="right">0.20</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">0.91</td>
<td align="right">0.51</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">group:ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">0.53</td>
<td align="right">0.59</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group</td>
<td align="right">4</td>
<td align="right">1218</td>
<td align="right">0.22</td>
<td align="right">0.92</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">1.15</td>
<td align="right">0.32</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">emotion:group:ROI</td>
<td align="right">2</td>
<td align="right">1218</td>
<td align="right">0.74</td>
<td align="right">0.48</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens:group:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">2.76</td>
<td align="right">0.00</td>
<td align="right">0.02</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group:ROI</td>
<td align="right">8</td>
<td align="right">1218</td>
<td align="right">0.45</td>
<td align="right">0.89</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true"></a><span class="co"># Calculate and show post-hoc tests</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_expr_lmer, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true"></a>main_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(main_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">statistic</th>
<th align="right">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 40%</td>
<td align="right">0</td>
<td align="right">0.04</td>
<td align="right">0.02</td>
<td align="right">1218</td>
<td align="right">2.11</td>
<td align="right">0.21</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 60%</td>
<td align="right">0</td>
<td align="right">0.04</td>
<td align="right">0.02</td>
<td align="right">1218</td>
<td align="right">2.04</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 80%</td>
<td align="right">0</td>
<td align="right">0.04</td>
<td align="right">0.02</td>
<td align="right">1218</td>
<td align="right">2.37</td>
<td align="right">0.12</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 100%</td>
<td align="right">0</td>
<td align="right">0.04</td>
<td align="right">0.02</td>
<td align="right">1218</td>
<td align="right">2.12</td>
<td align="right">0.21</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">40% - 60%</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.02</td>
<td align="right">1218</td>
<td align="right">-0.08</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">40% - 80%</td>
<td align="right">0</td>
<td align="right">0.00</td>
<td align="right">0.02</td>
<td align="right">1218</td>
<td align="right">0.26</td>
<td align="right">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true"></a>poly_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;poly&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(poly_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">linear</td>
<td align="right">0</td>
<td align="right">-0.08</td>
<td align="right">0.04</td>
<td align="right">1218</td>
<td align="right">-2.01</td>
<td align="right">0.04</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">quadratic</td>
<td align="right">0</td>
<td align="right">0.08</td>
<td align="right">0.05</td>
<td align="right">1218</td>
<td align="right">1.63</td>
<td align="right">0.10</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">cubic</td>
<td align="right">0</td>
<td align="right">-0.03</td>
<td align="right">0.04</td>
<td align="right">1218</td>
<td align="right">-0.72</td>
<td align="right">0.47</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true"></a><span class="co"># https://cran.r-project.org/web/packages/emmeans/vignettes/interactions.html</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true"></a>int_emo_int =<span class="st"> </span><span class="kw">emmip</span>(mod_expr_lmer, group <span class="op">~</span><span class="st"> </span>intens <span class="op">|</span><span class="st"> </span>ROI, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#333333&quot;</span>, </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true"></a>    <span class="st">&quot;#D97909&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true"></a>    <span class="dv">3</span>))</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true"></a>int_emo_int</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_expr_pdi-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/int_group_roi.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_expr_lmer, pairwise <span class="op">~</span><span class="st"> </span>group <span class="op">|</span><span class="st"> </span>intens <span class="op">|</span><span class="st"> </span>ROI)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">intens</th>
<th align="left">ROI</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">20%</td>
<td align="left">lOT</td>
<td align="right">-0.13</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">-2.77</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">40%</td>
<td align="left">lOT</td>
<td align="right">0.01</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">0.15</td>
<td align="right">0.88</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">60%</td>
<td align="left">lOT</td>
<td align="right">0.03</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">0.59</td>
<td align="right">0.55</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">80%</td>
<td align="left">lOT</td>
<td align="right">-0.01</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">-0.17</td>
<td align="right">0.87</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">100%</td>
<td align="left">lOT</td>
<td align="right">0.01</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">0.14</td>
<td align="right">0.89</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">20%</td>
<td align="left">MO</td>
<td align="right">0.12</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">2.74</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">40%</td>
<td align="left">MO</td>
<td align="right">-0.14</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">-3.08</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">60%</td>
<td align="left">MO</td>
<td align="right">0.01</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">0.22</td>
<td align="right">0.82</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">80%</td>
<td align="left">MO</td>
<td align="right">-0.01</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">-0.19</td>
<td align="right">0.85</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">100%</td>
<td align="left">MO</td>
<td align="right">0.02</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">0.54</td>
<td align="right">0.59</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">20%</td>
<td align="left">rOT</td>
<td align="right">0.00</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">0.05</td>
<td align="right">0.96</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">40%</td>
<td align="left">rOT</td>
<td align="right">0.02</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">0.39</td>
<td align="right">0.70</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">60%</td>
<td align="left">rOT</td>
<td align="right">0.01</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">0.30</td>
<td align="right">0.77</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">80%</td>
<td align="left">rOT</td>
<td align="right">-0.01</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">-0.18</td>
<td align="right">0.86</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">100%</td>
<td align="left">rOT</td>
<td align="right">0.02</td>
<td align="right">0.05</td>
<td align="right">1188</td>
<td align="right">0.52</td>
<td align="right">0.60</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true"></a><span class="kw">emmip</span>(mod_expr_lmer, ROI <span class="op">~</span><span class="st"> </span>intens, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#F87F75&quot;</span>, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true"></a>    <span class="st">&quot;#69E070&quot;</span>, <span class="st">&quot;#75F8FF&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true"></a>    <span class="dv">3</span>))</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_expr_pdi-2.png" width="960" style="display: block; margin: auto;" /></p>
<p><em>Separated by group: ZE</em></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true"></a><span class="co"># https://benwhalley.github.io/just-enough-r/extending-traditional-rm-anova.html</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true"></a>grad_expr_lmm_pdi =<span class="st"> </span>grad_expr_stats_pdi <span class="op">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">convert_as_factor</span>(ID)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true"></a>grad_expr_lmm_pdi<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm_pdi<span class="op">$</span>emotion)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true"></a>grad_expr_lmm_pdi<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm_pdi<span class="op">$</span>group)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true"></a>grad_expr_lmm_pdi<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm_pdi<span class="op">$</span>intens, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true"></a>    <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true"></a>grad_expr_lmm_pdi<span class="op">$</span>ROI =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm_pdi<span class="op">$</span>ROI)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true"></a><span class="co"># Define effect treatment contrasts</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm_pdi<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm_pdi<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm_pdi<span class="op">$</span>ROI) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">2</span>)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm_pdi<span class="op">$</span>intens) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">5</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true"></a>grad_expr_lmm_pdi_ZE =<span class="st"> </span><span class="kw">subset</span>(grad_expr_lmm_pdi, group <span class="op">==</span><span class="st"> &quot;ZE&quot;</span>)</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true"></a></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true"></a>mod_expr_lmer =<span class="st"> </span><span class="kw">lmer</span>(bca <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_expr_lmm_pdi_ZE, </span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_expr_lmer)</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">subset</span>(mod_expr_lmer_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, </span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true"></a>    etasq, omegasq, partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">head</span>(mod_expr_lmer_res, <span class="dv">-1</span>)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_expr_lmer_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">609</td>
<td align="right">0.21</td>
<td align="right">0.65</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">609</td>
<td align="right">1.32</td>
<td align="right">0.26</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">ROI</td>
<td align="right">2</td>
<td align="right">609</td>
<td align="right">1.44</td>
<td align="right">0.24</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">emotion:intens</td>
<td align="right">4</td>
<td align="right">609</td>
<td align="right">0.44</td>
<td align="right">0.78</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">emotion:ROI</td>
<td align="right">2</td>
<td align="right">609</td>
<td align="right">2.23</td>
<td align="right">0.11</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">intens:ROI</td>
<td align="right">8</td>
<td align="right">609</td>
<td align="right">3.36</td>
<td align="right">0.00</td>
<td align="right">0.04</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:ROI</td>
<td align="right">8</td>
<td align="right">609</td>
<td align="right">1.24</td>
<td align="right">0.27</td>
<td align="right">0.02</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_expr_lmer, pairwise <span class="op">~</span><span class="st"> </span>intens <span class="op">|</span><span class="st"> </span>ROI)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">ROI</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">t.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">20% - 40%</td>
<td align="left">lOT</td>
<td align="right">0.17</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">3.72</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">20% - 60%</td>
<td align="left">lOT</td>
<td align="right">0.16</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">3.49</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">20% - 80%</td>
<td align="left">lOT</td>
<td align="right">0.14</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">3.23</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">20% - 100%</td>
<td align="left">lOT</td>
<td align="right">0.15</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">3.31</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">40% - 60%</td>
<td align="left">lOT</td>
<td align="right">-0.01</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">-0.23</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">40% - 80%</td>
<td align="left">lOT</td>
<td align="right">-0.02</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">-0.49</td>
<td align="right">0.99</td>
</tr>
<tr class="odd">
<td align="left">40% - 100%</td>
<td align="left">lOT</td>
<td align="right">-0.02</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">-0.41</td>
<td align="right">0.99</td>
</tr>
<tr class="even">
<td align="left">60% - 80%</td>
<td align="left">lOT</td>
<td align="right">-0.01</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">-0.26</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">60% - 100%</td>
<td align="left">lOT</td>
<td align="right">-0.01</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">-0.18</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">80% - 100%</td>
<td align="left">lOT</td>
<td align="right">0.00</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">0.08</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">20% - 40%</td>
<td align="left">MO</td>
<td align="right">-0.15</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">-3.29</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">20% - 60%</td>
<td align="left">MO</td>
<td align="right">-0.06</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">-1.43</td>
<td align="right">0.61</td>
</tr>
<tr class="odd">
<td align="left">20% - 80%</td>
<td align="left">MO</td>
<td align="right">-0.06</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">-1.35</td>
<td align="right">0.66</td>
</tr>
<tr class="even">
<td align="left">20% - 100%</td>
<td align="left">MO</td>
<td align="right">-0.04</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">-1.01</td>
<td align="right">0.85</td>
</tr>
<tr class="odd">
<td align="left">40% - 60%</td>
<td align="left">MO</td>
<td align="right">0.08</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">1.86</td>
<td align="right">0.34</td>
</tr>
<tr class="even">
<td align="left">40% - 80%</td>
<td align="left">MO</td>
<td align="right">0.09</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">1.94</td>
<td align="right">0.30</td>
</tr>
<tr class="odd">
<td align="left">40% - 100%</td>
<td align="left">MO</td>
<td align="right">0.10</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">2.28</td>
<td align="right">0.15</td>
</tr>
<tr class="even">
<td align="left">60% - 80%</td>
<td align="left">MO</td>
<td align="right">0.00</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">0.08</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">60% - 100%</td>
<td align="left">MO</td>
<td align="right">0.02</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">0.42</td>
<td align="right">0.99</td>
</tr>
<tr class="even">
<td align="left">80% - 100%</td>
<td align="left">MO</td>
<td align="right">0.01</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">0.34</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">20% - 40%</td>
<td align="left">rOT</td>
<td align="right">0.04</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">0.89</td>
<td align="right">0.90</td>
</tr>
<tr class="even">
<td align="left">20% - 60%</td>
<td align="left">rOT</td>
<td align="right">0.05</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">1.03</td>
<td align="right">0.84</td>
</tr>
<tr class="odd">
<td align="left">20% - 80%</td>
<td align="left">rOT</td>
<td align="right">0.03</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">0.77</td>
<td align="right">0.94</td>
</tr>
<tr class="even">
<td align="left">20% - 100%</td>
<td align="left">rOT</td>
<td align="right">0.04</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">0.93</td>
<td align="right">0.88</td>
</tr>
<tr class="odd">
<td align="left">40% - 60%</td>
<td align="left">rOT</td>
<td align="right">0.01</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">0.14</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">40% - 80%</td>
<td align="left">rOT</td>
<td align="right">-0.01</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">-0.11</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">40% - 100%</td>
<td align="left">rOT</td>
<td align="right">0.00</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">0.05</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">60% - 80%</td>
<td align="left">rOT</td>
<td align="right">-0.01</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">-0.25</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">60% - 100%</td>
<td align="left">rOT</td>
<td align="right">0.00</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">-0.09</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">80% - 100%</td>
<td align="left">rOT</td>
<td align="right">0.01</td>
<td align="right">0.04</td>
<td align="right">609</td>
<td align="right">0.16</td>
<td align="right">1.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true"></a><span class="kw">emmip</span>(mod_expr_lmer, ROI <span class="op">~</span><span class="st"> </span>intens, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#F87F75&quot;</span>, </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true"></a>    <span class="st">&quot;#69E070&quot;</span>, <span class="st">&quot;#75F8FF&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true"></a>    <span class="dv">3</span>))</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_expr_ZE_pdi-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true"></a>grad_expr_lmm_ZE =<span class="st"> </span><span class="kw">subset</span>(grad_expr_lmm, group <span class="op">==</span><span class="st"> &quot;ZE&quot;</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true"></a>mod_expr_lmer =<span class="st"> </span><span class="kw">lmer</span>(bca <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_expr_lmm_ZE, </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_expr_lmer)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">subset</span>(mod_expr_lmer_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true"></a>    etasq, omegasq, partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">head</span>(mod_expr_lmer_res, <span class="dv">-1</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_expr_lmer_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">609</td>
<td align="right">0.35</td>
<td align="right">0.56</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">609</td>
<td align="right">1.82</td>
<td align="right">0.12</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">ROI</td>
<td align="right">2</td>
<td align="right">609</td>
<td align="right">2.24</td>
<td align="right">0.11</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">emotion:intens</td>
<td align="right">4</td>
<td align="right">609</td>
<td align="right">0.90</td>
<td align="right">0.46</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">emotion:ROI</td>
<td align="right">2</td>
<td align="right">609</td>
<td align="right">1.60</td>
<td align="right">0.20</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens:ROI</td>
<td align="right">8</td>
<td align="right">609</td>
<td align="right">2.09</td>
<td align="right">0.04</td>
<td align="right">0.03</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:ROI</td>
<td align="right">8</td>
<td align="right">609</td>
<td align="right">0.79</td>
<td align="right">0.61</td>
<td align="right">0.01</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true"></a><span class="kw">emmip</span>(mod_expr_lmer, ROI <span class="op">~</span><span class="st"> </span>intens, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#F87F75&quot;</span>, </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true"></a>    <span class="st">&quot;#69E070&quot;</span>, <span class="st">&quot;#75F8FF&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true"></a>    <span class="dv">3</span>))</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_expr_ZE_pdi-2.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true"></a>int_emo_int</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_expr_ZE_pdi-3.png" width="960" style="display: block; margin: auto;" /></p>
<p><em>Separated by group: CT</em></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true"></a><span class="co"># https://benwhalley.github.io/just-enough-r/extending-traditional-rm-anova.html</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true"></a>grad_expr_lmm_pdi =<span class="st"> </span>grad_expr_stats_pdi <span class="op">%&gt;%</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">convert_as_factor</span>(ID)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true"></a>grad_expr_lmm_pdi<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm_pdi<span class="op">$</span>emotion)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true"></a>grad_expr_lmm_pdi<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm_pdi<span class="op">$</span>group)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true"></a>grad_expr_lmm_pdi<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm_pdi<span class="op">$</span>intens, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, </span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true"></a>    <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true"></a>grad_expr_lmm_pdi<span class="op">$</span>ROI =<span class="st"> </span><span class="kw">factor</span>(grad_expr_lmm_pdi<span class="op">$</span>ROI)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true"></a></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true"></a><span class="co"># Define effect treatment contrasts</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm_pdi<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm_pdi<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm_pdi<span class="op">$</span>ROI) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">2</span>)</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_expr_lmm_pdi<span class="op">$</span>intens) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">5</span>)</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true"></a>grad_expr_lmm_pdi_CT =<span class="st"> </span><span class="kw">subset</span>(grad_expr_lmm_pdi, group <span class="op">==</span><span class="st"> &quot;CT&quot;</span>)</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true"></a></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true"></a></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true"></a>mod_expr_lmer =<span class="st"> </span><span class="kw">lmer</span>(bca <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_expr_lmm_pdi_CT, </span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true"></a></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true"></a></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_expr_lmer)</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">subset</span>(mod_expr_lmer_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, </span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true"></a>    etasq, omegasq, partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true"></a>mod_expr_lmer_res =<span class="st"> </span><span class="kw">head</span>(mod_expr_lmer_res, <span class="dv">-1</span>)</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_expr_lmer_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">630</td>
<td align="right">0.99</td>
<td align="right">0.32</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">630</td>
<td align="right">1.36</td>
<td align="right">0.25</td>
<td align="right">0.01</td>
</tr>
<tr class="odd">
<td align="left">ROI</td>
<td align="right">2</td>
<td align="right">630</td>
<td align="right">1.51</td>
<td align="right">0.22</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">emotion:intens</td>
<td align="right">4</td>
<td align="right">630</td>
<td align="right">0.69</td>
<td align="right">0.60</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">emotion:ROI</td>
<td align="right">2</td>
<td align="right">630</td>
<td align="right">0.20</td>
<td align="right">0.82</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens:ROI</td>
<td align="right">8</td>
<td align="right">630</td>
<td align="right">0.39</td>
<td align="right">0.93</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:ROI</td>
<td align="right">8</td>
<td align="right">630</td>
<td align="right">0.39</td>
<td align="right">0.93</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="time-domain-analyses" class="section level1 tabset">
<h1 class="tabset">Time-domain analyses</h1>
<div id="visualization-2" class="section level2 tabset tabset-pills">
<h2 class="tabset tabset-pills">Visualization</h2>
<div id="erp-trajectory" class="section level3">
<h3>ERP trajectory</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true"></a><span class="co"># Load data</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true"></a>hap_twent_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_twent_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true"></a>hap_fort_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_fort_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true"></a>hap_sixt_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_sixt_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true"></a>hap_eigt_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_eigt_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true"></a>hap_oneh_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_oneh_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true"></a></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true"></a><span class="co"># Add emotion condition</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true"></a>hap_twent_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true"></a>hap_fort_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true"></a>hap_sixt_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true"></a>hap_eigt_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true"></a>hap_oneh_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true"></a></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true"></a><span class="co"># Add intensity</span></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true"></a>hap_twent_traj<span class="op">$</span>int =<span class="st"> &quot;20%&quot;</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true"></a>hap_fort_traj<span class="op">$</span>int =<span class="st"> &quot;40%&quot;</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true"></a>hap_sixt_traj<span class="op">$</span>int =<span class="st"> &quot;60%&quot;</span></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true"></a>hap_eigt_traj<span class="op">$</span>int =<span class="st"> &quot;80%&quot;</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true"></a>hap_oneh_traj<span class="op">$</span>int =<span class="st"> &quot;100%&quot;</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true"></a></span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true"></a><span class="co"># Combine data sets</span></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true"></a>hap_traj =<span class="st"> </span><span class="kw">rbind</span>(hap_twent_traj, hap_fort_traj, hap_sixt_traj, hap_eigt_traj, hap_oneh_traj)</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true"></a></span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true"></a>hap_traj<span class="op">$</span>int =<span class="st"> </span><span class="kw">factor</span>(hap_traj<span class="op">$</span>int, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true"></a></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true"></a></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true"></a><span class="co"># Load data</span></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true"></a>ang_twent_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_twent_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true"></a>ang_fort_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_fort_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, </span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true"></a>ang_sixt_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_sixt_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, </span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true"></a>ang_eigt_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_eigt_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, </span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true"></a>ang_oneh_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_oneh_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, </span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true"></a>    <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true"></a></span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true"></a><span class="co"># Add emotion condition</span></span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true"></a>ang_twent_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true"></a>ang_fort_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true"></a>ang_sixt_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true"></a>ang_eigt_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true"></a>ang_oneh_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true"></a></span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true"></a><span class="co"># Add intensity</span></span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true"></a>ang_twent_traj<span class="op">$</span>int =<span class="st"> &quot;20%&quot;</span></span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true"></a>ang_fort_traj<span class="op">$</span>int =<span class="st"> &quot;40%&quot;</span></span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true"></a>ang_sixt_traj<span class="op">$</span>int =<span class="st"> &quot;60%&quot;</span></span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true"></a>ang_eigt_traj<span class="op">$</span>int =<span class="st"> &quot;80%&quot;</span></span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true"></a>ang_oneh_traj<span class="op">$</span>int =<span class="st"> &quot;100%&quot;</span></span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true"></a></span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true"></a><span class="co"># Combine data sets</span></span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true"></a>ang_traj =<span class="st"> </span><span class="kw">rbind</span>(ang_twent_traj, ang_fort_traj, ang_sixt_traj, ang_eigt_traj, ang_oneh_traj)</span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true"></a></span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true"></a>ang_traj<span class="op">$</span>int =<span class="st"> </span><span class="kw">factor</span>(ang_traj<span class="op">$</span>int, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb58-63"><a href="#cb58-63" aria-hidden="true"></a></span>
<span id="cb58-64"><a href="#cb58-64" aria-hidden="true"></a><span class="co"># Select lOT electrodes and average across electrodes</span></span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true"></a>grad_lOT_hap =<span class="st"> </span><span class="kw">subset</span>(hap_traj, <span class="dt">select =</span> <span class="kw">c</span>(ID, time, int, emotion, PO7, P7, PO9, </span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true"></a>    PO3))</span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true"></a></span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true"></a>grad_lOT_av_hap =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> grad_lOT_hap[, <span class="dv">1</span>], <span class="dt">time =</span> grad_lOT_hap[, <span class="dv">2</span>], <span class="dt">int =</span> grad_lOT_hap[, </span>
<span id="cb58-69"><a href="#cb58-69" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">emotion =</span> grad_lOT_hap[, <span class="dv">4</span>], <span class="dt">Means =</span> <span class="kw">rowMeans</span>(grad_lOT_hap[, <span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb58-70"><a href="#cb58-70" aria-hidden="true"></a></span>
<span id="cb58-71"><a href="#cb58-71" aria-hidden="true"></a></span>
<span id="cb58-72"><a href="#cb58-72" aria-hidden="true"></a>grad_lOT_ang =<span class="st"> </span><span class="kw">subset</span>(ang_traj, <span class="dt">select =</span> <span class="kw">c</span>(ID, time, int, emotion, PO7, P7, PO9, </span>
<span id="cb58-73"><a href="#cb58-73" aria-hidden="true"></a>    PO3))</span>
<span id="cb58-74"><a href="#cb58-74" aria-hidden="true"></a></span>
<span id="cb58-75"><a href="#cb58-75" aria-hidden="true"></a>grad_lOT_av_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> grad_lOT_ang[, <span class="dv">1</span>], <span class="dt">time =</span> grad_lOT_ang[, <span class="dv">2</span>], <span class="dt">int =</span> grad_lOT_ang[, </span>
<span id="cb58-76"><a href="#cb58-76" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">emotion =</span> grad_lOT_ang[, <span class="dv">4</span>], <span class="dt">Means =</span> <span class="kw">rowMeans</span>(grad_lOT_ang[, <span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb58-77"><a href="#cb58-77" aria-hidden="true"></a></span>
<span id="cb58-78"><a href="#cb58-78" aria-hidden="true"></a></span>
<span id="cb58-79"><a href="#cb58-79" aria-hidden="true"></a></span>
<span id="cb58-80"><a href="#cb58-80" aria-hidden="true"></a>grad_lOT_av_hap<span class="op">$</span>mean_emo =<span class="st"> </span>(grad_lOT_av_hap<span class="op">$</span>Means <span class="op">+</span><span class="st"> </span>grad_lOT_av_ang<span class="op">$</span>Means)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb58-81"><a href="#cb58-81" aria-hidden="true"></a></span>
<span id="cb58-82"><a href="#cb58-82" aria-hidden="true"></a></span>
<span id="cb58-83"><a href="#cb58-83" aria-hidden="true"></a><span class="co"># Plot data</span></span>
<span id="cb58-84"><a href="#cb58-84" aria-hidden="true"></a>lOT =<span class="st"> </span><span class="kw">ggplot</span>(grad_lOT_av_hap, <span class="kw">aes</span>(time, mean_emo)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;lOT&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb58-85"><a href="#cb58-85" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb58-86"><a href="#cb58-86" aria-hidden="true"></a>        <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-87"><a href="#cb58-87" aria-hidden="true"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> int)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-88"><a href="#cb58-88" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-89"><a href="#cb58-89" aria-hidden="true"></a><span class="st">    </span><span class="co"># scale_color_OkabeIto()+</span></span>
<span id="cb58-90"><a href="#cb58-90" aria-hidden="true"></a><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;gray88&quot;</span>, <span class="st">&quot;gray82&quot;</span>, <span class="st">&quot;gray60&quot;</span>, <span class="st">&quot;gray44&quot;</span>, <span class="st">&quot;gray8&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-91"><a href="#cb58-91" aria-hidden="true"></a><span class="st">    </span><span class="co"># theme(axis.title.x=element_blank())+ # to turn of x-axis title</span></span>
<span id="cb58-92"><a href="#cb58-92" aria-hidden="true"></a><span class="co"># theme(axis.title.y=element_blank())+ # to turn of y-axis title</span></span>
<span id="cb58-93"><a href="#cb58-93" aria-hidden="true"></a><span class="co"># theme(text=element_text(family=&#39;Coves&#39;, face=&#39;bold&#39;, size=18))+</span></span>
<span id="cb58-94"><a href="#cb58-94" aria-hidden="true"></a><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-95"><a href="#cb58-95" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, </span>
<span id="cb58-96"><a href="#cb58-96" aria-hidden="true"></a>    <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">167</span>, </span>
<span id="cb58-97"><a href="#cb58-97" aria-hidden="true"></a>    <span class="dv">667</span>, <span class="dv">167</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-98"><a href="#cb58-98" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb58-99"><a href="#cb58-99" aria-hidden="true"></a></span>
<span id="cb58-100"><a href="#cb58-100" aria-hidden="true"></a></span>
<span id="cb58-101"><a href="#cb58-101" aria-hidden="true"></a><span class="co"># Select rOT electrodes and average across electrodes</span></span>
<span id="cb58-102"><a href="#cb58-102" aria-hidden="true"></a>grad_rOT_hap =<span class="st"> </span><span class="kw">subset</span>(hap_traj, <span class="dt">select =</span> <span class="kw">c</span>(ID, time, int, emotion, PO8, P8, PO10, </span>
<span id="cb58-103"><a href="#cb58-103" aria-hidden="true"></a>    PO4))</span>
<span id="cb58-104"><a href="#cb58-104" aria-hidden="true"></a></span>
<span id="cb58-105"><a href="#cb58-105" aria-hidden="true"></a>grad_rOT_av_hap =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> grad_rOT_hap[, <span class="dv">1</span>], <span class="dt">time =</span> grad_rOT_hap[, <span class="dv">2</span>], <span class="dt">int =</span> grad_rOT_hap[, </span>
<span id="cb58-106"><a href="#cb58-106" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">emotion =</span> grad_rOT_hap[, <span class="dv">4</span>], <span class="dt">Means =</span> <span class="kw">rowMeans</span>(grad_rOT_hap[, <span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb58-107"><a href="#cb58-107" aria-hidden="true"></a></span>
<span id="cb58-108"><a href="#cb58-108" aria-hidden="true"></a></span>
<span id="cb58-109"><a href="#cb58-109" aria-hidden="true"></a>grad_rOT_ang =<span class="st"> </span><span class="kw">subset</span>(ang_traj, <span class="dt">select =</span> <span class="kw">c</span>(ID, time, int, emotion, PO8, P8, PO10, </span>
<span id="cb58-110"><a href="#cb58-110" aria-hidden="true"></a>    PO4))</span>
<span id="cb58-111"><a href="#cb58-111" aria-hidden="true"></a></span>
<span id="cb58-112"><a href="#cb58-112" aria-hidden="true"></a>grad_rOT_av_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> grad_rOT_ang[, <span class="dv">1</span>], <span class="dt">time =</span> grad_rOT_ang[, <span class="dv">2</span>], <span class="dt">int =</span> grad_rOT_ang[, </span>
<span id="cb58-113"><a href="#cb58-113" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">emotion =</span> grad_rOT_ang[, <span class="dv">4</span>], <span class="dt">Means =</span> <span class="kw">rowMeans</span>(grad_rOT_ang[, <span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb58-114"><a href="#cb58-114" aria-hidden="true"></a></span>
<span id="cb58-115"><a href="#cb58-115" aria-hidden="true"></a></span>
<span id="cb58-116"><a href="#cb58-116" aria-hidden="true"></a></span>
<span id="cb58-117"><a href="#cb58-117" aria-hidden="true"></a>grad_rOT_av_hap<span class="op">$</span>mean_emo =<span class="st"> </span>(grad_rOT_av_hap<span class="op">$</span>Means <span class="op">+</span><span class="st"> </span>grad_rOT_av_ang<span class="op">$</span>Means)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb58-118"><a href="#cb58-118" aria-hidden="true"></a></span>
<span id="cb58-119"><a href="#cb58-119" aria-hidden="true"></a></span>
<span id="cb58-120"><a href="#cb58-120" aria-hidden="true"></a><span class="co"># Plot data</span></span>
<span id="cb58-121"><a href="#cb58-121" aria-hidden="true"></a>rOT =<span class="st"> </span><span class="kw">ggplot</span>(grad_rOT_av_hap, <span class="kw">aes</span>(time, mean_emo)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;rOT&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb58-122"><a href="#cb58-122" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb58-123"><a href="#cb58-123" aria-hidden="true"></a>        <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-124"><a href="#cb58-124" aria-hidden="true"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> int)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-125"><a href="#cb58-125" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-126"><a href="#cb58-126" aria-hidden="true"></a><span class="st">    </span><span class="co"># scale_color_OkabeIto()+</span></span>
<span id="cb58-127"><a href="#cb58-127" aria-hidden="true"></a><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;gray88&quot;</span>, <span class="st">&quot;gray82&quot;</span>, <span class="st">&quot;gray60&quot;</span>, <span class="st">&quot;gray44&quot;</span>, <span class="st">&quot;gray8&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-128"><a href="#cb58-128" aria-hidden="true"></a><span class="st">    </span><span class="co"># theme(axis.title.x=element_blank())+ # to turn of x-axis title</span></span>
<span id="cb58-129"><a href="#cb58-129" aria-hidden="true"></a><span class="co"># theme(axis.title.y=element_blank())+ # to turn of y-axis title</span></span>
<span id="cb58-130"><a href="#cb58-130" aria-hidden="true"></a><span class="co"># theme(text=element_text(family=&#39;Coves&#39;, face=&#39;bold&#39;, size=18))+</span></span>
<span id="cb58-131"><a href="#cb58-131" aria-hidden="true"></a><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-132"><a href="#cb58-132" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, </span>
<span id="cb58-133"><a href="#cb58-133" aria-hidden="true"></a>    <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">167</span>, </span>
<span id="cb58-134"><a href="#cb58-134" aria-hidden="true"></a>    <span class="dv">667</span>, <span class="dv">167</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-135"><a href="#cb58-135" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb58-136"><a href="#cb58-136" aria-hidden="true"></a></span>
<span id="cb58-137"><a href="#cb58-137" aria-hidden="true"></a><span class="co"># Select MO electrodes and average across electrodes</span></span>
<span id="cb58-138"><a href="#cb58-138" aria-hidden="true"></a>grad_MO_hap =<span class="st"> </span><span class="kw">subset</span>(hap_traj, <span class="dt">select =</span> <span class="kw">c</span>(ID, time, int, emotion, O1, O2, Oz))</span>
<span id="cb58-139"><a href="#cb58-139" aria-hidden="true"></a></span>
<span id="cb58-140"><a href="#cb58-140" aria-hidden="true"></a>grad_MO_av_hap =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> grad_MO_hap[, <span class="dv">1</span>], <span class="dt">time =</span> grad_MO_hap[, <span class="dv">2</span>], <span class="dt">int =</span> grad_MO_hap[, </span>
<span id="cb58-141"><a href="#cb58-141" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">emotion =</span> grad_MO_hap[, <span class="dv">4</span>], <span class="dt">Means =</span> <span class="kw">rowMeans</span>(grad_MO_hap[, <span class="dv">5</span><span class="op">:</span><span class="dv">7</span>]))</span>
<span id="cb58-142"><a href="#cb58-142" aria-hidden="true"></a></span>
<span id="cb58-143"><a href="#cb58-143" aria-hidden="true"></a></span>
<span id="cb58-144"><a href="#cb58-144" aria-hidden="true"></a>grad_MO_ang =<span class="st"> </span><span class="kw">subset</span>(ang_traj, <span class="dt">select =</span> <span class="kw">c</span>(ID, time, int, emotion, O1, O2, Oz))</span>
<span id="cb58-145"><a href="#cb58-145" aria-hidden="true"></a></span>
<span id="cb58-146"><a href="#cb58-146" aria-hidden="true"></a>grad_MO_av_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> grad_MO_ang[, <span class="dv">1</span>], <span class="dt">time =</span> grad_MO_ang[, <span class="dv">2</span>], <span class="dt">int =</span> grad_MO_ang[, </span>
<span id="cb58-147"><a href="#cb58-147" aria-hidden="true"></a>    <span class="dv">3</span>], <span class="dt">emotion =</span> grad_MO_ang[, <span class="dv">4</span>], <span class="dt">Means =</span> <span class="kw">rowMeans</span>(grad_MO_ang[, <span class="dv">5</span><span class="op">:</span><span class="dv">7</span>]))</span>
<span id="cb58-148"><a href="#cb58-148" aria-hidden="true"></a></span>
<span id="cb58-149"><a href="#cb58-149" aria-hidden="true"></a>grad_MO_av_hap<span class="op">$</span>mean_emo =<span class="st"> </span>(grad_MO_av_hap<span class="op">$</span>Means <span class="op">+</span><span class="st"> </span>grad_MO_av_ang<span class="op">$</span>Means)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb58-150"><a href="#cb58-150" aria-hidden="true"></a></span>
<span id="cb58-151"><a href="#cb58-151" aria-hidden="true"></a></span>
<span id="cb58-152"><a href="#cb58-152" aria-hidden="true"></a><span class="co"># Plot data</span></span>
<span id="cb58-153"><a href="#cb58-153" aria-hidden="true"></a>MO =<span class="st"> </span><span class="kw">ggplot</span>(grad_MO_av_hap, <span class="kw">aes</span>(time, mean_emo)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;MO&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb58-154"><a href="#cb58-154" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb58-155"><a href="#cb58-155" aria-hidden="true"></a>        <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-156"><a href="#cb58-156" aria-hidden="true"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> int)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-157"><a href="#cb58-157" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-158"><a href="#cb58-158" aria-hidden="true"></a><span class="st">    </span><span class="co"># scale_color_OkabeIto()+</span></span>
<span id="cb58-159"><a href="#cb58-159" aria-hidden="true"></a><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;gray88&quot;</span>, <span class="st">&quot;gray82&quot;</span>, <span class="st">&quot;gray60&quot;</span>, <span class="st">&quot;gray44&quot;</span>, <span class="st">&quot;gray8&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-160"><a href="#cb58-160" aria-hidden="true"></a><span class="st">    </span><span class="co"># theme(axis.title.x=element_blank())+ # to turn of x-axis title</span></span>
<span id="cb58-161"><a href="#cb58-161" aria-hidden="true"></a><span class="co"># theme(axis.title.y=element_blank())+ # to turn of y-axis title</span></span>
<span id="cb58-162"><a href="#cb58-162" aria-hidden="true"></a><span class="co"># theme(text=element_text(family=&#39;Coves&#39;, face=&#39;bold&#39;, size=18))+</span></span>
<span id="cb58-163"><a href="#cb58-163" aria-hidden="true"></a><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-164"><a href="#cb58-164" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">2</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, </span>
<span id="cb58-165"><a href="#cb58-165" aria-hidden="true"></a>    <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">167</span>, </span>
<span id="cb58-166"><a href="#cb58-166" aria-hidden="true"></a>    <span class="dv">667</span>, <span class="dv">167</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb58-167"><a href="#cb58-167" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb58-168"><a href="#cb58-168" aria-hidden="true"></a></span>
<span id="cb58-169"><a href="#cb58-169" aria-hidden="true"></a></span>
<span id="cb58-170"><a href="#cb58-170" aria-hidden="true"></a><span class="co"># Combine plots</span></span>
<span id="cb58-171"><a href="#cb58-171" aria-hidden="true"></a>erp_plots =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(lOT, MO, rOT, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb58-172"><a href="#cb58-172" aria-hidden="true"></a>erp_plots</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/grad_plot_ERPs-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><em>Happy</em></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true"></a><span class="co"># Load data</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true"></a>  hap_twent_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_twent_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true"></a>  hap_fort_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_fort_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true"></a>  hap_sixt_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_sixt_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true"></a>  hap_eigt_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_eigt_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true"></a>  hap_oneh_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_oneh_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true"></a></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true"></a><span class="co"># Add emotion condition</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true"></a>  hap_twent_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true"></a>  hap_fort_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true"></a>  hap_sixt_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true"></a>  hap_eigt_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true"></a>  hap_oneh_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true"></a><span class="co"># Add intensity</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true"></a>  hap_twent_traj<span class="op">$</span>int =<span class="st"> &quot;20%&quot;</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true"></a>  hap_fort_traj<span class="op">$</span>int =<span class="st"> &quot;40%&quot;</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true"></a>  hap_sixt_traj<span class="op">$</span>int =<span class="st"> &quot;60%&quot;</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true"></a>  hap_eigt_traj<span class="op">$</span>int =<span class="st"> &quot;80%&quot;</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true"></a>  hap_oneh_traj<span class="op">$</span>int =<span class="st"> &quot;100%&quot;</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true"></a></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true"></a><span class="co"># Combine data sets</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true"></a>  hap_traj =<span class="st"> </span><span class="kw">rbind</span>(hap_twent_traj,hap_fort_traj,hap_sixt_traj,hap_eigt_traj,hap_oneh_traj)</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true"></a>  hap_traj<span class="op">$</span>int =<span class="st"> </span><span class="kw">factor</span>(hap_traj<span class="op">$</span>int, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>))</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true"></a>  </span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true"></a>  </span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true"></a>  <span class="co"># Load data</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true"></a>  ang_twent_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_twent_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true"></a>  ang_fort_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_fort_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true"></a>  ang_sixt_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_sixt_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true"></a>  ang_eigt_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_eigt_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true"></a>  ang_oneh_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_oneh_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true"></a></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true"></a><span class="co"># Add emotion condition</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true"></a>  ang_twent_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true"></a>  ang_fort_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true"></a>  ang_sixt_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true"></a>  ang_eigt_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true"></a>  ang_oneh_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true"></a></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true"></a><span class="co"># Add intensity</span></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true"></a>  ang_twent_traj<span class="op">$</span>int =<span class="st"> &quot;20%&quot;</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true"></a>  ang_fort_traj<span class="op">$</span>int =<span class="st"> &quot;40%&quot;</span></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true"></a>  ang_sixt_traj<span class="op">$</span>int =<span class="st"> &quot;60%&quot;</span></span>
<span id="cb59-46"><a href="#cb59-46" aria-hidden="true"></a>  ang_eigt_traj<span class="op">$</span>int =<span class="st"> &quot;80%&quot;</span></span>
<span id="cb59-47"><a href="#cb59-47" aria-hidden="true"></a>  ang_oneh_traj<span class="op">$</span>int =<span class="st"> &quot;100%&quot;</span></span>
<span id="cb59-48"><a href="#cb59-48" aria-hidden="true"></a></span>
<span id="cb59-49"><a href="#cb59-49" aria-hidden="true"></a><span class="co"># Combine data sets</span></span>
<span id="cb59-50"><a href="#cb59-50" aria-hidden="true"></a>  ang_traj =<span class="st"> </span><span class="kw">rbind</span>(ang_twent_traj,ang_fort_traj,ang_sixt_traj,ang_eigt_traj,ang_oneh_traj)</span>
<span id="cb59-51"><a href="#cb59-51" aria-hidden="true"></a></span>
<span id="cb59-52"><a href="#cb59-52" aria-hidden="true"></a>  ang_traj<span class="op">$</span>int =<span class="st"> </span><span class="kw">factor</span>(ang_traj<span class="op">$</span>int, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>))</span>
<span id="cb59-53"><a href="#cb59-53" aria-hidden="true"></a></span>
<span id="cb59-54"><a href="#cb59-54" aria-hidden="true"></a><span class="co"># Select lOT electrodes and average across electrodes</span></span>
<span id="cb59-55"><a href="#cb59-55" aria-hidden="true"></a>  grad_lOT_hap =<span class="st"> </span><span class="kw">subset</span>(hap_traj, <span class="dt">select=</span><span class="kw">c</span>(ID, time, int, emotion, PO7, P7, PO9, PO3))</span>
<span id="cb59-56"><a href="#cb59-56" aria-hidden="true"></a></span>
<span id="cb59-57"><a href="#cb59-57" aria-hidden="true"></a>  grad_lOT_av_hap =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span>grad_lOT_hap [,<span class="dv">1</span>], <span class="dt">time=</span>grad_lOT_hap [,<span class="dv">2</span>], <span class="dt">int=</span>grad_lOT_hap [,<span class="dv">3</span>], <span class="dt">emotion=</span>grad_lOT_hap [,<span class="dv">4</span>], <span class="dt">Means=</span><span class="kw">rowMeans</span>(grad_lOT_hap [,<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb59-58"><a href="#cb59-58" aria-hidden="true"></a>  </span>
<span id="cb59-59"><a href="#cb59-59" aria-hidden="true"></a>  </span>
<span id="cb59-60"><a href="#cb59-60" aria-hidden="true"></a>  grad_lOT_ang =<span class="st"> </span><span class="kw">subset</span>(ang_traj, <span class="dt">select=</span><span class="kw">c</span>(ID, time, int, emotion, PO7, P7, PO9, PO3))</span>
<span id="cb59-61"><a href="#cb59-61" aria-hidden="true"></a></span>
<span id="cb59-62"><a href="#cb59-62" aria-hidden="true"></a>  grad_lOT_av_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span>grad_lOT_ang[,<span class="dv">1</span>], <span class="dt">time=</span>grad_lOT_ang[,<span class="dv">2</span>],</span>
<span id="cb59-63"><a href="#cb59-63" aria-hidden="true"></a>                               <span class="dt">int=</span>grad_lOT_ang[,<span class="dv">3</span>], <span class="dt">emotion=</span>grad_lOT_ang[,<span class="dv">4</span>], <span class="dt">Means=</span><span class="kw">rowMeans</span>(grad_lOT_ang[,<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb59-64"><a href="#cb59-64" aria-hidden="true"></a>  </span>
<span id="cb59-65"><a href="#cb59-65" aria-hidden="true"></a></span>
<span id="cb59-66"><a href="#cb59-66" aria-hidden="true"></a>  </span>
<span id="cb59-67"><a href="#cb59-67" aria-hidden="true"></a>  grad_lOT_av_hap<span class="op">$</span>mean_emo =<span class="st"> </span>(grad_lOT_av_hap<span class="op">$</span>Means<span class="op">+</span>grad_lOT_av_ang<span class="op">$</span>Means)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb59-68"><a href="#cb59-68" aria-hidden="true"></a></span>
<span id="cb59-69"><a href="#cb59-69" aria-hidden="true"></a></span>
<span id="cb59-70"><a href="#cb59-70" aria-hidden="true"></a><span class="co"># Plot data</span></span>
<span id="cb59-71"><a href="#cb59-71" aria-hidden="true"></a>     lOT =<span class="st"> </span><span class="kw">ggplot</span>(grad_lOT_av_hap,<span class="kw">aes</span>(time,Means))<span class="op">+</span></span>
<span id="cb59-72"><a href="#cb59-72" aria-hidden="true"></a><span class="st">          </span><span class="kw">ggtitle</span>(<span class="st">&quot;lOT&quot;</span>) <span class="op">+</span></span>
<span id="cb59-73"><a href="#cb59-73" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),</span>
<span id="cb59-74"><a href="#cb59-74" aria-hidden="true"></a>                <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">7</span>),</span>
<span id="cb59-75"><a href="#cb59-75" aria-hidden="true"></a>                <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))<span class="op">+</span></span>
<span id="cb59-76"><a href="#cb59-76" aria-hidden="true"></a><span class="st">          </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> int))<span class="op">+</span></span>
<span id="cb59-77"><a href="#cb59-77" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)))<span class="op">+</span></span>
<span id="cb59-78"><a href="#cb59-78" aria-hidden="true"></a><span class="st">          </span><span class="co">#scale_color_OkabeIto()+</span></span>
<span id="cb59-79"><a href="#cb59-79" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#cceaff&quot;</span>,<span class="st">&quot;#80ccff&quot;</span>,<span class="st">&quot;#0098ff&quot;</span>,<span class="st">&quot;#005b99&quot;</span>,<span class="st">&quot;#002e4c&quot;</span>))<span class="op">+</span></span>
<span id="cb59-80"><a href="#cb59-80" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(axis.title.x=element_blank())+      # to turn of x-axis title</span></span>
<span id="cb59-81"><a href="#cb59-81" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(axis.title.y=element_blank())+      # to turn of y-axis title</span></span>
<span id="cb59-82"><a href="#cb59-82" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(text=element_text(family=&quot;Coves&quot;, face=&quot;bold&quot;, size=18))+</span></span>
<span id="cb59-83"><a href="#cb59-83" aria-hidden="true"></a><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb59-84"><a href="#cb59-84" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">15</span>)<span class="op">+</span></span>
<span id="cb59-85"><a href="#cb59-85" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb59-86"><a href="#cb59-86" aria-hidden="true"></a>          <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</span>
<span id="cb59-87"><a href="#cb59-87" aria-hidden="true"></a>          <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="co"># get rid of legend bg</span></span>
<span id="cb59-88"><a href="#cb59-88" aria-hidden="true"></a>          <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>))<span class="op">+</span></span>
<span id="cb59-89"><a href="#cb59-89" aria-hidden="true"></a><span class="st">          </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">4</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">500</span>)) <span class="op">+</span></span>
<span id="cb59-90"><a href="#cb59-90" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb59-91"><a href="#cb59-91" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">200</span>))<span class="op">+</span></span>
<span id="cb59-92"><a href="#cb59-92" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span></span>
<span id="cb59-93"><a href="#cb59-93" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span></span>
<span id="cb59-94"><a href="#cb59-94" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">120</span>, <span class="dt">xmax =</span> <span class="dv">200</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb59-95"><a href="#cb59-95" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">220</span>, <span class="dt">xmax =</span> <span class="dv">300</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb59-96"><a href="#cb59-96" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">350</span>, <span class="dt">xmax =</span> <span class="dv">450</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)</span>
<span id="cb59-97"><a href="#cb59-97" aria-hidden="true"></a></span>
<span id="cb59-98"><a href="#cb59-98" aria-hidden="true"></a>     </span>
<span id="cb59-99"><a href="#cb59-99" aria-hidden="true"></a><span class="co"># Select rOT electrodes and average across electrodes</span></span>
<span id="cb59-100"><a href="#cb59-100" aria-hidden="true"></a>  grad_rOT_hap =<span class="st"> </span><span class="kw">subset</span>(hap_traj, <span class="dt">select=</span><span class="kw">c</span>(ID, time, int, emotion, PO8, P8, PO10, PO4))</span>
<span id="cb59-101"><a href="#cb59-101" aria-hidden="true"></a></span>
<span id="cb59-102"><a href="#cb59-102" aria-hidden="true"></a>  grad_rOT_av_hap =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span>grad_rOT_hap[,<span class="dv">1</span>], <span class="dt">time=</span>grad_rOT_hap[,<span class="dv">2</span>], <span class="dt">int=</span>grad_rOT_hap[,<span class="dv">3</span>], <span class="dt">emotion=</span>grad_rOT_hap[,<span class="dv">4</span>], <span class="dt">Means=</span><span class="kw">rowMeans</span>(grad_rOT_hap[,<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb59-103"><a href="#cb59-103" aria-hidden="true"></a>  </span>
<span id="cb59-104"><a href="#cb59-104" aria-hidden="true"></a>  </span>
<span id="cb59-105"><a href="#cb59-105" aria-hidden="true"></a>  grad_rOT_ang =<span class="st"> </span><span class="kw">subset</span>(ang_traj, <span class="dt">select=</span><span class="kw">c</span>(ID, time, int, emotion, PO8, P8, PO10, PO4))</span>
<span id="cb59-106"><a href="#cb59-106" aria-hidden="true"></a></span>
<span id="cb59-107"><a href="#cb59-107" aria-hidden="true"></a>  grad_rOT_av_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span>grad_rOT_ang[,<span class="dv">1</span>], <span class="dt">time=</span>grad_rOT_ang[,<span class="dv">2</span>], <span class="dt">int=</span>grad_rOT_ang[,<span class="dv">3</span>], <span class="dt">emotion=</span>grad_rOT_ang[,<span class="dv">4</span>], <span class="dt">Means=</span><span class="kw">rowMeans</span>(grad_rOT_ang[,<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb59-108"><a href="#cb59-108" aria-hidden="true"></a>  </span>
<span id="cb59-109"><a href="#cb59-109" aria-hidden="true"></a></span>
<span id="cb59-110"><a href="#cb59-110" aria-hidden="true"></a>  </span>
<span id="cb59-111"><a href="#cb59-111" aria-hidden="true"></a>  grad_rOT_av_hap<span class="op">$</span>mean_emo =<span class="st"> </span>(grad_rOT_av_hap<span class="op">$</span>Means<span class="op">+</span>grad_rOT_av_ang<span class="op">$</span>Means)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb59-112"><a href="#cb59-112" aria-hidden="true"></a>       </span>
<span id="cb59-113"><a href="#cb59-113" aria-hidden="true"></a>         </span>
<span id="cb59-114"><a href="#cb59-114" aria-hidden="true"></a> <span class="co"># Plot data    </span></span>
<span id="cb59-115"><a href="#cb59-115" aria-hidden="true"></a>      rOT =<span class="st"> </span><span class="kw">ggplot</span>(grad_rOT_av_hap,<span class="kw">aes</span>(time,Means))<span class="op">+</span></span>
<span id="cb59-116"><a href="#cb59-116" aria-hidden="true"></a><span class="st">          </span><span class="kw">ggtitle</span>(<span class="st">&quot;rOT&quot;</span>) <span class="op">+</span></span>
<span id="cb59-117"><a href="#cb59-117" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),</span>
<span id="cb59-118"><a href="#cb59-118" aria-hidden="true"></a>                <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">7</span>),</span>
<span id="cb59-119"><a href="#cb59-119" aria-hidden="true"></a>                <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))<span class="op">+</span></span>
<span id="cb59-120"><a href="#cb59-120" aria-hidden="true"></a><span class="st">          </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> int))<span class="op">+</span></span>
<span id="cb59-121"><a href="#cb59-121" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)))<span class="op">+</span></span>
<span id="cb59-122"><a href="#cb59-122" aria-hidden="true"></a><span class="st">          </span><span class="co">#scale_color_OkabeIto()+</span></span>
<span id="cb59-123"><a href="#cb59-123" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#cceaff&quot;</span>,<span class="st">&quot;#80ccff&quot;</span>,<span class="st">&quot;#0098ff&quot;</span>,<span class="st">&quot;#005b99&quot;</span>,<span class="st">&quot;#002e4c&quot;</span>))<span class="op">+</span></span>
<span id="cb59-124"><a href="#cb59-124" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(axis.title.x=element_blank())+      # to turn of x-axis title</span></span>
<span id="cb59-125"><a href="#cb59-125" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(axis.title.y=element_blank())+      # to turn of y-axis title</span></span>
<span id="cb59-126"><a href="#cb59-126" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(text=element_text(family=&quot;Coves&quot;, face=&quot;bold&quot;, size=18))+</span></span>
<span id="cb59-127"><a href="#cb59-127" aria-hidden="true"></a><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb59-128"><a href="#cb59-128" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">15</span>)<span class="op">+</span></span>
<span id="cb59-129"><a href="#cb59-129" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb59-130"><a href="#cb59-130" aria-hidden="true"></a>          <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</span>
<span id="cb59-131"><a href="#cb59-131" aria-hidden="true"></a>          <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="co"># get rid of legend bg</span></span>
<span id="cb59-132"><a href="#cb59-132" aria-hidden="true"></a>          <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>))<span class="op">+</span></span>
<span id="cb59-133"><a href="#cb59-133" aria-hidden="true"></a><span class="st">          </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">4</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">500</span>)) <span class="op">+</span></span>
<span id="cb59-134"><a href="#cb59-134" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb59-135"><a href="#cb59-135" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">200</span>))<span class="op">+</span></span>
<span id="cb59-136"><a href="#cb59-136" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span></span>
<span id="cb59-137"><a href="#cb59-137" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span></span>
<span id="cb59-138"><a href="#cb59-138" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">120</span>, <span class="dt">xmax =</span> <span class="dv">200</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb59-139"><a href="#cb59-139" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">220</span>, <span class="dt">xmax =</span> <span class="dv">300</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb59-140"><a href="#cb59-140" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">350</span>, <span class="dt">xmax =</span> <span class="dv">450</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)</span>
<span id="cb59-141"><a href="#cb59-141" aria-hidden="true"></a></span>
<span id="cb59-142"><a href="#cb59-142" aria-hidden="true"></a><span class="co"># Select MO electrodes and average across electrodes</span></span>
<span id="cb59-143"><a href="#cb59-143" aria-hidden="true"></a>  grad_MO_hap =<span class="st"> </span><span class="kw">subset</span>(hap_traj, <span class="dt">select=</span><span class="kw">c</span>(ID, time, int, emotion, O1, O2, Oz))</span>
<span id="cb59-144"><a href="#cb59-144" aria-hidden="true"></a></span>
<span id="cb59-145"><a href="#cb59-145" aria-hidden="true"></a>  grad_MO_av_hap =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span>grad_MO_hap[,<span class="dv">1</span>], <span class="dt">time=</span>grad_MO_hap[,<span class="dv">2</span>], <span class="dt">int=</span>grad_MO_hap[,<span class="dv">3</span>], <span class="dt">emotion=</span>grad_MO_hap[,<span class="dv">4</span>], <span class="dt">Means=</span><span class="kw">rowMeans</span>(grad_MO_hap[,<span class="dv">5</span><span class="op">:</span><span class="dv">7</span>]))</span>
<span id="cb59-146"><a href="#cb59-146" aria-hidden="true"></a>  </span>
<span id="cb59-147"><a href="#cb59-147" aria-hidden="true"></a>  </span>
<span id="cb59-148"><a href="#cb59-148" aria-hidden="true"></a>  grad_MO_ang =<span class="st"> </span><span class="kw">subset</span>(ang_traj, <span class="dt">select=</span><span class="kw">c</span>(ID, time, int, emotion, O1, O2, Oz))</span>
<span id="cb59-149"><a href="#cb59-149" aria-hidden="true"></a></span>
<span id="cb59-150"><a href="#cb59-150" aria-hidden="true"></a>  grad_MO_av_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span>grad_MO_ang[,<span class="dv">1</span>], <span class="dt">time=</span>grad_MO_ang[,<span class="dv">2</span>], <span class="dt">int=</span>grad_MO_ang[,<span class="dv">3</span>], <span class="dt">emotion=</span>grad_MO_ang[,<span class="dv">4</span>], <span class="dt">Means=</span><span class="kw">rowMeans</span>(grad_MO_ang[,<span class="dv">5</span><span class="op">:</span><span class="dv">7</span>]))</span>
<span id="cb59-151"><a href="#cb59-151" aria-hidden="true"></a>  </span>
<span id="cb59-152"><a href="#cb59-152" aria-hidden="true"></a>  grad_MO_av_hap<span class="op">$</span>mean_emo =<span class="st"> </span>(grad_MO_av_hap<span class="op">$</span>Means<span class="op">+</span>grad_MO_av_ang<span class="op">$</span>Means)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb59-153"><a href="#cb59-153" aria-hidden="true"></a>       </span>
<span id="cb59-154"><a href="#cb59-154" aria-hidden="true"></a>         </span>
<span id="cb59-155"><a href="#cb59-155" aria-hidden="true"></a> <span class="co"># Plot data    </span></span>
<span id="cb59-156"><a href="#cb59-156" aria-hidden="true"></a>      MO =<span class="st"> </span><span class="kw">ggplot</span>(grad_MO_av_hap,<span class="kw">aes</span>(time,Means))<span class="op">+</span></span>
<span id="cb59-157"><a href="#cb59-157" aria-hidden="true"></a><span class="st">          </span><span class="kw">ggtitle</span>(<span class="st">&quot;MO&quot;</span>) <span class="op">+</span></span>
<span id="cb59-158"><a href="#cb59-158" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),</span>
<span id="cb59-159"><a href="#cb59-159" aria-hidden="true"></a>                <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">7</span>),</span>
<span id="cb59-160"><a href="#cb59-160" aria-hidden="true"></a>                <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))<span class="op">+</span></span>
<span id="cb59-161"><a href="#cb59-161" aria-hidden="true"></a><span class="st">          </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> int))<span class="op">+</span></span>
<span id="cb59-162"><a href="#cb59-162" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)))<span class="op">+</span></span>
<span id="cb59-163"><a href="#cb59-163" aria-hidden="true"></a><span class="st">          </span><span class="co">#scale_color_OkabeIto()+</span></span>
<span id="cb59-164"><a href="#cb59-164" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#cceaff&quot;</span>,<span class="st">&quot;#80ccff&quot;</span>,<span class="st">&quot;#0098ff&quot;</span>,<span class="st">&quot;#005b99&quot;</span>,<span class="st">&quot;#002e4c&quot;</span>))<span class="op">+</span></span>
<span id="cb59-165"><a href="#cb59-165" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(axis.title.x=element_blank())+      # to turn of x-axis title</span></span>
<span id="cb59-166"><a href="#cb59-166" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(axis.title.y=element_blank())+      # to turn of y-axis title</span></span>
<span id="cb59-167"><a href="#cb59-167" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(text=element_text(family=&quot;Coves&quot;, face=&quot;bold&quot;, size=18))+</span></span>
<span id="cb59-168"><a href="#cb59-168" aria-hidden="true"></a><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb59-169"><a href="#cb59-169" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">15</span>)<span class="op">+</span></span>
<span id="cb59-170"><a href="#cb59-170" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span><span class="st">&quot;right&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb59-171"><a href="#cb59-171" aria-hidden="true"></a>          <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</span>
<span id="cb59-172"><a href="#cb59-172" aria-hidden="true"></a>          <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="co"># get rid of legend bg</span></span>
<span id="cb59-173"><a href="#cb59-173" aria-hidden="true"></a>          <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>))<span class="op">+</span></span>
<span id="cb59-174"><a href="#cb59-174" aria-hidden="true"></a><span class="st">          </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">4</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">500</span>)) <span class="op">+</span></span>
<span id="cb59-175"><a href="#cb59-175" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb59-176"><a href="#cb59-176" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">200</span>))<span class="op">+</span></span>
<span id="cb59-177"><a href="#cb59-177" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span></span>
<span id="cb59-178"><a href="#cb59-178" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span></span>
<span id="cb59-179"><a href="#cb59-179" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">120</span>, <span class="dt">xmax =</span> <span class="dv">200</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb59-180"><a href="#cb59-180" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">220</span>, <span class="dt">xmax =</span> <span class="dv">300</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb59-181"><a href="#cb59-181" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">350</span>, <span class="dt">xmax =</span> <span class="dv">450</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)</span>
<span id="cb59-182"><a href="#cb59-182" aria-hidden="true"></a>      </span>
<span id="cb59-183"><a href="#cb59-183" aria-hidden="true"></a> MO     </span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/grad_plot_ERPs_happy-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true"></a>    <span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_MO_scale_happy.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)       </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true"></a>      </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true"></a>    </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true"></a><span class="co"># Combine plots</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true"></a>  erp_plots_hap =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(lOT, MO, rOT, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true"></a>  erp_plots_hap</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/grad_plot_ERPs_happy-2.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true"></a>  <span class="co"># Save without white background</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true"></a>  <span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_erp_happy.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)   </span></code></pre></div>
<p><em>Angry</em></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true"></a><span class="co"># Load data</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true"></a>  hap_twent_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_twent_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true"></a>  hap_fort_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_fort_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true"></a>  hap_sixt_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_sixt_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true"></a>  hap_eigt_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_eigt_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true"></a>  hap_oneh_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_hap_oneh_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true"></a><span class="co"># Add emotion condition</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true"></a>  hap_twent_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true"></a>  hap_fort_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true"></a>  hap_sixt_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true"></a>  hap_eigt_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true"></a>  hap_oneh_traj<span class="op">$</span>emotion =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true"></a><span class="co"># Add intensity</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true"></a>  hap_twent_traj<span class="op">$</span>int =<span class="st"> &quot;20%&quot;</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true"></a>  hap_fort_traj<span class="op">$</span>int =<span class="st"> &quot;40%&quot;</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true"></a>  hap_sixt_traj<span class="op">$</span>int =<span class="st"> &quot;60%&quot;</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true"></a>  hap_eigt_traj<span class="op">$</span>int =<span class="st"> &quot;80%&quot;</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true"></a>  hap_oneh_traj<span class="op">$</span>int =<span class="st"> &quot;100%&quot;</span></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true"></a></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true"></a><span class="co"># Combine data sets</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true"></a>  hap_traj =<span class="st"> </span><span class="kw">rbind</span>(hap_twent_traj,hap_fort_traj,hap_sixt_traj,hap_eigt_traj,hap_oneh_traj)</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true"></a></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true"></a>  hap_traj<span class="op">$</span>int =<span class="st"> </span><span class="kw">factor</span>(hap_traj<span class="op">$</span>int, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>))</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true"></a>  </span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true"></a>  </span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true"></a>  <span class="co"># Load data</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true"></a>  ang_twent_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_twent_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true"></a>  ang_fort_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_fort_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true"></a>  ang_sixt_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_sixt_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true"></a>  ang_eigt_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_eigt_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true"></a>  ang_oneh_traj =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_ang_oneh_erp_traj.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true"></a></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true"></a><span class="co"># Add emotion condition</span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true"></a>  ang_twent_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true"></a>  ang_fort_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true"></a>  ang_sixt_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb62-39"><a href="#cb62-39" aria-hidden="true"></a>  ang_eigt_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb62-40"><a href="#cb62-40" aria-hidden="true"></a>  ang_oneh_traj<span class="op">$</span>emotion =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb62-41"><a href="#cb62-41" aria-hidden="true"></a></span>
<span id="cb62-42"><a href="#cb62-42" aria-hidden="true"></a><span class="co"># Add intensity</span></span>
<span id="cb62-43"><a href="#cb62-43" aria-hidden="true"></a>  ang_twent_traj<span class="op">$</span>int =<span class="st"> &quot;20%&quot;</span></span>
<span id="cb62-44"><a href="#cb62-44" aria-hidden="true"></a>  ang_fort_traj<span class="op">$</span>int =<span class="st"> &quot;40%&quot;</span></span>
<span id="cb62-45"><a href="#cb62-45" aria-hidden="true"></a>  ang_sixt_traj<span class="op">$</span>int =<span class="st"> &quot;60%&quot;</span></span>
<span id="cb62-46"><a href="#cb62-46" aria-hidden="true"></a>  ang_eigt_traj<span class="op">$</span>int =<span class="st"> &quot;80%&quot;</span></span>
<span id="cb62-47"><a href="#cb62-47" aria-hidden="true"></a>  ang_oneh_traj<span class="op">$</span>int =<span class="st"> &quot;100%&quot;</span></span>
<span id="cb62-48"><a href="#cb62-48" aria-hidden="true"></a></span>
<span id="cb62-49"><a href="#cb62-49" aria-hidden="true"></a><span class="co"># Combine data sets</span></span>
<span id="cb62-50"><a href="#cb62-50" aria-hidden="true"></a>  ang_traj =<span class="st"> </span><span class="kw">rbind</span>(ang_twent_traj,ang_fort_traj,ang_sixt_traj,ang_eigt_traj,ang_oneh_traj)</span>
<span id="cb62-51"><a href="#cb62-51" aria-hidden="true"></a></span>
<span id="cb62-52"><a href="#cb62-52" aria-hidden="true"></a>  ang_traj<span class="op">$</span>int =<span class="st"> </span><span class="kw">factor</span>(ang_traj<span class="op">$</span>int, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>))</span>
<span id="cb62-53"><a href="#cb62-53" aria-hidden="true"></a></span>
<span id="cb62-54"><a href="#cb62-54" aria-hidden="true"></a><span class="co"># Select lOT electrodes and average across electrodes</span></span>
<span id="cb62-55"><a href="#cb62-55" aria-hidden="true"></a>  grad_lOT_hap =<span class="st"> </span><span class="kw">subset</span>(hap_traj, <span class="dt">select=</span><span class="kw">c</span>(ID, time, int, emotion, PO7, P7, PO9, PO3))</span>
<span id="cb62-56"><a href="#cb62-56" aria-hidden="true"></a></span>
<span id="cb62-57"><a href="#cb62-57" aria-hidden="true"></a>  grad_lOT_av_hap =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span>grad_lOT_hap [,<span class="dv">1</span>], <span class="dt">time=</span>grad_lOT_hap [,<span class="dv">2</span>], <span class="dt">int=</span>grad_lOT_hap [,<span class="dv">3</span>], <span class="dt">emotion=</span>grad_lOT_hap [,<span class="dv">4</span>], <span class="dt">Means=</span><span class="kw">rowMeans</span>(grad_lOT_hap [,<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb62-58"><a href="#cb62-58" aria-hidden="true"></a>  </span>
<span id="cb62-59"><a href="#cb62-59" aria-hidden="true"></a>  </span>
<span id="cb62-60"><a href="#cb62-60" aria-hidden="true"></a>  grad_lOT_ang =<span class="st"> </span><span class="kw">subset</span>(ang_traj, <span class="dt">select=</span><span class="kw">c</span>(ID, time, int, emotion, PO7, P7, PO9, PO3))</span>
<span id="cb62-61"><a href="#cb62-61" aria-hidden="true"></a></span>
<span id="cb62-62"><a href="#cb62-62" aria-hidden="true"></a>  grad_lOT_av_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span>grad_lOT_ang[,<span class="dv">1</span>], <span class="dt">time=</span>grad_lOT_ang[,<span class="dv">2</span>],</span>
<span id="cb62-63"><a href="#cb62-63" aria-hidden="true"></a>                               <span class="dt">int=</span>grad_lOT_ang[,<span class="dv">3</span>], <span class="dt">emotion=</span>grad_lOT_ang[,<span class="dv">4</span>], <span class="dt">Means=</span><span class="kw">rowMeans</span>(grad_lOT_ang[,<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb62-64"><a href="#cb62-64" aria-hidden="true"></a>  </span>
<span id="cb62-65"><a href="#cb62-65" aria-hidden="true"></a></span>
<span id="cb62-66"><a href="#cb62-66" aria-hidden="true"></a>  </span>
<span id="cb62-67"><a href="#cb62-67" aria-hidden="true"></a>  grad_lOT_av_hap<span class="op">$</span>mean_emo =<span class="st"> </span>(grad_lOT_av_hap<span class="op">$</span>Means<span class="op">+</span>grad_lOT_av_ang<span class="op">$</span>Means)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb62-68"><a href="#cb62-68" aria-hidden="true"></a></span>
<span id="cb62-69"><a href="#cb62-69" aria-hidden="true"></a></span>
<span id="cb62-70"><a href="#cb62-70" aria-hidden="true"></a><span class="co"># Plot data</span></span>
<span id="cb62-71"><a href="#cb62-71" aria-hidden="true"></a>     lOT =<span class="st"> </span><span class="kw">ggplot</span>(grad_lOT_av_ang,<span class="kw">aes</span>(time,Means))<span class="op">+</span></span>
<span id="cb62-72"><a href="#cb62-72" aria-hidden="true"></a><span class="st">          </span><span class="kw">ggtitle</span>(<span class="st">&quot;lOT&quot;</span>) <span class="op">+</span></span>
<span id="cb62-73"><a href="#cb62-73" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),</span>
<span id="cb62-74"><a href="#cb62-74" aria-hidden="true"></a>                <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">7</span>),</span>
<span id="cb62-75"><a href="#cb62-75" aria-hidden="true"></a>                <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))<span class="op">+</span></span>
<span id="cb62-76"><a href="#cb62-76" aria-hidden="true"></a><span class="st">          </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> int))<span class="op">+</span></span>
<span id="cb62-77"><a href="#cb62-77" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)))<span class="op">+</span></span>
<span id="cb62-78"><a href="#cb62-78" aria-hidden="true"></a><span class="st">          </span><span class="co">#scale_color_OkabeIto()+</span></span>
<span id="cb62-79"><a href="#cb62-79" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;gray88&quot;</span>,<span class="st">&quot;gray82&quot;</span>,<span class="st">&quot;gray60&quot;</span>,<span class="st">&quot;gray44&quot;</span>,<span class="st">&quot;gray8&quot;</span>))<span class="op">+</span></span>
<span id="cb62-80"><a href="#cb62-80" aria-hidden="true"></a><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb62-81"><a href="#cb62-81" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">15</span>)<span class="op">+</span></span>
<span id="cb62-82"><a href="#cb62-82" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb62-83"><a href="#cb62-83" aria-hidden="true"></a>          <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</span>
<span id="cb62-84"><a href="#cb62-84" aria-hidden="true"></a>          <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="co"># get rid of legend bg</span></span>
<span id="cb62-85"><a href="#cb62-85" aria-hidden="true"></a>          <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>))<span class="op">+</span></span>
<span id="cb62-86"><a href="#cb62-86" aria-hidden="true"></a><span class="st">          </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">4</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">500</span>)) <span class="op">+</span></span>
<span id="cb62-87"><a href="#cb62-87" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb62-88"><a href="#cb62-88" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">200</span>))<span class="op">+</span></span>
<span id="cb62-89"><a href="#cb62-89" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span></span>
<span id="cb62-90"><a href="#cb62-90" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span></span>
<span id="cb62-91"><a href="#cb62-91" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">120</span>, <span class="dt">xmax =</span> <span class="dv">200</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb62-92"><a href="#cb62-92" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">220</span>, <span class="dt">xmax =</span> <span class="dv">300</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb62-93"><a href="#cb62-93" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">350</span>, <span class="dt">xmax =</span> <span class="dv">450</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)</span>
<span id="cb62-94"><a href="#cb62-94" aria-hidden="true"></a></span>
<span id="cb62-95"><a href="#cb62-95" aria-hidden="true"></a>     </span>
<span id="cb62-96"><a href="#cb62-96" aria-hidden="true"></a><span class="co"># Select rOT electrodes and average across electrodes</span></span>
<span id="cb62-97"><a href="#cb62-97" aria-hidden="true"></a>  grad_rOT_hap =<span class="st"> </span><span class="kw">subset</span>(hap_traj, <span class="dt">select=</span><span class="kw">c</span>(ID, time, int, emotion, PO8, P8, PO10, PO4))</span>
<span id="cb62-98"><a href="#cb62-98" aria-hidden="true"></a></span>
<span id="cb62-99"><a href="#cb62-99" aria-hidden="true"></a>  grad_rOT_av_hap =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span>grad_rOT_hap[,<span class="dv">1</span>], <span class="dt">time=</span>grad_rOT_hap[,<span class="dv">2</span>], <span class="dt">int=</span>grad_rOT_hap[,<span class="dv">3</span>], <span class="dt">emotion=</span>grad_rOT_hap[,<span class="dv">4</span>], <span class="dt">Means=</span><span class="kw">rowMeans</span>(grad_rOT_hap[,<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb62-100"><a href="#cb62-100" aria-hidden="true"></a>  </span>
<span id="cb62-101"><a href="#cb62-101" aria-hidden="true"></a>  </span>
<span id="cb62-102"><a href="#cb62-102" aria-hidden="true"></a>  grad_rOT_ang =<span class="st"> </span><span class="kw">subset</span>(ang_traj, <span class="dt">select=</span><span class="kw">c</span>(ID, time, int, emotion, PO8, P8, PO10, PO4))</span>
<span id="cb62-103"><a href="#cb62-103" aria-hidden="true"></a></span>
<span id="cb62-104"><a href="#cb62-104" aria-hidden="true"></a>  grad_rOT_av_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span>grad_rOT_ang[,<span class="dv">1</span>], <span class="dt">time=</span>grad_rOT_ang[,<span class="dv">2</span>], <span class="dt">int=</span>grad_rOT_ang[,<span class="dv">3</span>], <span class="dt">emotion=</span>grad_rOT_ang[,<span class="dv">4</span>], <span class="dt">Means=</span><span class="kw">rowMeans</span>(grad_rOT_ang[,<span class="dv">5</span><span class="op">:</span><span class="dv">8</span>]))</span>
<span id="cb62-105"><a href="#cb62-105" aria-hidden="true"></a>  </span>
<span id="cb62-106"><a href="#cb62-106" aria-hidden="true"></a></span>
<span id="cb62-107"><a href="#cb62-107" aria-hidden="true"></a>  </span>
<span id="cb62-108"><a href="#cb62-108" aria-hidden="true"></a>  grad_rOT_av_hap<span class="op">$</span>mean_emo =<span class="st"> </span>(grad_rOT_av_hap<span class="op">$</span>Means<span class="op">+</span>grad_rOT_av_ang<span class="op">$</span>Means)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb62-109"><a href="#cb62-109" aria-hidden="true"></a>       </span>
<span id="cb62-110"><a href="#cb62-110" aria-hidden="true"></a>         </span>
<span id="cb62-111"><a href="#cb62-111" aria-hidden="true"></a> <span class="co"># Plot data    </span></span>
<span id="cb62-112"><a href="#cb62-112" aria-hidden="true"></a>      rOT =<span class="st"> </span><span class="kw">ggplot</span>(grad_rOT_av_ang,<span class="kw">aes</span>(time,Means))<span class="op">+</span></span>
<span id="cb62-113"><a href="#cb62-113" aria-hidden="true"></a><span class="st">          </span><span class="kw">ggtitle</span>(<span class="st">&quot;rOT&quot;</span>) <span class="op">+</span></span>
<span id="cb62-114"><a href="#cb62-114" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),</span>
<span id="cb62-115"><a href="#cb62-115" aria-hidden="true"></a>                <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">7</span>),</span>
<span id="cb62-116"><a href="#cb62-116" aria-hidden="true"></a>                <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))<span class="op">+</span></span>
<span id="cb62-117"><a href="#cb62-117" aria-hidden="true"></a><span class="st">          </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> int))<span class="op">+</span></span>
<span id="cb62-118"><a href="#cb62-118" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)))<span class="op">+</span></span>
<span id="cb62-119"><a href="#cb62-119" aria-hidden="true"></a><span class="st">          </span><span class="co">#scale_color_OkabeIto()+</span></span>
<span id="cb62-120"><a href="#cb62-120" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;gray88&quot;</span>,<span class="st">&quot;gray82&quot;</span>,<span class="st">&quot;gray60&quot;</span>,<span class="st">&quot;gray44&quot;</span>,<span class="st">&quot;gray8&quot;</span>))<span class="op">+</span></span>
<span id="cb62-121"><a href="#cb62-121" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(axis.title.x=element_blank())+      # to turn of x-axis title</span></span>
<span id="cb62-122"><a href="#cb62-122" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(axis.title.y=element_blank())+      # to turn of y-axis title</span></span>
<span id="cb62-123"><a href="#cb62-123" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(text=element_text(family=&quot;Coves&quot;, face=&quot;bold&quot;, size=18))+</span></span>
<span id="cb62-124"><a href="#cb62-124" aria-hidden="true"></a><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb62-125"><a href="#cb62-125" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">15</span>)<span class="op">+</span></span>
<span id="cb62-126"><a href="#cb62-126" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span><span class="st">&quot;bottom&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb62-127"><a href="#cb62-127" aria-hidden="true"></a>          <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</span>
<span id="cb62-128"><a href="#cb62-128" aria-hidden="true"></a>          <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="co"># get rid of legend bg</span></span>
<span id="cb62-129"><a href="#cb62-129" aria-hidden="true"></a>          <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>))<span class="op">+</span></span>
<span id="cb62-130"><a href="#cb62-130" aria-hidden="true"></a><span class="st">          </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">4</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">500</span>)) <span class="op">+</span></span>
<span id="cb62-131"><a href="#cb62-131" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb62-132"><a href="#cb62-132" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">200</span>))<span class="op">+</span></span>
<span id="cb62-133"><a href="#cb62-133" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span></span>
<span id="cb62-134"><a href="#cb62-134" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span></span>
<span id="cb62-135"><a href="#cb62-135" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">120</span>, <span class="dt">xmax =</span> <span class="dv">200</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb62-136"><a href="#cb62-136" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">220</span>, <span class="dt">xmax =</span> <span class="dv">300</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb62-137"><a href="#cb62-137" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">350</span>, <span class="dt">xmax =</span> <span class="dv">450</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)</span>
<span id="cb62-138"><a href="#cb62-138" aria-hidden="true"></a></span>
<span id="cb62-139"><a href="#cb62-139" aria-hidden="true"></a><span class="co"># Select MO electrodes and average across electrodes</span></span>
<span id="cb62-140"><a href="#cb62-140" aria-hidden="true"></a>  grad_MO_hap =<span class="st"> </span><span class="kw">subset</span>(hap_traj, <span class="dt">select=</span><span class="kw">c</span>(ID, time, int, emotion, O1, O2, Oz))</span>
<span id="cb62-141"><a href="#cb62-141" aria-hidden="true"></a></span>
<span id="cb62-142"><a href="#cb62-142" aria-hidden="true"></a>  grad_MO_av_hap =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span>grad_MO_hap[,<span class="dv">1</span>], <span class="dt">time=</span>grad_MO_hap[,<span class="dv">2</span>], <span class="dt">int=</span>grad_MO_hap[,<span class="dv">3</span>], <span class="dt">emotion=</span>grad_MO_hap[,<span class="dv">4</span>], <span class="dt">Means=</span><span class="kw">rowMeans</span>(grad_MO_hap[,<span class="dv">5</span><span class="op">:</span><span class="dv">7</span>]))</span>
<span id="cb62-143"><a href="#cb62-143" aria-hidden="true"></a>  </span>
<span id="cb62-144"><a href="#cb62-144" aria-hidden="true"></a>  </span>
<span id="cb62-145"><a href="#cb62-145" aria-hidden="true"></a>  grad_MO_ang =<span class="st"> </span><span class="kw">subset</span>(ang_traj, <span class="dt">select=</span><span class="kw">c</span>(ID, time, int, emotion, O1, O2, Oz))</span>
<span id="cb62-146"><a href="#cb62-146" aria-hidden="true"></a></span>
<span id="cb62-147"><a href="#cb62-147" aria-hidden="true"></a>  grad_MO_av_ang =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID=</span>grad_MO_ang[,<span class="dv">1</span>], <span class="dt">time=</span>grad_MO_ang[,<span class="dv">2</span>], <span class="dt">int=</span>grad_MO_ang[,<span class="dv">3</span>], <span class="dt">emotion=</span>grad_MO_ang[,<span class="dv">4</span>], <span class="dt">Means=</span><span class="kw">rowMeans</span>(grad_MO_ang[,<span class="dv">5</span><span class="op">:</span><span class="dv">7</span>]))</span>
<span id="cb62-148"><a href="#cb62-148" aria-hidden="true"></a>  </span>
<span id="cb62-149"><a href="#cb62-149" aria-hidden="true"></a>  grad_MO_av_hap<span class="op">$</span>mean_emo =<span class="st"> </span>(grad_MO_av_hap<span class="op">$</span>Means<span class="op">+</span>grad_MO_av_ang<span class="op">$</span>Means)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb62-150"><a href="#cb62-150" aria-hidden="true"></a>       </span>
<span id="cb62-151"><a href="#cb62-151" aria-hidden="true"></a>         </span>
<span id="cb62-152"><a href="#cb62-152" aria-hidden="true"></a> <span class="co"># Plot data    </span></span>
<span id="cb62-153"><a href="#cb62-153" aria-hidden="true"></a>      MO =<span class="st"> </span><span class="kw">ggplot</span>(grad_MO_av_ang,<span class="kw">aes</span>(time,Means))<span class="op">+</span></span>
<span id="cb62-154"><a href="#cb62-154" aria-hidden="true"></a><span class="st">          </span><span class="kw">ggtitle</span>(<span class="st">&quot;MO&quot;</span>) <span class="op">+</span></span>
<span id="cb62-155"><a href="#cb62-155" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),</span>
<span id="cb62-156"><a href="#cb62-156" aria-hidden="true"></a>                <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">7</span>),</span>
<span id="cb62-157"><a href="#cb62-157" aria-hidden="true"></a>                <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))<span class="op">+</span></span>
<span id="cb62-158"><a href="#cb62-158" aria-hidden="true"></a><span class="st">          </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> int))<span class="op">+</span></span>
<span id="cb62-159"><a href="#cb62-159" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)))<span class="op">+</span></span>
<span id="cb62-160"><a href="#cb62-160" aria-hidden="true"></a><span class="st">          </span><span class="co">#scale_color_OkabeIto()+</span></span>
<span id="cb62-161"><a href="#cb62-161" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;gray88&quot;</span>,<span class="st">&quot;gray82&quot;</span>,<span class="st">&quot;gray60&quot;</span>,<span class="st">&quot;gray44&quot;</span>,<span class="st">&quot;gray8&quot;</span>))<span class="op">+</span></span>
<span id="cb62-162"><a href="#cb62-162" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(axis.title.x=element_blank())+      # to turn of x-axis title</span></span>
<span id="cb62-163"><a href="#cb62-163" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(axis.title.y=element_blank())+      # to turn of y-axis title</span></span>
<span id="cb62-164"><a href="#cb62-164" aria-hidden="true"></a><span class="st">          </span><span class="co">#theme(text=element_text(family=&quot;Coves&quot;, face=&quot;bold&quot;, size=18))+</span></span>
<span id="cb62-165"><a href="#cb62-165" aria-hidden="true"></a><span class="st">          </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb62-166"><a href="#cb62-166" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">15</span>)<span class="op">+</span></span>
<span id="cb62-167"><a href="#cb62-167" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span><span class="st">&quot;right&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb62-168"><a href="#cb62-168" aria-hidden="true"></a>          <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</span>
<span id="cb62-169"><a href="#cb62-169" aria-hidden="true"></a>          <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="co"># get rid of legend bg</span></span>
<span id="cb62-170"><a href="#cb62-170" aria-hidden="true"></a>          <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>))<span class="op">+</span></span>
<span id="cb62-171"><a href="#cb62-171" aria-hidden="true"></a><span class="st">          </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">4</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">500</span>)) <span class="op">+</span></span>
<span id="cb62-172"><a href="#cb62-172" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb62-173"><a href="#cb62-173" aria-hidden="true"></a><span class="st">          </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">200</span>))<span class="op">+</span></span>
<span id="cb62-174"><a href="#cb62-174" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span></span>
<span id="cb62-175"><a href="#cb62-175" aria-hidden="true"></a><span class="st">          </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span></span>
<span id="cb62-176"><a href="#cb62-176" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">120</span>, <span class="dt">xmax =</span> <span class="dv">200</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb62-177"><a href="#cb62-177" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">220</span>, <span class="dt">xmax =</span> <span class="dv">300</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)<span class="op">+</span></span>
<span id="cb62-178"><a href="#cb62-178" aria-hidden="true"></a><span class="st">          </span><span class="kw">annotate</span>(<span class="st">&quot;rect&quot;</span>, <span class="dt">xmin =</span> <span class="dv">350</span>, <span class="dt">xmax =</span> <span class="dv">450</span>, <span class="dt">ymin =</span> <span class="fl">-2.5</span>, <span class="dt">ymax =</span> <span class="dv">4</span>, <span class="dt">alpha =</span> <span class="fl">.2</span>)</span>
<span id="cb62-179"><a href="#cb62-179" aria-hidden="true"></a>      </span>
<span id="cb62-180"><a href="#cb62-180" aria-hidden="true"></a>      MO</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/grad_plot_ERPs_angry-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true"></a>       <span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_MO_scale_angry.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)       </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true"></a>    </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true"></a><span class="co"># Combine plots</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true"></a>  erp_plots_hap =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(lOT, MO, rOT, <span class="dt">nrow =</span> <span class="dv">1</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true"></a>  erp_plots_hap</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/grad_plot_ERPs_angry-2.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true"></a>  <span class="co"># Save without white background</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true"></a>  <span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_erp_angry.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)   </span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true"></a><span class="co">## Average across all ROIs</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true"></a>grad_rOT_av_hap<span class="op">$</span>avROI =<span class="st"> </span>(grad_lOT_av_hap<span class="op">$</span>mean_emo <span class="op">+</span><span class="st"> </span>grad_rOT_av_hap<span class="op">$</span>mean_emo <span class="op">+</span><span class="st"> </span>grad_MO_av_hap<span class="op">$</span>mean_emo)<span class="op">/</span><span class="dv">3</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true"></a><span class="co">## Average across intensities</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true"></a>grad_grand =<span class="st"> </span><span class="kw">aggregate</span>(avROI <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>ID, grad_rOT_av_hap, mean)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true"></a></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true"></a><span class="co">## Average across IDs</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true"></a>grad_grand_av =<span class="st"> </span><span class="kw">aggregate</span>(avROI <span class="op">~</span><span class="st"> </span>time, grad_grand, mean)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true"></a><span class="co">## Draw grand average across ROI, emotion, intensity and IDs</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true"></a></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true"></a><span class="kw">ggplot</span>(grad_grand_av, <span class="kw">aes</span>(time, avROI)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Grand average&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true"></a>        <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time (ms)&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>, mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">160</span>, </span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true"></a>    <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">150</span>, </span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true"></a>    <span class="dv">600</span>, <span class="dv">50</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/grad_plot_grand_av-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true"></a><span class="co">#### Get grand-averaged P1/N170 peaks</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true"></a><span class="co">## P1</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true"></a><span class="co"># Get values between 80-120 ms</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true"></a>grad_av_P1 =<span class="st"> </span><span class="kw">subset</span>(grad_grand_av, time <span class="op">&gt;</span><span class="st"> </span><span class="dv">80</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span><span class="dv">120</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true"></a><span class="co"># Get local gradimum in this time range</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true"></a>loc_max =<span class="st"> </span><span class="kw">which</span>(grad_av_P1 <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(grad_av_P1<span class="op">$</span>avROI), <span class="dt">arr.ind =</span> T)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true"></a><span class="co"># Locate time for peak</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true"></a>peak_P1 =<span class="st"> </span>grad_av_P1<span class="op">$</span>time[loc_max[<span class="dv">1</span>]]</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true"></a></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true"></a></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true"></a><span class="co">## N170</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true"></a><span class="co"># Get values between 80-120 ms</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true"></a>grad_av_N170 =<span class="st"> </span><span class="kw">subset</span>(grad_grand_av, time <span class="op">&gt;</span><span class="st"> </span><span class="dv">150</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span><span class="dv">190</span>)</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true"></a></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true"></a><span class="co"># Get local minimum in this time range</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true"></a>loc_min =<span class="st"> </span><span class="kw">which</span>(grad_av_N170 <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(grad_av_N170<span class="op">$</span>avROI), <span class="dt">arr.ind =</span> T)</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true"></a></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true"></a><span class="co"># Locate time for peak</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true"></a>peak_N170 =<span class="st"> </span>grad_av_N170<span class="op">$</span>time[loc_min[<span class="dv">1</span>]]</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true"></a></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true"></a></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true"></a><span class="co">## P3</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true"></a></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true"></a><span class="co"># Get values between 300-400 ms</span></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true"></a>grad_grandav_P3 =<span class="st"> </span><span class="kw">subset</span>(grad_grand_av, time <span class="op">&gt;</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span><span class="dv">400</span>)</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true"></a></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true"></a><span class="co"># Get local maximum in this time range</span></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true"></a>loc_max =<span class="st"> </span><span class="kw">which</span>(grad_grandav_P3 <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(grad_grandav_P3<span class="op">$</span>avROI), <span class="dt">arr.ind =</span> T)</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true"></a></span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true"></a><span class="co"># Locate time for peak</span></span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true"></a>peak_P3 =<span class="st"> </span>grad_grandav_P3<span class="op">$</span>time[loc_max[<span class="dv">1</span>]]</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true"></a></span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true"></a></span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true"></a><span class="co">#### Get averaged amplitudes across emotion / electrodes of ROI for each participant</span></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true"></a><span class="co">#### (to select individual peak around grand-averaged peak)</span></span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true"></a></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true"></a><span class="co">## Averaged across ROI/intensity/emotion but not ID</span></span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true"></a>grad_grand =<span class="st"> </span><span class="kw">aggregate</span>(avROI <span class="op">~</span><span class="st"> </span>time <span class="op">+</span><span class="st"> </span>ID, grad_rOT_av_hap, mean)</span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true"></a></span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true"></a></span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true"></a><span class="co">## Averaged across emotion, but not ID or ROI</span></span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true"></a>grad_whole_indiv_time_hap =<span class="st"> </span><span class="kw">subset</span>(hap_traj, <span class="dt">select =</span> <span class="kw">c</span>(ID, time, int, emotion, O1, </span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true"></a>    PO7, P7, P9, O2, PO8, P8, P10))</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true"></a></span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true"></a>grad_whole_indiv_time_ang =<span class="st"> </span><span class="kw">subset</span>(ang_traj, <span class="dt">select =</span> <span class="kw">c</span>(ID, time, int, emotion, O1, </span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true"></a>    PO7, P7, P9, O2, PO8, P8, P10))</span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true"></a></span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true"></a></span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true"></a>grad_whole_indiv_time =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> grad_whole_indiv_time_hap[, <span class="dv">1</span>], <span class="dt">time =</span> grad_whole_indiv_time_hap[, </span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true"></a>    <span class="dv">2</span>], <span class="dt">int =</span> grad_whole_indiv_time_hap[, <span class="dv">3</span>])</span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true"></a></span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true"></a>grad_whole_indiv_time<span class="op">$</span>O1 =<span class="st"> </span>(grad_whole_indiv_time_hap<span class="op">$</span>O1 <span class="op">+</span><span class="st"> </span>grad_whole_indiv_time_ang<span class="op">$</span>O1)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true"></a>grad_whole_indiv_time<span class="op">$</span>PO7 =<span class="st"> </span>(grad_whole_indiv_time_hap<span class="op">$</span>PO7 <span class="op">+</span><span class="st"> </span>grad_whole_indiv_time_ang<span class="op">$</span>PO7)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true"></a>grad_whole_indiv_time<span class="op">$</span>P7 =<span class="st"> </span>(grad_whole_indiv_time_hap<span class="op">$</span>P7 <span class="op">+</span><span class="st"> </span>grad_whole_indiv_time_ang<span class="op">$</span>P7)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true"></a>grad_whole_indiv_time<span class="op">$</span>P9 =<span class="st"> </span>(grad_whole_indiv_time_hap<span class="op">$</span>P9 <span class="op">+</span><span class="st"> </span>grad_whole_indiv_time_ang<span class="op">$</span>P9)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true"></a>grad_whole_indiv_time<span class="op">$</span>O2 =<span class="st"> </span>(grad_whole_indiv_time_hap<span class="op">$</span>O2 <span class="op">+</span><span class="st"> </span>grad_whole_indiv_time_ang<span class="op">$</span>O2)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true"></a>grad_whole_indiv_time<span class="op">$</span>PO8 =<span class="st"> </span>(grad_whole_indiv_time_hap<span class="op">$</span>PO8 <span class="op">+</span><span class="st"> </span>grad_whole_indiv_time_ang<span class="op">$</span>PO8)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true"></a>grad_whole_indiv_time<span class="op">$</span>P8 =<span class="st"> </span>(grad_whole_indiv_time_hap<span class="op">$</span>P8 <span class="op">+</span><span class="st"> </span>grad_whole_indiv_time_ang<span class="op">$</span>P8)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true"></a>grad_whole_indiv_time<span class="op">$</span>P10 =<span class="st"> </span>(grad_whole_indiv_time_hap<span class="op">$</span>P10 <span class="op">+</span><span class="st"> </span>grad_whole_indiv_time_ang<span class="op">$</span>P10)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb66-65"><a href="#cb66-65" aria-hidden="true"></a></span>
<span id="cb66-66"><a href="#cb66-66" aria-hidden="true"></a></span>
<span id="cb66-67"><a href="#cb66-67" aria-hidden="true"></a><span class="co">### Start loop to get mean amplitude for lOT and rOT around individual peak</span></span>
<span id="cb66-68"><a href="#cb66-68" aria-hidden="true"></a><span class="co">### amplitude for each participant and emotion</span></span>
<span id="cb66-69"><a href="#cb66-69" aria-hidden="true"></a></span>
<span id="cb66-70"><a href="#cb66-70" aria-hidden="true"></a><span class="co">## P1</span></span>
<span id="cb66-71"><a href="#cb66-71" aria-hidden="true"></a></span>
<span id="cb66-72"><a href="#cb66-72" aria-hidden="true"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">47</span>) {</span>
<span id="cb66-73"><a href="#cb66-73" aria-hidden="true"></a></span>
<span id="cb66-74"><a href="#cb66-74" aria-hidden="true"></a>    <span class="co"># Get individual time series and values between +/- 10ms of P1 peak</span></span>
<span id="cb66-75"><a href="#cb66-75" aria-hidden="true"></a>    grad_indiv_time_ser_P1 =<span class="st"> </span><span class="kw">subset</span>(grad_grand, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_P1 <span class="op">-</span><span class="st"> </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span></span>
<span id="cb66-76"><a href="#cb66-76" aria-hidden="true"></a><span class="st">        </span>peak_P1 <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-77"><a href="#cb66-77" aria-hidden="true"></a>    grad_indiv_time_ser_N170 =<span class="st"> </span><span class="kw">subset</span>(grad_grand, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_N170 <span class="op">-</span><span class="st"> </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb66-78"><a href="#cb66-78" aria-hidden="true"></a><span class="st">        </span>time <span class="op">&lt;</span><span class="st"> </span>peak_N170 <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-79"><a href="#cb66-79" aria-hidden="true"></a>    grad_indiv_time_ser_P3 =<span class="st"> </span><span class="kw">subset</span>(grad_grand, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_P3 <span class="op">-</span><span class="st"> </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span></span>
<span id="cb66-80"><a href="#cb66-80" aria-hidden="true"></a><span class="st">        </span>peak_P3 <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-81"><a href="#cb66-81" aria-hidden="true"></a></span>
<span id="cb66-82"><a href="#cb66-82" aria-hidden="true"></a>    <span class="co"># Get time point for local maxima</span></span>
<span id="cb66-83"><a href="#cb66-83" aria-hidden="true"></a>    loc_max_P1 =<span class="st"> </span><span class="kw">which</span>(grad_indiv_time_ser_P1 <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(grad_indiv_time_ser_P1<span class="op">$</span>avROI), </span>
<span id="cb66-84"><a href="#cb66-84" aria-hidden="true"></a>        <span class="dt">arr.ind =</span> T)</span>
<span id="cb66-85"><a href="#cb66-85" aria-hidden="true"></a>    loc_max_N170 =<span class="st"> </span><span class="kw">which</span>(grad_indiv_time_ser_N170 <span class="op">==</span><span class="st"> </span><span class="kw">min</span>(grad_indiv_time_ser_N170<span class="op">$</span>avROI), </span>
<span id="cb66-86"><a href="#cb66-86" aria-hidden="true"></a>        <span class="dt">arr.ind =</span> T)</span>
<span id="cb66-87"><a href="#cb66-87" aria-hidden="true"></a>    loc_max_P3 =<span class="st"> </span><span class="kw">which</span>(grad_indiv_time_ser_P3 <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(grad_indiv_time_ser_P3<span class="op">$</span>avROI), </span>
<span id="cb66-88"><a href="#cb66-88" aria-hidden="true"></a>        <span class="dt">arr.ind =</span> T)</span>
<span id="cb66-89"><a href="#cb66-89" aria-hidden="true"></a></span>
<span id="cb66-90"><a href="#cb66-90" aria-hidden="true"></a>    <span class="co"># Locate individual time point for peak ERP value</span></span>
<span id="cb66-91"><a href="#cb66-91" aria-hidden="true"></a>    peak_P1_indiv =<span class="st"> </span>grad_indiv_time_ser_P1<span class="op">$</span>time[loc_max_P1[<span class="dv">1</span>]]</span>
<span id="cb66-92"><a href="#cb66-92" aria-hidden="true"></a>    peak_N170_indiv =<span class="st"> </span>grad_indiv_time_ser_N170<span class="op">$</span>time[loc_max_N170[<span class="dv">1</span>]]</span>
<span id="cb66-93"><a href="#cb66-93" aria-hidden="true"></a>    peak_P3_indiv =<span class="st"> </span>grad_indiv_time_ser_P3<span class="op">$</span>time[loc_max_P3[<span class="dv">1</span>]]</span>
<span id="cb66-94"><a href="#cb66-94" aria-hidden="true"></a></span>
<span id="cb66-95"><a href="#cb66-95" aria-hidden="true"></a>    <span class="co"># Separate for intensities</span></span>
<span id="cb66-96"><a href="#cb66-96" aria-hidden="true"></a>    grad_time_P1_twent =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb66-97"><a href="#cb66-97" aria-hidden="true"></a>    grad_time_P1_fort =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb66-98"><a href="#cb66-98" aria-hidden="true"></a>    grad_time_P1_sixt =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb66-99"><a href="#cb66-99" aria-hidden="true"></a>    grad_time_P1_eigt =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb66-100"><a href="#cb66-100" aria-hidden="true"></a>    grad_time_P1_oneh =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb66-101"><a href="#cb66-101" aria-hidden="true"></a></span>
<span id="cb66-102"><a href="#cb66-102" aria-hidden="true"></a>    grad_time_N170_twent =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb66-103"><a href="#cb66-103" aria-hidden="true"></a>    grad_time_N170_fort =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb66-104"><a href="#cb66-104" aria-hidden="true"></a>    grad_time_N170_sixt =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb66-105"><a href="#cb66-105" aria-hidden="true"></a>    grad_time_N170_eigt =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb66-106"><a href="#cb66-106" aria-hidden="true"></a>    grad_time_N170_oneh =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb66-107"><a href="#cb66-107" aria-hidden="true"></a></span>
<span id="cb66-108"><a href="#cb66-108" aria-hidden="true"></a>    grad_time_P3_twent =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb66-109"><a href="#cb66-109" aria-hidden="true"></a>    grad_time_P3_fort =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb66-110"><a href="#cb66-110" aria-hidden="true"></a>    grad_time_P3_sixt =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb66-111"><a href="#cb66-111" aria-hidden="true"></a>    grad_time_P3_eigt =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb66-112"><a href="#cb66-112" aria-hidden="true"></a>    grad_time_P3_oneh =<span class="st"> </span><span class="kw">subset</span>(grad_whole_indiv_time, int <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb66-113"><a href="#cb66-113" aria-hidden="true"></a></span>
<span id="cb66-114"><a href="#cb66-114" aria-hidden="true"></a>    <span class="co"># Get whole data set</span></span>
<span id="cb66-115"><a href="#cb66-115" aria-hidden="true"></a>    grad_time_P1_twent_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_P1_twent, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_P1_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-116"><a href="#cb66-116" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_P1_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-117"><a href="#cb66-117" aria-hidden="true"></a>    grad_time_P1_fort_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_P1_fort, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_P1_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-118"><a href="#cb66-118" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_P1_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-119"><a href="#cb66-119" aria-hidden="true"></a>    grad_time_P1_sixt_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_P1_sixt, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_P1_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-120"><a href="#cb66-120" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_P1_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-121"><a href="#cb66-121" aria-hidden="true"></a>    grad_time_P1_eigt_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_P1_eigt, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_P1_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-122"><a href="#cb66-122" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_P1_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-123"><a href="#cb66-123" aria-hidden="true"></a>    grad_time_P1_oneh_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_P1_oneh, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_P1_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-124"><a href="#cb66-124" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_P1_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-125"><a href="#cb66-125" aria-hidden="true"></a></span>
<span id="cb66-126"><a href="#cb66-126" aria-hidden="true"></a>    grad_time_N170_twent_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_N170_twent, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_N170_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-127"><a href="#cb66-127" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_N170_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-128"><a href="#cb66-128" aria-hidden="true"></a>    grad_time_N170_fort_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_N170_fort, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_N170_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-129"><a href="#cb66-129" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_N170_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-130"><a href="#cb66-130" aria-hidden="true"></a>    grad_time_N170_sixt_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_N170_sixt, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_N170_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-131"><a href="#cb66-131" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_N170_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-132"><a href="#cb66-132" aria-hidden="true"></a>    grad_time_N170_eigt_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_N170_eigt, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_N170_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-133"><a href="#cb66-133" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_N170_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-134"><a href="#cb66-134" aria-hidden="true"></a>    grad_time_N170_oneh_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_N170_oneh, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_N170_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-135"><a href="#cb66-135" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_N170_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-136"><a href="#cb66-136" aria-hidden="true"></a></span>
<span id="cb66-137"><a href="#cb66-137" aria-hidden="true"></a>    grad_time_P3_twent_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_P3_twent, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_P3_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-138"><a href="#cb66-138" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_P3_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-139"><a href="#cb66-139" aria-hidden="true"></a>    grad_time_P3_fort_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_P3_fort, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_P3_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-140"><a href="#cb66-140" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_P3_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-141"><a href="#cb66-141" aria-hidden="true"></a>    grad_time_P3_sixt_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_P3_sixt, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_P3_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-142"><a href="#cb66-142" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_P3_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-143"><a href="#cb66-143" aria-hidden="true"></a>    grad_time_P3_eigt_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_P3_eigt, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_P3_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-144"><a href="#cb66-144" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_P3_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-145"><a href="#cb66-145" aria-hidden="true"></a>    grad_time_P3_oneh_sel =<span class="st"> </span><span class="kw">subset</span>(grad_time_P3_oneh, ID <span class="op">==</span><span class="st"> </span>i <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&gt;</span><span class="st"> </span>peak_P3_indiv <span class="op">-</span><span class="st"> </span></span>
<span id="cb66-146"><a href="#cb66-146" aria-hidden="true"></a><span class="st">        </span><span class="dv">10</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;</span><span class="st"> </span>peak_P3_indiv <span class="op">+</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb66-147"><a href="#cb66-147" aria-hidden="true"></a></span>
<span id="cb66-148"><a href="#cb66-148" aria-hidden="true"></a>    <span class="co"># Get mean per electrode</span></span>
<span id="cb66-149"><a href="#cb66-149" aria-hidden="true"></a>    grad_indiv_elec_P1_twent =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_P1_twent_sel[<span class="kw">sapply</span>(grad_time_P1_twent_sel, </span>
<span id="cb66-150"><a href="#cb66-150" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-151"><a href="#cb66-151" aria-hidden="true"></a>    grad_indiv_elec_P1_fort =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_P1_fort_sel[<span class="kw">sapply</span>(grad_time_P1_fort_sel, </span>
<span id="cb66-152"><a href="#cb66-152" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-153"><a href="#cb66-153" aria-hidden="true"></a>    grad_indiv_elec_P1_sixt =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_P1_sixt_sel[<span class="kw">sapply</span>(grad_time_P1_sixt_sel, </span>
<span id="cb66-154"><a href="#cb66-154" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-155"><a href="#cb66-155" aria-hidden="true"></a>    grad_indiv_elec_P1_eigt =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_P1_eigt_sel[<span class="kw">sapply</span>(grad_time_P1_eigt_sel, </span>
<span id="cb66-156"><a href="#cb66-156" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-157"><a href="#cb66-157" aria-hidden="true"></a>    grad_indiv_elec_P1_oneh =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_P1_oneh_sel[<span class="kw">sapply</span>(grad_time_P1_oneh_sel, </span>
<span id="cb66-158"><a href="#cb66-158" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-159"><a href="#cb66-159" aria-hidden="true"></a></span>
<span id="cb66-160"><a href="#cb66-160" aria-hidden="true"></a>    grad_indiv_elec_N170_twent =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_N170_twent_sel[<span class="kw">sapply</span>(grad_time_N170_twent_sel, </span>
<span id="cb66-161"><a href="#cb66-161" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-162"><a href="#cb66-162" aria-hidden="true"></a>    grad_indiv_elec_N170_fort =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_N170_fort_sel[<span class="kw">sapply</span>(grad_time_N170_fort_sel, </span>
<span id="cb66-163"><a href="#cb66-163" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-164"><a href="#cb66-164" aria-hidden="true"></a>    grad_indiv_elec_N170_sixt =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_N170_sixt_sel[<span class="kw">sapply</span>(grad_time_N170_sixt_sel, </span>
<span id="cb66-165"><a href="#cb66-165" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-166"><a href="#cb66-166" aria-hidden="true"></a>    grad_indiv_elec_N170_eigt =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_N170_eigt_sel[<span class="kw">sapply</span>(grad_time_N170_eigt_sel, </span>
<span id="cb66-167"><a href="#cb66-167" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-168"><a href="#cb66-168" aria-hidden="true"></a>    grad_indiv_elec_N170_oneh =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_N170_oneh_sel[<span class="kw">sapply</span>(grad_time_N170_oneh_sel, </span>
<span id="cb66-169"><a href="#cb66-169" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-170"><a href="#cb66-170" aria-hidden="true"></a></span>
<span id="cb66-171"><a href="#cb66-171" aria-hidden="true"></a>    grad_indiv_elec_P3_twent =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_P3_twent_sel[<span class="kw">sapply</span>(grad_time_P3_twent_sel, </span>
<span id="cb66-172"><a href="#cb66-172" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-173"><a href="#cb66-173" aria-hidden="true"></a>    grad_indiv_elec_P3_fort =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_P3_fort_sel[<span class="kw">sapply</span>(grad_time_P3_fort_sel, </span>
<span id="cb66-174"><a href="#cb66-174" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-175"><a href="#cb66-175" aria-hidden="true"></a>    grad_indiv_elec_P3_sixt =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_P3_sixt_sel[<span class="kw">sapply</span>(grad_time_P3_sixt_sel, </span>
<span id="cb66-176"><a href="#cb66-176" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-177"><a href="#cb66-177" aria-hidden="true"></a>    grad_indiv_elec_P3_eigt =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_P3_eigt_sel[<span class="kw">sapply</span>(grad_time_P3_eigt_sel, </span>
<span id="cb66-178"><a href="#cb66-178" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-179"><a href="#cb66-179" aria-hidden="true"></a>    grad_indiv_elec_P3_oneh =<span class="st"> </span><span class="kw">colMeans</span>(grad_time_P3_oneh_sel[<span class="kw">sapply</span>(grad_time_P3_oneh_sel, </span>
<span id="cb66-180"><a href="#cb66-180" aria-hidden="true"></a>        is.numeric)])</span>
<span id="cb66-181"><a href="#cb66-181" aria-hidden="true"></a></span>
<span id="cb66-182"><a href="#cb66-182" aria-hidden="true"></a>    <span class="co"># Get mean for each ROI</span></span>
<span id="cb66-183"><a href="#cb66-183" aria-hidden="true"></a></span>
<span id="cb66-184"><a href="#cb66-184" aria-hidden="true"></a>    grad_ROI_P1_twent =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P1_twent[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-185"><a href="#cb66-185" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P1_twent[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-186"><a href="#cb66-186" aria-hidden="true"></a></span>
<span id="cb66-187"><a href="#cb66-187" aria-hidden="true"></a>    grad_ROI_P1_fort =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P1_fort[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-188"><a href="#cb66-188" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P1_fort[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-189"><a href="#cb66-189" aria-hidden="true"></a></span>
<span id="cb66-190"><a href="#cb66-190" aria-hidden="true"></a>    grad_ROI_P1_sixt =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P1_sixt[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-191"><a href="#cb66-191" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P1_sixt[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-192"><a href="#cb66-192" aria-hidden="true"></a></span>
<span id="cb66-193"><a href="#cb66-193" aria-hidden="true"></a>    grad_ROI_P1_eigt =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P1_eigt[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-194"><a href="#cb66-194" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P1_eigt[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-195"><a href="#cb66-195" aria-hidden="true"></a></span>
<span id="cb66-196"><a href="#cb66-196" aria-hidden="true"></a>    grad_ROI_P1_oneh =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P1_oneh[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-197"><a href="#cb66-197" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P1_oneh[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-198"><a href="#cb66-198" aria-hidden="true"></a></span>
<span id="cb66-199"><a href="#cb66-199" aria-hidden="true"></a>    grad_ROI_N170_twent =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_N170_twent[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-200"><a href="#cb66-200" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_N170_twent[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-201"><a href="#cb66-201" aria-hidden="true"></a></span>
<span id="cb66-202"><a href="#cb66-202" aria-hidden="true"></a>    grad_ROI_N170_fort =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_N170_fort[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-203"><a href="#cb66-203" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_N170_fort[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-204"><a href="#cb66-204" aria-hidden="true"></a></span>
<span id="cb66-205"><a href="#cb66-205" aria-hidden="true"></a>    grad_ROI_N170_sixt =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_N170_sixt[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-206"><a href="#cb66-206" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_N170_sixt[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-207"><a href="#cb66-207" aria-hidden="true"></a></span>
<span id="cb66-208"><a href="#cb66-208" aria-hidden="true"></a>    grad_ROI_N170_eigt =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_N170_eigt[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-209"><a href="#cb66-209" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_N170_eigt[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-210"><a href="#cb66-210" aria-hidden="true"></a></span>
<span id="cb66-211"><a href="#cb66-211" aria-hidden="true"></a>    grad_ROI_N170_oneh =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_N170_oneh[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-212"><a href="#cb66-212" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_N170_oneh[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-213"><a href="#cb66-213" aria-hidden="true"></a></span>
<span id="cb66-214"><a href="#cb66-214" aria-hidden="true"></a>    grad_ROI_P3_twent =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P3_twent[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-215"><a href="#cb66-215" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P3_twent[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-216"><a href="#cb66-216" aria-hidden="true"></a></span>
<span id="cb66-217"><a href="#cb66-217" aria-hidden="true"></a>    grad_ROI_P3_fort =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P3_fort[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-218"><a href="#cb66-218" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P3_fort[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-219"><a href="#cb66-219" aria-hidden="true"></a></span>
<span id="cb66-220"><a href="#cb66-220" aria-hidden="true"></a>    grad_ROI_P3_sixt =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P3_sixt[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-221"><a href="#cb66-221" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P3_sixt[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-222"><a href="#cb66-222" aria-hidden="true"></a></span>
<span id="cb66-223"><a href="#cb66-223" aria-hidden="true"></a>    grad_ROI_P3_eigt =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P3_eigt[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-224"><a href="#cb66-224" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P3_eigt[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-225"><a href="#cb66-225" aria-hidden="true"></a></span>
<span id="cb66-226"><a href="#cb66-226" aria-hidden="true"></a>    grad_ROI_P3_oneh =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> i, <span class="dt">lOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P3_oneh[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]), </span>
<span id="cb66-227"><a href="#cb66-227" aria-hidden="true"></a>        <span class="dt">rOT =</span> <span class="kw">mean</span>(grad_indiv_elec_P3_oneh[<span class="dv">7</span><span class="op">:</span><span class="dv">10</span>]))</span>
<span id="cb66-228"><a href="#cb66-228" aria-hidden="true"></a></span>
<span id="cb66-229"><a href="#cb66-229" aria-hidden="true"></a>    <span class="co"># Combine data</span></span>
<span id="cb66-230"><a href="#cb66-230" aria-hidden="true"></a></span>
<span id="cb66-231"><a href="#cb66-231" aria-hidden="true"></a>    <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb66-232"><a href="#cb66-232" aria-hidden="true"></a></span>
<span id="cb66-233"><a href="#cb66-233" aria-hidden="true"></a>        grad_mean_amp_P1_twent =<span class="st"> </span>grad_ROI_P1_twent</span>
<span id="cb66-234"><a href="#cb66-234" aria-hidden="true"></a>        grad_mean_amp_P1_fort =<span class="st"> </span>grad_ROI_P1_fort</span>
<span id="cb66-235"><a href="#cb66-235" aria-hidden="true"></a>        grad_mean_amp_P1_sixt =<span class="st"> </span>grad_ROI_P1_sixt</span>
<span id="cb66-236"><a href="#cb66-236" aria-hidden="true"></a>        grad_mean_amp_P1_eigt =<span class="st"> </span>grad_ROI_P1_eigt</span>
<span id="cb66-237"><a href="#cb66-237" aria-hidden="true"></a>        grad_mean_amp_P1_oneh =<span class="st"> </span>grad_ROI_P1_oneh</span>
<span id="cb66-238"><a href="#cb66-238" aria-hidden="true"></a></span>
<span id="cb66-239"><a href="#cb66-239" aria-hidden="true"></a>        grad_mean_amp_N170_twent =<span class="st"> </span>grad_ROI_N170_twent</span>
<span id="cb66-240"><a href="#cb66-240" aria-hidden="true"></a>        grad_mean_amp_N170_fort =<span class="st"> </span>grad_ROI_N170_fort</span>
<span id="cb66-241"><a href="#cb66-241" aria-hidden="true"></a>        grad_mean_amp_N170_sixt =<span class="st"> </span>grad_ROI_N170_sixt</span>
<span id="cb66-242"><a href="#cb66-242" aria-hidden="true"></a>        grad_mean_amp_N170_eigt =<span class="st"> </span>grad_ROI_N170_eigt</span>
<span id="cb66-243"><a href="#cb66-243" aria-hidden="true"></a>        grad_mean_amp_N170_oneh =<span class="st"> </span>grad_ROI_N170_oneh</span>
<span id="cb66-244"><a href="#cb66-244" aria-hidden="true"></a></span>
<span id="cb66-245"><a href="#cb66-245" aria-hidden="true"></a>        grad_mean_amp_P3_twent =<span class="st"> </span>grad_ROI_P3_twent</span>
<span id="cb66-246"><a href="#cb66-246" aria-hidden="true"></a>        grad_mean_amp_P3_fort =<span class="st"> </span>grad_ROI_P3_fort</span>
<span id="cb66-247"><a href="#cb66-247" aria-hidden="true"></a>        grad_mean_amp_P3_sixt =<span class="st"> </span>grad_ROI_P3_sixt</span>
<span id="cb66-248"><a href="#cb66-248" aria-hidden="true"></a>        grad_mean_amp_P3_eigt =<span class="st"> </span>grad_ROI_P3_eigt</span>
<span id="cb66-249"><a href="#cb66-249" aria-hidden="true"></a>        grad_mean_amp_P3_oneh =<span class="st"> </span>grad_ROI_P3_oneh</span>
<span id="cb66-250"><a href="#cb66-250" aria-hidden="true"></a></span>
<span id="cb66-251"><a href="#cb66-251" aria-hidden="true"></a>    } <span class="cf">else</span> {</span>
<span id="cb66-252"><a href="#cb66-252" aria-hidden="true"></a></span>
<span id="cb66-253"><a href="#cb66-253" aria-hidden="true"></a>        grad_mean_amp_P1_twent =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_P1_twent, grad_ROI_P1_twent)</span>
<span id="cb66-254"><a href="#cb66-254" aria-hidden="true"></a>        grad_mean_amp_P1_fort =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_P1_fort, grad_ROI_P1_fort)</span>
<span id="cb66-255"><a href="#cb66-255" aria-hidden="true"></a>        grad_mean_amp_P1_sixt =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_P1_sixt, grad_ROI_P1_sixt)</span>
<span id="cb66-256"><a href="#cb66-256" aria-hidden="true"></a>        grad_mean_amp_P1_eigt =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_P1_eigt, grad_ROI_P1_eigt)</span>
<span id="cb66-257"><a href="#cb66-257" aria-hidden="true"></a>        grad_mean_amp_P1_oneh =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_P1_oneh, grad_ROI_P1_oneh)</span>
<span id="cb66-258"><a href="#cb66-258" aria-hidden="true"></a></span>
<span id="cb66-259"><a href="#cb66-259" aria-hidden="true"></a>        grad_mean_amp_N170_twent =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_N170_twent, grad_ROI_N170_twent)</span>
<span id="cb66-260"><a href="#cb66-260" aria-hidden="true"></a>        grad_mean_amp_N170_fort =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_N170_fort, grad_ROI_N170_fort)</span>
<span id="cb66-261"><a href="#cb66-261" aria-hidden="true"></a>        grad_mean_amp_N170_sixt =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_N170_sixt, grad_ROI_N170_sixt)</span>
<span id="cb66-262"><a href="#cb66-262" aria-hidden="true"></a>        grad_mean_amp_N170_eigt =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_N170_eigt, grad_ROI_N170_eigt)</span>
<span id="cb66-263"><a href="#cb66-263" aria-hidden="true"></a>        grad_mean_amp_N170_oneh =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_N170_oneh, grad_ROI_N170_oneh)</span>
<span id="cb66-264"><a href="#cb66-264" aria-hidden="true"></a></span>
<span id="cb66-265"><a href="#cb66-265" aria-hidden="true"></a>        grad_mean_amp_P3_twent =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_P3_twent, grad_ROI_P3_twent)</span>
<span id="cb66-266"><a href="#cb66-266" aria-hidden="true"></a>        grad_mean_amp_P3_fort =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_P3_fort, grad_ROI_P3_fort)</span>
<span id="cb66-267"><a href="#cb66-267" aria-hidden="true"></a>        grad_mean_amp_P3_sixt =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_P3_sixt, grad_ROI_P3_sixt)</span>
<span id="cb66-268"><a href="#cb66-268" aria-hidden="true"></a>        grad_mean_amp_P3_eigt =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_P3_eigt, grad_ROI_P3_eigt)</span>
<span id="cb66-269"><a href="#cb66-269" aria-hidden="true"></a>        grad_mean_amp_P3_oneh =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_P3_oneh, grad_ROI_P3_oneh)</span>
<span id="cb66-270"><a href="#cb66-270" aria-hidden="true"></a></span>
<span id="cb66-271"><a href="#cb66-271" aria-hidden="true"></a>    }</span>
<span id="cb66-272"><a href="#cb66-272" aria-hidden="true"></a></span>
<span id="cb66-273"><a href="#cb66-273" aria-hidden="true"></a>}</span>
<span id="cb66-274"><a href="#cb66-274" aria-hidden="true"></a></span>
<span id="cb66-275"><a href="#cb66-275" aria-hidden="true"></a></span>
<span id="cb66-276"><a href="#cb66-276" aria-hidden="true"></a><span class="co"># Add intensity info</span></span>
<span id="cb66-277"><a href="#cb66-277" aria-hidden="true"></a>grad_mean_amp_P1_twent<span class="op">$</span>int =<span class="st"> &quot;20%&quot;</span></span>
<span id="cb66-278"><a href="#cb66-278" aria-hidden="true"></a>grad_mean_amp_P1_fort<span class="op">$</span>int =<span class="st"> &quot;40%&quot;</span></span>
<span id="cb66-279"><a href="#cb66-279" aria-hidden="true"></a>grad_mean_amp_P1_sixt<span class="op">$</span>int =<span class="st"> &quot;60%&quot;</span></span>
<span id="cb66-280"><a href="#cb66-280" aria-hidden="true"></a>grad_mean_amp_P1_eigt<span class="op">$</span>int =<span class="st"> &quot;80%&quot;</span></span>
<span id="cb66-281"><a href="#cb66-281" aria-hidden="true"></a>grad_mean_amp_P1_oneh<span class="op">$</span>int =<span class="st"> &quot;100%&quot;</span></span>
<span id="cb66-282"><a href="#cb66-282" aria-hidden="true"></a></span>
<span id="cb66-283"><a href="#cb66-283" aria-hidden="true"></a>grad_mean_amp_N170_twent<span class="op">$</span>int =<span class="st"> &quot;20%&quot;</span></span>
<span id="cb66-284"><a href="#cb66-284" aria-hidden="true"></a>grad_mean_amp_N170_fort<span class="op">$</span>int =<span class="st"> &quot;40%&quot;</span></span>
<span id="cb66-285"><a href="#cb66-285" aria-hidden="true"></a>grad_mean_amp_N170_sixt<span class="op">$</span>int =<span class="st"> &quot;60%&quot;</span></span>
<span id="cb66-286"><a href="#cb66-286" aria-hidden="true"></a>grad_mean_amp_N170_eigt<span class="op">$</span>int =<span class="st"> &quot;80%&quot;</span></span>
<span id="cb66-287"><a href="#cb66-287" aria-hidden="true"></a>grad_mean_amp_N170_oneh<span class="op">$</span>int =<span class="st"> &quot;100%&quot;</span></span>
<span id="cb66-288"><a href="#cb66-288" aria-hidden="true"></a></span>
<span id="cb66-289"><a href="#cb66-289" aria-hidden="true"></a>grad_mean_amp_P3_twent<span class="op">$</span>int =<span class="st"> &quot;20%&quot;</span></span>
<span id="cb66-290"><a href="#cb66-290" aria-hidden="true"></a>grad_mean_amp_P3_fort<span class="op">$</span>int =<span class="st"> &quot;40%&quot;</span></span>
<span id="cb66-291"><a href="#cb66-291" aria-hidden="true"></a>grad_mean_amp_P3_sixt<span class="op">$</span>int =<span class="st"> &quot;60%&quot;</span></span>
<span id="cb66-292"><a href="#cb66-292" aria-hidden="true"></a>grad_mean_amp_P3_eigt<span class="op">$</span>int =<span class="st"> &quot;80%&quot;</span></span>
<span id="cb66-293"><a href="#cb66-293" aria-hidden="true"></a>grad_mean_amp_P3_oneh<span class="op">$</span>int =<span class="st"> &quot;100%&quot;</span></span>
<span id="cb66-294"><a href="#cb66-294" aria-hidden="true"></a></span>
<span id="cb66-295"><a href="#cb66-295" aria-hidden="true"></a></span>
<span id="cb66-296"><a href="#cb66-296" aria-hidden="true"></a><span class="co"># Bring intensities together</span></span>
<span id="cb66-297"><a href="#cb66-297" aria-hidden="true"></a></span>
<span id="cb66-298"><a href="#cb66-298" aria-hidden="true"></a>grad_mean_amp_P1 =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_P1_twent, grad_mean_amp_P1_fort, grad_mean_amp_P1_sixt, </span>
<span id="cb66-299"><a href="#cb66-299" aria-hidden="true"></a>    grad_mean_amp_P1_eigt, grad_mean_amp_P1_oneh)</span>
<span id="cb66-300"><a href="#cb66-300" aria-hidden="true"></a>grad_mean_amp_N170 =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_N170_twent, grad_mean_amp_N170_fort, grad_mean_amp_N170_sixt, </span>
<span id="cb66-301"><a href="#cb66-301" aria-hidden="true"></a>    grad_mean_amp_N170_eigt, grad_mean_amp_N170_oneh)</span>
<span id="cb66-302"><a href="#cb66-302" aria-hidden="true"></a>grad_mean_amp_P3 =<span class="st"> </span><span class="kw">rbind</span>(grad_mean_amp_P3_twent, grad_mean_amp_P3_fort, grad_mean_amp_P3_sixt, </span>
<span id="cb66-303"><a href="#cb66-303" aria-hidden="true"></a>    grad_mean_amp_P3_eigt, grad_mean_amp_P3_oneh)</span></code></pre></div>
<p><br></p>
</div>
<div id="erp-line-plot" class="section level3">
<h3>ERP line plot</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true"></a><span class="co">###### Preparing the data ######</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true"></a>  </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true"></a><span class="co"># Average for happy lOT at 20/40/60/80/100%</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">20</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">20</span> =</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true"></a><span class="st">      </span>grad_P1_lOT_<span class="dv">20</span> <span class="op">%&gt;%</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_lOT_20_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true"></a>  </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true"></a>  </span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">40</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">40</span> =</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true"></a><span class="st">      </span>grad_P1_lOT_<span class="dv">40</span> <span class="op">%&gt;%</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_lOT_40_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true"></a>  </span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true"></a>  </span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">60</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">60</span> =</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true"></a><span class="st">      </span>grad_P1_lOT_<span class="dv">60</span> <span class="op">%&gt;%</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_lOT_60_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true"></a>  </span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true"></a>  </span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">80</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">80</span> =</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true"></a><span class="st">      </span>grad_P1_lOT_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_lOT_80_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true"></a>  </span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true"></a>  </span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">100</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">100</span> =</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true"></a><span class="st">      </span>grad_P1_lOT_<span class="dv">100</span> <span class="op">%&gt;%</span></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_lOT_100_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true"></a>  </span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true"></a>  </span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true"></a><span class="co"># Average for happy rOT at 20/40/60/80/100%</span></span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">20</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">20</span> =</span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true"></a><span class="st">      </span>grad_P1_rOT_<span class="dv">20</span> <span class="op">%&gt;%</span></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_rOT_20_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true"></a>  </span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true"></a>  </span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">40</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">40</span> =</span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true"></a><span class="st">      </span>grad_P1_rOT_<span class="dv">40</span> <span class="op">%&gt;%</span></span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_rOT_40_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true"></a>  </span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true"></a>  </span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">60</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">60</span> =</span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true"></a><span class="st">      </span>grad_P1_rOT_<span class="dv">60</span> <span class="op">%&gt;%</span></span>
<span id="cb67-57"><a href="#cb67-57" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb67-58"><a href="#cb67-58" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_rOT_60_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb67-59"><a href="#cb67-59" aria-hidden="true"></a>  </span>
<span id="cb67-60"><a href="#cb67-60" aria-hidden="true"></a>  </span>
<span id="cb67-61"><a href="#cb67-61" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">80</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb67-62"><a href="#cb67-62" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">80</span> =</span>
<span id="cb67-63"><a href="#cb67-63" aria-hidden="true"></a><span class="st">      </span>grad_P1_rOT_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb67-64"><a href="#cb67-64" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb67-65"><a href="#cb67-65" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_rOT_80_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb67-66"><a href="#cb67-66" aria-hidden="true"></a>  </span>
<span id="cb67-67"><a href="#cb67-67" aria-hidden="true"></a>  </span>
<span id="cb67-68"><a href="#cb67-68" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">100</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb67-69"><a href="#cb67-69" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">100</span> =</span>
<span id="cb67-70"><a href="#cb67-70" aria-hidden="true"></a><span class="st">      </span>grad_P1_rOT_<span class="dv">100</span> <span class="op">%&gt;%</span></span>
<span id="cb67-71"><a href="#cb67-71" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb67-72"><a href="#cb67-72" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_rOT_100_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))    </span>
<span id="cb67-73"><a href="#cb67-73" aria-hidden="true"></a>    </span>
<span id="cb67-74"><a href="#cb67-74" aria-hidden="true"></a>  </span>
<span id="cb67-75"><a href="#cb67-75" aria-hidden="true"></a><span class="co"># Averages from P1</span></span>
<span id="cb67-76"><a href="#cb67-76" aria-hidden="true"></a>  Av_ERP =<span class="st"> </span><span class="kw">as.data.frame</span>(grad_P1_lOT_<span class="dv">20</span><span class="op">$</span>P1_lOT_<span class="dv">20</span>_amp)</span>
<span id="cb67-77"><a href="#cb67-77" aria-hidden="true"></a>  <span class="kw">names</span>(Av_ERP)[<span class="kw">names</span>(Av_ERP) <span class="op">==</span><span class="st"> &#39;grad_P1_lOT_20$P1_lOT_20_amp&#39;</span>] =<span class="st"> &#39;P1_lOT_20_amp&#39;</span></span>
<span id="cb67-78"><a href="#cb67-78" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_lOT_<span class="dv">40</span>_amp =<span class="st"> </span>grad_P1_lOT_<span class="dv">40</span><span class="op">$</span>P1_lOT_<span class="dv">40</span>_amp</span>
<span id="cb67-79"><a href="#cb67-79" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_lOT_<span class="dv">60</span>_amp =<span class="st"> </span>grad_P1_lOT_<span class="dv">60</span><span class="op">$</span>P1_lOT_<span class="dv">60</span>_amp</span>
<span id="cb67-80"><a href="#cb67-80" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_lOT_<span class="dv">80</span>_amp =<span class="st"> </span>grad_P1_lOT_<span class="dv">80</span><span class="op">$</span>P1_lOT_<span class="dv">80</span>_amp</span>
<span id="cb67-81"><a href="#cb67-81" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_lOT_<span class="dv">100</span>_amp =<span class="st"> </span>grad_P1_lOT_<span class="dv">100</span><span class="op">$</span>P1_lOT_<span class="dv">100</span>_amp</span>
<span id="cb67-82"><a href="#cb67-82" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_rOT_<span class="dv">20</span>_amp =<span class="st"> </span>grad_P1_rOT_<span class="dv">20</span><span class="op">$</span>P1_rOT_<span class="dv">20</span>_amp</span>
<span id="cb67-83"><a href="#cb67-83" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_rOT_<span class="dv">40</span>_amp =<span class="st"> </span>grad_P1_rOT_<span class="dv">40</span><span class="op">$</span>P1_rOT_<span class="dv">40</span>_amp</span>
<span id="cb67-84"><a href="#cb67-84" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_rOT_<span class="dv">60</span>_amp =<span class="st"> </span>grad_P1_rOT_<span class="dv">60</span><span class="op">$</span>P1_rOT_<span class="dv">60</span>_amp</span>
<span id="cb67-85"><a href="#cb67-85" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_rOT_<span class="dv">80</span>_amp =<span class="st"> </span>grad_P1_rOT_<span class="dv">80</span><span class="op">$</span>P1_rOT_<span class="dv">80</span>_amp</span>
<span id="cb67-86"><a href="#cb67-86" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_rOT_<span class="dv">100</span>_amp =<span class="st"> </span>grad_P1_rOT_<span class="dv">100</span><span class="op">$</span>P1_rOT_<span class="dv">100</span>_amp</span>
<span id="cb67-87"><a href="#cb67-87" aria-hidden="true"></a></span>
<span id="cb67-88"><a href="#cb67-88" aria-hidden="true"></a><span class="co"># Calculate means/SEs</span></span>
<span id="cb67-89"><a href="#cb67-89" aria-hidden="true"></a>  P1_stats =<span class="st"> </span>Av_ERP <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb67-90"><a href="#cb67-90" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm=</span>T), <span class="dt">n =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)), <span class="dt">se =</span> <span class="kw">sd</span>(., <span class="dt">na.rm=</span>T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)))))</span>
<span id="cb67-91"><a href="#cb67-91" aria-hidden="true"></a>  </span>
<span id="cb67-92"><a href="#cb67-92" aria-hidden="true"></a><span class="co"># Combine data into one data frame </span></span>
<span id="cb67-93"><a href="#cb67-93" aria-hidden="true"></a>  P1_av =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">intens =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>,<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>)),</span>
<span id="cb67-94"><a href="#cb67-94" aria-hidden="true"></a>                <span class="dt">roi =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>)),</span>
<span id="cb67-95"><a href="#cb67-95" aria-hidden="true"></a>                <span class="dt">amp =</span> <span class="kw">c</span>(P1_stats<span class="op">$</span>P1_lOT_<span class="dv">20</span>_amp_mean,P1_stats<span class="op">$</span>P1_lOT_<span class="dv">40</span>_amp_mean,P1_stats<span class="op">$</span>P1_lOT_<span class="dv">60</span>_amp_mean,</span>
<span id="cb67-96"><a href="#cb67-96" aria-hidden="true"></a>                        P1_stats<span class="op">$</span>P1_lOT_<span class="dv">80</span>_amp_mean,P1_stats<span class="op">$</span>P1_lOT_<span class="dv">100</span>_amp_mean,</span>
<span id="cb67-97"><a href="#cb67-97" aria-hidden="true"></a>                        P1_stats<span class="op">$</span>P1_rOT_<span class="dv">20</span>_amp_mean,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">40</span>_amp_mean,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">60</span>_amp_mean,</span>
<span id="cb67-98"><a href="#cb67-98" aria-hidden="true"></a>                        P1_stats<span class="op">$</span>P1_rOT_<span class="dv">80</span>_amp_mean,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">100</span>_amp_mean),</span>
<span id="cb67-99"><a href="#cb67-99" aria-hidden="true"></a>                <span class="dt">se =</span> <span class="kw">c</span>(P1_stats<span class="op">$</span>P1_lOT_<span class="dv">20</span>_amp_se,P1_stats<span class="op">$</span>P1_lOT_<span class="dv">40</span>_amp_se,P1_stats<span class="op">$</span>P1_lOT_<span class="dv">60</span>_amp_se,</span>
<span id="cb67-100"><a href="#cb67-100" aria-hidden="true"></a>                        P1_stats<span class="op">$</span>P1_lOT_<span class="dv">80</span>_amp_se,P1_stats<span class="op">$</span>P1_lOT_<span class="dv">100</span>_amp_se,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">20</span>_amp_se,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">40</span>_amp_se,</span>
<span id="cb67-101"><a href="#cb67-101" aria-hidden="true"></a>                        P1_stats<span class="op">$</span>P1_rOT_<span class="dv">60</span>_amp_se,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">80</span>_amp_se,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">100</span>_amp_se))</span>
<span id="cb67-102"><a href="#cb67-102" aria-hidden="true"></a>  </span>
<span id="cb67-103"><a href="#cb67-103" aria-hidden="true"></a></span>
<span id="cb67-104"><a href="#cb67-104" aria-hidden="true"></a><span class="co">###### Plotting ###### </span></span>
<span id="cb67-105"><a href="#cb67-105" aria-hidden="true"></a>  </span>
<span id="cb67-106"><a href="#cb67-106" aria-hidden="true"></a>P1_av<span class="op">$</span>roi =<span class="st"> </span><span class="kw">factor</span>(P1_av<span class="op">$</span>roi, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>))</span>
<span id="cb67-107"><a href="#cb67-107" aria-hidden="true"></a>P1_av<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(P1_av<span class="op">$</span>intens, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>))</span>
<span id="cb67-108"><a href="#cb67-108" aria-hidden="true"></a>  </span>
<span id="cb67-109"><a href="#cb67-109" aria-hidden="true"></a>    </span>
<span id="cb67-110"><a href="#cb67-110" aria-hidden="true"></a>P1_lines =<span class="st"> </span><span class="kw">ggplot</span>(P1_av, <span class="kw">aes</span>(<span class="dt">x=</span>roi, <span class="dt">y=</span>amp, <span class="dt">group=</span>intens, <span class="dt">color=</span>intens)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb67-111"><a href="#cb67-111" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>amp<span class="op">-</span>se, <span class="dt">ymax=</span>amp<span class="op">+</span>se), <span class="dt">width=</span>.<span class="dv">2</span>,<span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb67-112"><a href="#cb67-112" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb67-113"><a href="#cb67-113" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb67-114"><a href="#cb67-114" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span> <span class="kw">c</span>(<span class="st">&quot;#cceaff&quot;</span>,<span class="st">&quot;#80ccff&quot;</span>,<span class="st">&quot;#0098ff&quot;</span>,<span class="st">&quot;#005b99&quot;</span>,<span class="st">&quot;#002e4c&quot;</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb67-115"><a href="#cb67-115" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb67-116"><a href="#cb67-116" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;ROI&quot;</span>) <span class="op">+</span></span>
<span id="cb67-117"><a href="#cb67-117" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb67-118"><a href="#cb67-118" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>)) <span class="op">+</span></span>
<span id="cb67-119"><a href="#cb67-119" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">12</span>)<span class="op">+</span></span>
<span id="cb67-120"><a href="#cb67-120" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span><span class="st">&quot;none&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb67-121"><a href="#cb67-121" aria-hidden="true"></a>          <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</span>
<span id="cb67-122"><a href="#cb67-122" aria-hidden="true"></a>          <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="co"># get rid of legend bg</span></span>
<span id="cb67-123"><a href="#cb67-123" aria-hidden="true"></a>          <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb67-124"><a href="#cb67-124" aria-hidden="true"></a>          <span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">size=</span><span class="fl">0.6</span>))</span>
<span id="cb67-125"><a href="#cb67-125" aria-hidden="true"></a>  </span>
<span id="cb67-126"><a href="#cb67-126" aria-hidden="true"></a>  P1_lines</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/grad_line_P1_hap-1.png" width="192" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true"></a><span class="co"># Save plots with transparent background     </span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true"></a>  <span class="kw">ggsave</span>(<span class="st">&quot;./figures/fig_grad_P1_hap_lines.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)  </span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true"></a><span class="co">###### Preparing the data ######</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true"></a>  </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true"></a><span class="co"># Average for angry lOT at 20/40/60/80/100%</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">20</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">20</span> =</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true"></a><span class="st">      </span>grad_P1_lOT_<span class="dv">20</span> <span class="op">%&gt;%</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_lOT_20_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true"></a>  </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true"></a>  </span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">40</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">40</span> =</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true"></a><span class="st">      </span>grad_P1_lOT_<span class="dv">40</span> <span class="op">%&gt;%</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_lOT_40_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true"></a>  </span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true"></a>  </span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">60</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">60</span> =</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true"></a><span class="st">      </span>grad_P1_lOT_<span class="dv">60</span> <span class="op">%&gt;%</span></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_lOT_60_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true"></a>  </span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true"></a>  </span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">80</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">80</span> =</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true"></a><span class="st">      </span>grad_P1_lOT_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_lOT_80_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true"></a>  </span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true"></a>  </span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">100</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true"></a>  grad_P1_lOT_<span class="dv">100</span> =</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true"></a><span class="st">      </span>grad_P1_lOT_<span class="dv">100</span> <span class="op">%&gt;%</span></span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_lOT_100_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true"></a>  </span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true"></a>  </span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true"></a><span class="co"># Average for angry rOT at 20/40/60/80/100%</span></span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">20</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">20</span> =</span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true"></a><span class="st">      </span>grad_P1_rOT_<span class="dv">20</span> <span class="op">%&gt;%</span></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_rOT_20_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true"></a>  </span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true"></a>  </span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">40</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">40</span> =</span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true"></a><span class="st">      </span>grad_P1_rOT_<span class="dv">40</span> <span class="op">%&gt;%</span></span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_rOT_40_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true"></a>  </span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true"></a>  </span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">60</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">60</span> =</span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true"></a><span class="st">      </span>grad_P1_rOT_<span class="dv">60</span> <span class="op">%&gt;%</span></span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_rOT_60_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true"></a>  </span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true"></a>  </span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">80</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">80</span> =</span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true"></a><span class="st">      </span>grad_P1_rOT_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_rOT_80_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true"></a>  </span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true"></a>  </span>
<span id="cb69-68"><a href="#cb69-68" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">100</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P1, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb69-69"><a href="#cb69-69" aria-hidden="true"></a>  grad_P1_rOT_<span class="dv">100</span> =</span>
<span id="cb69-70"><a href="#cb69-70" aria-hidden="true"></a><span class="st">      </span>grad_P1_rOT_<span class="dv">100</span> <span class="op">%&gt;%</span></span>
<span id="cb69-71"><a href="#cb69-71" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb69-72"><a href="#cb69-72" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P1_rOT_100_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))    </span>
<span id="cb69-73"><a href="#cb69-73" aria-hidden="true"></a>    </span>
<span id="cb69-74"><a href="#cb69-74" aria-hidden="true"></a>  </span>
<span id="cb69-75"><a href="#cb69-75" aria-hidden="true"></a><span class="co"># Averages from P1</span></span>
<span id="cb69-76"><a href="#cb69-76" aria-hidden="true"></a>  Av_ERP =<span class="st"> </span><span class="kw">as.data.frame</span>(grad_P1_lOT_<span class="dv">20</span><span class="op">$</span>P1_lOT_<span class="dv">20</span>_amp)</span>
<span id="cb69-77"><a href="#cb69-77" aria-hidden="true"></a>  <span class="kw">names</span>(Av_ERP)[<span class="kw">names</span>(Av_ERP) <span class="op">==</span><span class="st"> &#39;grad_P1_lOT_20$P1_lOT_20_amp&#39;</span>] =<span class="st"> &#39;P1_lOT_20_amp&#39;</span></span>
<span id="cb69-78"><a href="#cb69-78" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_lOT_<span class="dv">40</span>_amp =<span class="st"> </span>grad_P1_lOT_<span class="dv">40</span><span class="op">$</span>P1_lOT_<span class="dv">40</span>_amp</span>
<span id="cb69-79"><a href="#cb69-79" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_lOT_<span class="dv">60</span>_amp =<span class="st"> </span>grad_P1_lOT_<span class="dv">60</span><span class="op">$</span>P1_lOT_<span class="dv">60</span>_amp</span>
<span id="cb69-80"><a href="#cb69-80" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_lOT_<span class="dv">80</span>_amp =<span class="st"> </span>grad_P1_lOT_<span class="dv">80</span><span class="op">$</span>P1_lOT_<span class="dv">80</span>_amp</span>
<span id="cb69-81"><a href="#cb69-81" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_lOT_<span class="dv">100</span>_amp =<span class="st"> </span>grad_P1_lOT_<span class="dv">100</span><span class="op">$</span>P1_lOT_<span class="dv">100</span>_amp</span>
<span id="cb69-82"><a href="#cb69-82" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_rOT_<span class="dv">20</span>_amp =<span class="st"> </span>grad_P1_rOT_<span class="dv">20</span><span class="op">$</span>P1_rOT_<span class="dv">20</span>_amp</span>
<span id="cb69-83"><a href="#cb69-83" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_rOT_<span class="dv">40</span>_amp =<span class="st"> </span>grad_P1_rOT_<span class="dv">40</span><span class="op">$</span>P1_rOT_<span class="dv">40</span>_amp</span>
<span id="cb69-84"><a href="#cb69-84" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_rOT_<span class="dv">60</span>_amp =<span class="st"> </span>grad_P1_rOT_<span class="dv">60</span><span class="op">$</span>P1_rOT_<span class="dv">60</span>_amp</span>
<span id="cb69-85"><a href="#cb69-85" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_rOT_<span class="dv">80</span>_amp =<span class="st"> </span>grad_P1_rOT_<span class="dv">80</span><span class="op">$</span>P1_rOT_<span class="dv">80</span>_amp</span>
<span id="cb69-86"><a href="#cb69-86" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P1_rOT_<span class="dv">100</span>_amp =<span class="st"> </span>grad_P1_rOT_<span class="dv">100</span><span class="op">$</span>P1_rOT_<span class="dv">100</span>_amp</span>
<span id="cb69-87"><a href="#cb69-87" aria-hidden="true"></a></span>
<span id="cb69-88"><a href="#cb69-88" aria-hidden="true"></a><span class="co"># Calculate means/SEs</span></span>
<span id="cb69-89"><a href="#cb69-89" aria-hidden="true"></a>  P1_stats =<span class="st"> </span>Av_ERP <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb69-90"><a href="#cb69-90" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm=</span>T), <span class="dt">n =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)), <span class="dt">se =</span> <span class="kw">sd</span>(., <span class="dt">na.rm=</span>T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)))))</span>
<span id="cb69-91"><a href="#cb69-91" aria-hidden="true"></a>  </span>
<span id="cb69-92"><a href="#cb69-92" aria-hidden="true"></a><span class="co"># Combine data into one data frame </span></span>
<span id="cb69-93"><a href="#cb69-93" aria-hidden="true"></a>  P1_av =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">intens =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>,<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>)),</span>
<span id="cb69-94"><a href="#cb69-94" aria-hidden="true"></a>                <span class="dt">roi =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>)),</span>
<span id="cb69-95"><a href="#cb69-95" aria-hidden="true"></a>                <span class="dt">amp =</span> <span class="kw">c</span>(P1_stats<span class="op">$</span>P1_lOT_<span class="dv">20</span>_amp_mean,P1_stats<span class="op">$</span>P1_lOT_<span class="dv">40</span>_amp_mean,P1_stats<span class="op">$</span>P1_lOT_<span class="dv">60</span>_amp_mean,</span>
<span id="cb69-96"><a href="#cb69-96" aria-hidden="true"></a>                        P1_stats<span class="op">$</span>P1_lOT_<span class="dv">80</span>_amp_mean,P1_stats<span class="op">$</span>P1_lOT_<span class="dv">100</span>_amp_mean,</span>
<span id="cb69-97"><a href="#cb69-97" aria-hidden="true"></a>                        P1_stats<span class="op">$</span>P1_rOT_<span class="dv">20</span>_amp_mean,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">40</span>_amp_mean,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">60</span>_amp_mean,</span>
<span id="cb69-98"><a href="#cb69-98" aria-hidden="true"></a>                        P1_stats<span class="op">$</span>P1_rOT_<span class="dv">80</span>_amp_mean,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">100</span>_amp_mean),</span>
<span id="cb69-99"><a href="#cb69-99" aria-hidden="true"></a>                <span class="dt">se =</span> <span class="kw">c</span>(P1_stats<span class="op">$</span>P1_lOT_<span class="dv">20</span>_amp_se,P1_stats<span class="op">$</span>P1_lOT_<span class="dv">40</span>_amp_se,P1_stats<span class="op">$</span>P1_lOT_<span class="dv">60</span>_amp_se,</span>
<span id="cb69-100"><a href="#cb69-100" aria-hidden="true"></a>                        P1_stats<span class="op">$</span>P1_lOT_<span class="dv">80</span>_amp_se,P1_stats<span class="op">$</span>P1_lOT_<span class="dv">100</span>_amp_se,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">20</span>_amp_se,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">40</span>_amp_se,</span>
<span id="cb69-101"><a href="#cb69-101" aria-hidden="true"></a>                        P1_stats<span class="op">$</span>P1_rOT_<span class="dv">60</span>_amp_se,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">80</span>_amp_se,P1_stats<span class="op">$</span>P1_rOT_<span class="dv">100</span>_amp_se))</span>
<span id="cb69-102"><a href="#cb69-102" aria-hidden="true"></a>  </span>
<span id="cb69-103"><a href="#cb69-103" aria-hidden="true"></a></span>
<span id="cb69-104"><a href="#cb69-104" aria-hidden="true"></a><span class="co">###### Plotting ###### </span></span>
<span id="cb69-105"><a href="#cb69-105" aria-hidden="true"></a>  </span>
<span id="cb69-106"><a href="#cb69-106" aria-hidden="true"></a>P1_av<span class="op">$</span>roi =<span class="st"> </span><span class="kw">factor</span>(P1_av<span class="op">$</span>roi, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>))</span>
<span id="cb69-107"><a href="#cb69-107" aria-hidden="true"></a>P1_av<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(P1_av<span class="op">$</span>intens, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>))</span>
<span id="cb69-108"><a href="#cb69-108" aria-hidden="true"></a>  </span>
<span id="cb69-109"><a href="#cb69-109" aria-hidden="true"></a>    </span>
<span id="cb69-110"><a href="#cb69-110" aria-hidden="true"></a>P1_lines =<span class="st"> </span><span class="kw">ggplot</span>(P1_av, <span class="kw">aes</span>(<span class="dt">x=</span>roi, <span class="dt">y=</span>amp, <span class="dt">group=</span>intens, <span class="dt">color=</span>intens)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb69-111"><a href="#cb69-111" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>amp<span class="op">-</span>se, <span class="dt">ymax=</span>amp<span class="op">+</span>se), <span class="dt">width=</span>.<span class="dv">2</span>,<span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb69-112"><a href="#cb69-112" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb69-113"><a href="#cb69-113" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb69-114"><a href="#cb69-114" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span> <span class="kw">c</span>(<span class="st">&quot;gray88&quot;</span>,<span class="st">&quot;gray82&quot;</span>,<span class="st">&quot;gray60&quot;</span>,<span class="st">&quot;gray44&quot;</span>,<span class="st">&quot;gray8&quot;</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb69-115"><a href="#cb69-115" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb69-116"><a href="#cb69-116" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;ROI&quot;</span>) <span class="op">+</span></span>
<span id="cb69-117"><a href="#cb69-117" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb69-118"><a href="#cb69-118" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>)) <span class="op">+</span></span>
<span id="cb69-119"><a href="#cb69-119" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">12</span>)<span class="op">+</span></span>
<span id="cb69-120"><a href="#cb69-120" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span><span class="st">&quot;none&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb69-121"><a href="#cb69-121" aria-hidden="true"></a>          <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</span>
<span id="cb69-122"><a href="#cb69-122" aria-hidden="true"></a>          <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="co"># get rid of legend bg</span></span>
<span id="cb69-123"><a href="#cb69-123" aria-hidden="true"></a>          <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb69-124"><a href="#cb69-124" aria-hidden="true"></a>          <span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">size=</span><span class="fl">0.6</span>))</span>
<span id="cb69-125"><a href="#cb69-125" aria-hidden="true"></a>  </span>
<span id="cb69-126"><a href="#cb69-126" aria-hidden="true"></a>  P1_lines</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/grad_line_P1_ang-1.png" width="192" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true"></a><span class="co"># Save plots with transparent background     </span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true"></a>  <span class="kw">ggsave</span>(<span class="st">&quot;./figures/fig_grad_P1_ang_lines.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)  </span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true"></a><span class="co">###### Preparing the data ######</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true"></a>  </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true"></a><span class="co"># Average for happy lOT at 20/40/60/80/100%</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">20</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">20</span> =</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true"></a><span class="st">      </span>grad_N170_lOT_<span class="dv">20</span> <span class="op">%&gt;%</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_lOT_20_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true"></a>  </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true"></a>  </span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">40</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">40</span> =</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true"></a><span class="st">      </span>grad_N170_lOT_<span class="dv">40</span> <span class="op">%&gt;%</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_lOT_40_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true"></a>  </span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true"></a>  </span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">60</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">60</span> =</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true"></a><span class="st">      </span>grad_N170_lOT_<span class="dv">60</span> <span class="op">%&gt;%</span></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_lOT_60_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true"></a>  </span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true"></a>  </span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">80</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">80</span> =</span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true"></a><span class="st">      </span>grad_N170_lOT_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_lOT_80_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true"></a>  </span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true"></a>  </span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">100</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">100</span> =</span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true"></a><span class="st">      </span>grad_N170_lOT_<span class="dv">100</span> <span class="op">%&gt;%</span></span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_lOT_100_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true"></a>  </span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true"></a>  </span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true"></a><span class="co"># Average for happy rOT at 20/40/60/80/100%</span></span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">20</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">20</span> =</span>
<span id="cb71-42"><a href="#cb71-42" aria-hidden="true"></a><span class="st">      </span>grad_N170_rOT_<span class="dv">20</span> <span class="op">%&gt;%</span></span>
<span id="cb71-43"><a href="#cb71-43" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb71-44"><a href="#cb71-44" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_rOT_20_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb71-45"><a href="#cb71-45" aria-hidden="true"></a>  </span>
<span id="cb71-46"><a href="#cb71-46" aria-hidden="true"></a>  </span>
<span id="cb71-47"><a href="#cb71-47" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">40</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb71-48"><a href="#cb71-48" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">40</span> =</span>
<span id="cb71-49"><a href="#cb71-49" aria-hidden="true"></a><span class="st">      </span>grad_N170_rOT_<span class="dv">40</span> <span class="op">%&gt;%</span></span>
<span id="cb71-50"><a href="#cb71-50" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb71-51"><a href="#cb71-51" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_rOT_40_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb71-52"><a href="#cb71-52" aria-hidden="true"></a>  </span>
<span id="cb71-53"><a href="#cb71-53" aria-hidden="true"></a>  </span>
<span id="cb71-54"><a href="#cb71-54" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">60</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb71-55"><a href="#cb71-55" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">60</span> =</span>
<span id="cb71-56"><a href="#cb71-56" aria-hidden="true"></a><span class="st">      </span>grad_N170_rOT_<span class="dv">60</span> <span class="op">%&gt;%</span></span>
<span id="cb71-57"><a href="#cb71-57" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb71-58"><a href="#cb71-58" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_rOT_60_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb71-59"><a href="#cb71-59" aria-hidden="true"></a>  </span>
<span id="cb71-60"><a href="#cb71-60" aria-hidden="true"></a>  </span>
<span id="cb71-61"><a href="#cb71-61" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">80</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb71-62"><a href="#cb71-62" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">80</span> =</span>
<span id="cb71-63"><a href="#cb71-63" aria-hidden="true"></a><span class="st">      </span>grad_N170_rOT_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb71-64"><a href="#cb71-64" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb71-65"><a href="#cb71-65" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_rOT_80_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb71-66"><a href="#cb71-66" aria-hidden="true"></a>  </span>
<span id="cb71-67"><a href="#cb71-67" aria-hidden="true"></a>  </span>
<span id="cb71-68"><a href="#cb71-68" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">100</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb71-69"><a href="#cb71-69" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">100</span> =</span>
<span id="cb71-70"><a href="#cb71-70" aria-hidden="true"></a><span class="st">      </span>grad_N170_rOT_<span class="dv">100</span> <span class="op">%&gt;%</span></span>
<span id="cb71-71"><a href="#cb71-71" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb71-72"><a href="#cb71-72" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_rOT_100_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))    </span>
<span id="cb71-73"><a href="#cb71-73" aria-hidden="true"></a>    </span>
<span id="cb71-74"><a href="#cb71-74" aria-hidden="true"></a>  </span>
<span id="cb71-75"><a href="#cb71-75" aria-hidden="true"></a><span class="co"># Averages from N170</span></span>
<span id="cb71-76"><a href="#cb71-76" aria-hidden="true"></a>  Av_ERP =<span class="st"> </span><span class="kw">as.data.frame</span>(grad_N170_lOT_<span class="dv">20</span><span class="op">$</span>N170_lOT_<span class="dv">20</span>_amp)</span>
<span id="cb71-77"><a href="#cb71-77" aria-hidden="true"></a>  <span class="kw">names</span>(Av_ERP)[<span class="kw">names</span>(Av_ERP) <span class="op">==</span><span class="st"> &#39;grad_N170_lOT_20$N170_lOT_20_amp&#39;</span>] =<span class="st"> &#39;N170_lOT_20_amp&#39;</span></span>
<span id="cb71-78"><a href="#cb71-78" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_lOT_<span class="dv">40</span>_amp =<span class="st"> </span>grad_N170_lOT_<span class="dv">40</span><span class="op">$</span>N170_lOT_<span class="dv">40</span>_amp</span>
<span id="cb71-79"><a href="#cb71-79" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_lOT_<span class="dv">60</span>_amp =<span class="st"> </span>grad_N170_lOT_<span class="dv">60</span><span class="op">$</span>N170_lOT_<span class="dv">60</span>_amp</span>
<span id="cb71-80"><a href="#cb71-80" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_lOT_<span class="dv">80</span>_amp =<span class="st"> </span>grad_N170_lOT_<span class="dv">80</span><span class="op">$</span>N170_lOT_<span class="dv">80</span>_amp</span>
<span id="cb71-81"><a href="#cb71-81" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_lOT_<span class="dv">100</span>_amp =<span class="st"> </span>grad_N170_lOT_<span class="dv">100</span><span class="op">$</span>N170_lOT_<span class="dv">100</span>_amp</span>
<span id="cb71-82"><a href="#cb71-82" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_rOT_<span class="dv">20</span>_amp =<span class="st"> </span>grad_N170_rOT_<span class="dv">20</span><span class="op">$</span>N170_rOT_<span class="dv">20</span>_amp</span>
<span id="cb71-83"><a href="#cb71-83" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_rOT_<span class="dv">40</span>_amp =<span class="st"> </span>grad_N170_rOT_<span class="dv">40</span><span class="op">$</span>N170_rOT_<span class="dv">40</span>_amp</span>
<span id="cb71-84"><a href="#cb71-84" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_rOT_<span class="dv">60</span>_amp =<span class="st"> </span>grad_N170_rOT_<span class="dv">60</span><span class="op">$</span>N170_rOT_<span class="dv">60</span>_amp</span>
<span id="cb71-85"><a href="#cb71-85" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_rOT_<span class="dv">80</span>_amp =<span class="st"> </span>grad_N170_rOT_<span class="dv">80</span><span class="op">$</span>N170_rOT_<span class="dv">80</span>_amp</span>
<span id="cb71-86"><a href="#cb71-86" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_rOT_<span class="dv">100</span>_amp =<span class="st"> </span>grad_N170_rOT_<span class="dv">100</span><span class="op">$</span>N170_rOT_<span class="dv">100</span>_amp</span>
<span id="cb71-87"><a href="#cb71-87" aria-hidden="true"></a></span>
<span id="cb71-88"><a href="#cb71-88" aria-hidden="true"></a><span class="co"># Calculate means/SEs</span></span>
<span id="cb71-89"><a href="#cb71-89" aria-hidden="true"></a>  N170_stats =<span class="st"> </span>Av_ERP <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb71-90"><a href="#cb71-90" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm=</span>T), <span class="dt">n =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)), <span class="dt">se =</span> <span class="kw">sd</span>(., <span class="dt">na.rm=</span>T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)))))</span>
<span id="cb71-91"><a href="#cb71-91" aria-hidden="true"></a>  </span>
<span id="cb71-92"><a href="#cb71-92" aria-hidden="true"></a><span class="co"># Combine data into one data frame </span></span>
<span id="cb71-93"><a href="#cb71-93" aria-hidden="true"></a>  N170_av =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">intens =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>,<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>)),</span>
<span id="cb71-94"><a href="#cb71-94" aria-hidden="true"></a>                <span class="dt">roi =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>)),</span>
<span id="cb71-95"><a href="#cb71-95" aria-hidden="true"></a>                <span class="dt">amp =</span> <span class="kw">c</span>(N170_stats<span class="op">$</span>N170_lOT_<span class="dv">20</span>_amp_mean,N170_stats<span class="op">$</span>N170_lOT_<span class="dv">40</span>_amp_mean,N170_stats<span class="op">$</span>N170_lOT_<span class="dv">60</span>_amp_mean,</span>
<span id="cb71-96"><a href="#cb71-96" aria-hidden="true"></a>                        N170_stats<span class="op">$</span>N170_lOT_<span class="dv">80</span>_amp_mean,N170_stats<span class="op">$</span>N170_lOT_<span class="dv">100</span>_amp_mean,</span>
<span id="cb71-97"><a href="#cb71-97" aria-hidden="true"></a>                        N170_stats<span class="op">$</span>N170_rOT_<span class="dv">20</span>_amp_mean,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">40</span>_amp_mean,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">60</span>_amp_mean,</span>
<span id="cb71-98"><a href="#cb71-98" aria-hidden="true"></a>                        N170_stats<span class="op">$</span>N170_rOT_<span class="dv">80</span>_amp_mean,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">100</span>_amp_mean),</span>
<span id="cb71-99"><a href="#cb71-99" aria-hidden="true"></a>                <span class="dt">se =</span> <span class="kw">c</span>(N170_stats<span class="op">$</span>N170_lOT_<span class="dv">20</span>_amp_se,N170_stats<span class="op">$</span>N170_lOT_<span class="dv">40</span>_amp_se,N170_stats<span class="op">$</span>N170_lOT_<span class="dv">60</span>_amp_se,</span>
<span id="cb71-100"><a href="#cb71-100" aria-hidden="true"></a>                        N170_stats<span class="op">$</span>N170_lOT_<span class="dv">80</span>_amp_se,N170_stats<span class="op">$</span>N170_lOT_<span class="dv">100</span>_amp_se,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">20</span>_amp_se,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">40</span>_amp_se,</span>
<span id="cb71-101"><a href="#cb71-101" aria-hidden="true"></a>                        N170_stats<span class="op">$</span>N170_rOT_<span class="dv">60</span>_amp_se,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">80</span>_amp_se,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">100</span>_amp_se))</span>
<span id="cb71-102"><a href="#cb71-102" aria-hidden="true"></a>  </span>
<span id="cb71-103"><a href="#cb71-103" aria-hidden="true"></a></span>
<span id="cb71-104"><a href="#cb71-104" aria-hidden="true"></a><span class="co">###### Plotting ###### </span></span>
<span id="cb71-105"><a href="#cb71-105" aria-hidden="true"></a>  </span>
<span id="cb71-106"><a href="#cb71-106" aria-hidden="true"></a>N170_av<span class="op">$</span>roi =<span class="st"> </span><span class="kw">factor</span>(N170_av<span class="op">$</span>roi, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>))</span>
<span id="cb71-107"><a href="#cb71-107" aria-hidden="true"></a>N170_av<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(N170_av<span class="op">$</span>intens, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>))</span>
<span id="cb71-108"><a href="#cb71-108" aria-hidden="true"></a>  </span>
<span id="cb71-109"><a href="#cb71-109" aria-hidden="true"></a>    </span>
<span id="cb71-110"><a href="#cb71-110" aria-hidden="true"></a>N170_lines =<span class="st"> </span><span class="kw">ggplot</span>(N170_av, <span class="kw">aes</span>(<span class="dt">x=</span>roi, <span class="dt">y=</span>amp, <span class="dt">group=</span>intens, <span class="dt">color=</span>intens)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb71-111"><a href="#cb71-111" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>amp<span class="op">-</span>se, <span class="dt">ymax=</span>amp<span class="op">+</span>se), <span class="dt">width=</span>.<span class="dv">2</span>,<span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb71-112"><a href="#cb71-112" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb71-113"><a href="#cb71-113" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb71-114"><a href="#cb71-114" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span> <span class="kw">c</span>(<span class="st">&quot;#cceaff&quot;</span>,<span class="st">&quot;#80ccff&quot;</span>,<span class="st">&quot;#0098ff&quot;</span>,<span class="st">&quot;#005b99&quot;</span>,<span class="st">&quot;#002e4c&quot;</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb71-115"><a href="#cb71-115" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb71-116"><a href="#cb71-116" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;ROI&quot;</span>) <span class="op">+</span></span>
<span id="cb71-117"><a href="#cb71-117" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb71-118"><a href="#cb71-118" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>)) <span class="op">+</span></span>
<span id="cb71-119"><a href="#cb71-119" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">12</span>)<span class="op">+</span></span>
<span id="cb71-120"><a href="#cb71-120" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span><span class="st">&quot;none&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb71-121"><a href="#cb71-121" aria-hidden="true"></a>          <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</span>
<span id="cb71-122"><a href="#cb71-122" aria-hidden="true"></a>          <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="co"># get rid of legend bg</span></span>
<span id="cb71-123"><a href="#cb71-123" aria-hidden="true"></a>          <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb71-124"><a href="#cb71-124" aria-hidden="true"></a>          <span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">size=</span><span class="fl">0.6</span>))</span>
<span id="cb71-125"><a href="#cb71-125" aria-hidden="true"></a>  </span>
<span id="cb71-126"><a href="#cb71-126" aria-hidden="true"></a>  N170_lines</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/grad_line_N170_hap-1.png" width="192" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true"></a><span class="co"># Save plots with transparent background     </span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true"></a>  <span class="kw">ggsave</span>(<span class="st">&quot;./figures/fig_grad_N170_hap_lines.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)  </span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true"></a><span class="co">###### Preparing the data ######</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true"></a>  </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true"></a><span class="co"># Average for angry lOT at 20/40/60/80/100%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">20</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">20</span> =</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true"></a><span class="st">      </span>grad_N170_lOT_<span class="dv">20</span> <span class="op">%&gt;%</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_lOT_20_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true"></a>  </span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true"></a>  </span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">40</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">40</span> =</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true"></a><span class="st">      </span>grad_N170_lOT_<span class="dv">40</span> <span class="op">%&gt;%</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_lOT_40_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true"></a>  </span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true"></a>  </span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">60</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">60</span> =</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true"></a><span class="st">      </span>grad_N170_lOT_<span class="dv">60</span> <span class="op">%&gt;%</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_lOT_60_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true"></a>  </span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true"></a>  </span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">80</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">80</span> =</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true"></a><span class="st">      </span>grad_N170_lOT_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_lOT_80_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true"></a>  </span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true"></a>  </span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">100</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true"></a>  grad_N170_lOT_<span class="dv">100</span> =</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true"></a><span class="st">      </span>grad_N170_lOT_<span class="dv">100</span> <span class="op">%&gt;%</span></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_lOT_100_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true"></a>  </span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true"></a>  </span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true"></a><span class="co"># Average for angry rOT at 20/40/60/80/100%</span></span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">20</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">20</span> =</span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true"></a><span class="st">      </span>grad_N170_rOT_<span class="dv">20</span> <span class="op">%&gt;%</span></span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_rOT_20_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true"></a>  </span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true"></a>  </span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">40</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">40</span> =</span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true"></a><span class="st">      </span>grad_N170_rOT_<span class="dv">40</span> <span class="op">%&gt;%</span></span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_rOT_40_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb73-52"><a href="#cb73-52" aria-hidden="true"></a>  </span>
<span id="cb73-53"><a href="#cb73-53" aria-hidden="true"></a>  </span>
<span id="cb73-54"><a href="#cb73-54" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">60</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb73-55"><a href="#cb73-55" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">60</span> =</span>
<span id="cb73-56"><a href="#cb73-56" aria-hidden="true"></a><span class="st">      </span>grad_N170_rOT_<span class="dv">60</span> <span class="op">%&gt;%</span></span>
<span id="cb73-57"><a href="#cb73-57" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb73-58"><a href="#cb73-58" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_rOT_60_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb73-59"><a href="#cb73-59" aria-hidden="true"></a>  </span>
<span id="cb73-60"><a href="#cb73-60" aria-hidden="true"></a>  </span>
<span id="cb73-61"><a href="#cb73-61" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">80</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb73-62"><a href="#cb73-62" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">80</span> =</span>
<span id="cb73-63"><a href="#cb73-63" aria-hidden="true"></a><span class="st">      </span>grad_N170_rOT_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb73-64"><a href="#cb73-64" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb73-65"><a href="#cb73-65" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_rOT_80_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb73-66"><a href="#cb73-66" aria-hidden="true"></a>  </span>
<span id="cb73-67"><a href="#cb73-67" aria-hidden="true"></a>  </span>
<span id="cb73-68"><a href="#cb73-68" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">100</span> =<span class="st"> </span><span class="kw">subset</span>(grad_N170, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb73-69"><a href="#cb73-69" aria-hidden="true"></a>  grad_N170_rOT_<span class="dv">100</span> =</span>
<span id="cb73-70"><a href="#cb73-70" aria-hidden="true"></a><span class="st">      </span>grad_N170_rOT_<span class="dv">100</span> <span class="op">%&gt;%</span></span>
<span id="cb73-71"><a href="#cb73-71" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb73-72"><a href="#cb73-72" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">N170_rOT_100_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))    </span>
<span id="cb73-73"><a href="#cb73-73" aria-hidden="true"></a>    </span>
<span id="cb73-74"><a href="#cb73-74" aria-hidden="true"></a>  </span>
<span id="cb73-75"><a href="#cb73-75" aria-hidden="true"></a><span class="co"># Averages from N170</span></span>
<span id="cb73-76"><a href="#cb73-76" aria-hidden="true"></a>  Av_ERP =<span class="st"> </span><span class="kw">as.data.frame</span>(grad_N170_lOT_<span class="dv">20</span><span class="op">$</span>N170_lOT_<span class="dv">20</span>_amp)</span>
<span id="cb73-77"><a href="#cb73-77" aria-hidden="true"></a>  <span class="kw">names</span>(Av_ERP)[<span class="kw">names</span>(Av_ERP) <span class="op">==</span><span class="st"> &#39;grad_N170_lOT_20$N170_lOT_20_amp&#39;</span>] =<span class="st"> &#39;N170_lOT_20_amp&#39;</span></span>
<span id="cb73-78"><a href="#cb73-78" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_lOT_<span class="dv">40</span>_amp =<span class="st"> </span>grad_N170_lOT_<span class="dv">40</span><span class="op">$</span>N170_lOT_<span class="dv">40</span>_amp</span>
<span id="cb73-79"><a href="#cb73-79" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_lOT_<span class="dv">60</span>_amp =<span class="st"> </span>grad_N170_lOT_<span class="dv">60</span><span class="op">$</span>N170_lOT_<span class="dv">60</span>_amp</span>
<span id="cb73-80"><a href="#cb73-80" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_lOT_<span class="dv">80</span>_amp =<span class="st"> </span>grad_N170_lOT_<span class="dv">80</span><span class="op">$</span>N170_lOT_<span class="dv">80</span>_amp</span>
<span id="cb73-81"><a href="#cb73-81" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_lOT_<span class="dv">100</span>_amp =<span class="st"> </span>grad_N170_lOT_<span class="dv">100</span><span class="op">$</span>N170_lOT_<span class="dv">100</span>_amp</span>
<span id="cb73-82"><a href="#cb73-82" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_rOT_<span class="dv">20</span>_amp =<span class="st"> </span>grad_N170_rOT_<span class="dv">20</span><span class="op">$</span>N170_rOT_<span class="dv">20</span>_amp</span>
<span id="cb73-83"><a href="#cb73-83" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_rOT_<span class="dv">40</span>_amp =<span class="st"> </span>grad_N170_rOT_<span class="dv">40</span><span class="op">$</span>N170_rOT_<span class="dv">40</span>_amp</span>
<span id="cb73-84"><a href="#cb73-84" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_rOT_<span class="dv">60</span>_amp =<span class="st"> </span>grad_N170_rOT_<span class="dv">60</span><span class="op">$</span>N170_rOT_<span class="dv">60</span>_amp</span>
<span id="cb73-85"><a href="#cb73-85" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_rOT_<span class="dv">80</span>_amp =<span class="st"> </span>grad_N170_rOT_<span class="dv">80</span><span class="op">$</span>N170_rOT_<span class="dv">80</span>_amp</span>
<span id="cb73-86"><a href="#cb73-86" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>N170_rOT_<span class="dv">100</span>_amp =<span class="st"> </span>grad_N170_rOT_<span class="dv">100</span><span class="op">$</span>N170_rOT_<span class="dv">100</span>_amp</span>
<span id="cb73-87"><a href="#cb73-87" aria-hidden="true"></a></span>
<span id="cb73-88"><a href="#cb73-88" aria-hidden="true"></a><span class="co"># Calculate means/SEs</span></span>
<span id="cb73-89"><a href="#cb73-89" aria-hidden="true"></a>  N170_stats =<span class="st"> </span>Av_ERP <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb73-90"><a href="#cb73-90" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm=</span>T), <span class="dt">n =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)), <span class="dt">se =</span> <span class="kw">sd</span>(., <span class="dt">na.rm=</span>T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)))))</span>
<span id="cb73-91"><a href="#cb73-91" aria-hidden="true"></a>  </span>
<span id="cb73-92"><a href="#cb73-92" aria-hidden="true"></a><span class="co"># Combine data into one data frame </span></span>
<span id="cb73-93"><a href="#cb73-93" aria-hidden="true"></a>  N170_av =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">intens =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>,<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>)),</span>
<span id="cb73-94"><a href="#cb73-94" aria-hidden="true"></a>                <span class="dt">roi =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>)),</span>
<span id="cb73-95"><a href="#cb73-95" aria-hidden="true"></a>                <span class="dt">amp =</span> <span class="kw">c</span>(N170_stats<span class="op">$</span>N170_lOT_<span class="dv">20</span>_amp_mean,N170_stats<span class="op">$</span>N170_lOT_<span class="dv">40</span>_amp_mean,N170_stats<span class="op">$</span>N170_lOT_<span class="dv">60</span>_amp_mean,</span>
<span id="cb73-96"><a href="#cb73-96" aria-hidden="true"></a>                        N170_stats<span class="op">$</span>N170_lOT_<span class="dv">80</span>_amp_mean,N170_stats<span class="op">$</span>N170_lOT_<span class="dv">100</span>_amp_mean,</span>
<span id="cb73-97"><a href="#cb73-97" aria-hidden="true"></a>                        N170_stats<span class="op">$</span>N170_rOT_<span class="dv">20</span>_amp_mean,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">40</span>_amp_mean,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">60</span>_amp_mean,</span>
<span id="cb73-98"><a href="#cb73-98" aria-hidden="true"></a>                        N170_stats<span class="op">$</span>N170_rOT_<span class="dv">80</span>_amp_mean,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">100</span>_amp_mean),</span>
<span id="cb73-99"><a href="#cb73-99" aria-hidden="true"></a>                <span class="dt">se =</span> <span class="kw">c</span>(N170_stats<span class="op">$</span>N170_lOT_<span class="dv">20</span>_amp_se,N170_stats<span class="op">$</span>N170_lOT_<span class="dv">40</span>_amp_se,N170_stats<span class="op">$</span>N170_lOT_<span class="dv">60</span>_amp_se,</span>
<span id="cb73-100"><a href="#cb73-100" aria-hidden="true"></a>                        N170_stats<span class="op">$</span>N170_lOT_<span class="dv">80</span>_amp_se,N170_stats<span class="op">$</span>N170_lOT_<span class="dv">100</span>_amp_se,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">20</span>_amp_se,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">40</span>_amp_se,</span>
<span id="cb73-101"><a href="#cb73-101" aria-hidden="true"></a>                        N170_stats<span class="op">$</span>N170_rOT_<span class="dv">60</span>_amp_se,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">80</span>_amp_se,N170_stats<span class="op">$</span>N170_rOT_<span class="dv">100</span>_amp_se))</span>
<span id="cb73-102"><a href="#cb73-102" aria-hidden="true"></a>  </span>
<span id="cb73-103"><a href="#cb73-103" aria-hidden="true"></a></span>
<span id="cb73-104"><a href="#cb73-104" aria-hidden="true"></a><span class="co">###### Plotting ###### </span></span>
<span id="cb73-105"><a href="#cb73-105" aria-hidden="true"></a>  </span>
<span id="cb73-106"><a href="#cb73-106" aria-hidden="true"></a>N170_av<span class="op">$</span>roi =<span class="st"> </span><span class="kw">factor</span>(N170_av<span class="op">$</span>roi, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>))</span>
<span id="cb73-107"><a href="#cb73-107" aria-hidden="true"></a>N170_av<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(N170_av<span class="op">$</span>intens, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>))</span>
<span id="cb73-108"><a href="#cb73-108" aria-hidden="true"></a>  </span>
<span id="cb73-109"><a href="#cb73-109" aria-hidden="true"></a>    </span>
<span id="cb73-110"><a href="#cb73-110" aria-hidden="true"></a>N170_lines =<span class="st"> </span><span class="kw">ggplot</span>(N170_av, <span class="kw">aes</span>(<span class="dt">x=</span>roi, <span class="dt">y=</span>amp, <span class="dt">group=</span>intens, <span class="dt">color=</span>intens)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb73-111"><a href="#cb73-111" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>amp<span class="op">-</span>se, <span class="dt">ymax=</span>amp<span class="op">+</span>se), <span class="dt">width=</span>.<span class="dv">2</span>,<span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb73-112"><a href="#cb73-112" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb73-113"><a href="#cb73-113" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb73-114"><a href="#cb73-114" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span> <span class="kw">c</span>(<span class="st">&quot;gray88&quot;</span>,<span class="st">&quot;gray82&quot;</span>,<span class="st">&quot;gray60&quot;</span>,<span class="st">&quot;gray44&quot;</span>,<span class="st">&quot;gray8&quot;</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb73-115"><a href="#cb73-115" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb73-116"><a href="#cb73-116" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;ROI&quot;</span>) <span class="op">+</span></span>
<span id="cb73-117"><a href="#cb73-117" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb73-118"><a href="#cb73-118" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>)) <span class="op">+</span></span>
<span id="cb73-119"><a href="#cb73-119" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">12</span>)<span class="op">+</span></span>
<span id="cb73-120"><a href="#cb73-120" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span><span class="st">&quot;none&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb73-121"><a href="#cb73-121" aria-hidden="true"></a>          <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</span>
<span id="cb73-122"><a href="#cb73-122" aria-hidden="true"></a>          <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="co"># get rid of legend bg</span></span>
<span id="cb73-123"><a href="#cb73-123" aria-hidden="true"></a>          <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb73-124"><a href="#cb73-124" aria-hidden="true"></a>          <span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">size=</span><span class="fl">0.6</span>))</span>
<span id="cb73-125"><a href="#cb73-125" aria-hidden="true"></a>  </span>
<span id="cb73-126"><a href="#cb73-126" aria-hidden="true"></a>  N170_lines</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/grad_line_N170_ang-1.png" width="192" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true"></a><span class="co"># Save plots with transparent background     </span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true"></a>  <span class="kw">ggsave</span>(<span class="st">&quot;./figures/fig_grad_N170_ang_lines.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)  </span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true"></a><span class="co">###### Preparing the data ######</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true"></a>  </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true"></a><span class="co"># Average for happy lOT at 20/40/60/80/100%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">20</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">20</span> =</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true"></a><span class="st">      </span>grad_P3_lOT_<span class="dv">20</span> <span class="op">%&gt;%</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_lOT_20_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true"></a>  </span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true"></a>  </span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">40</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">40</span> =</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true"></a><span class="st">      </span>grad_P3_lOT_<span class="dv">40</span> <span class="op">%&gt;%</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_lOT_40_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true"></a>  </span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true"></a>  </span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">60</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">60</span> =</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true"></a><span class="st">      </span>grad_P3_lOT_<span class="dv">60</span> <span class="op">%&gt;%</span></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_lOT_60_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true"></a>  </span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true"></a>  </span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">80</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">80</span> =</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true"></a><span class="st">      </span>grad_P3_lOT_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_lOT_80_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true"></a>  </span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true"></a>  </span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">100</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">100</span> =</span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true"></a><span class="st">      </span>grad_P3_lOT_<span class="dv">100</span> <span class="op">%&gt;%</span></span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_lOT_100_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true"></a>  </span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true"></a>  </span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true"></a><span class="co"># Average for happy rOT at 20/40/60/80/100%</span></span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">20</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">20</span> =</span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true"></a><span class="st">      </span>grad_P3_rOT_<span class="dv">20</span> <span class="op">%&gt;%</span></span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_rOT_20_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true"></a>  </span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true"></a>  </span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">40</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">40</span> =</span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true"></a><span class="st">      </span>grad_P3_rOT_<span class="dv">40</span> <span class="op">%&gt;%</span></span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_rOT_40_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true"></a>  </span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true"></a>  </span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">60</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb75-55"><a href="#cb75-55" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">60</span> =</span>
<span id="cb75-56"><a href="#cb75-56" aria-hidden="true"></a><span class="st">      </span>grad_P3_rOT_<span class="dv">60</span> <span class="op">%&gt;%</span></span>
<span id="cb75-57"><a href="#cb75-57" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb75-58"><a href="#cb75-58" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_rOT_60_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb75-59"><a href="#cb75-59" aria-hidden="true"></a>  </span>
<span id="cb75-60"><a href="#cb75-60" aria-hidden="true"></a>  </span>
<span id="cb75-61"><a href="#cb75-61" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">80</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb75-62"><a href="#cb75-62" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">80</span> =</span>
<span id="cb75-63"><a href="#cb75-63" aria-hidden="true"></a><span class="st">      </span>grad_P3_rOT_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb75-64"><a href="#cb75-64" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb75-65"><a href="#cb75-65" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_rOT_80_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb75-66"><a href="#cb75-66" aria-hidden="true"></a>  </span>
<span id="cb75-67"><a href="#cb75-67" aria-hidden="true"></a>  </span>
<span id="cb75-68"><a href="#cb75-68" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">100</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;happy&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb75-69"><a href="#cb75-69" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">100</span> =</span>
<span id="cb75-70"><a href="#cb75-70" aria-hidden="true"></a><span class="st">      </span>grad_P3_rOT_<span class="dv">100</span> <span class="op">%&gt;%</span></span>
<span id="cb75-71"><a href="#cb75-71" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb75-72"><a href="#cb75-72" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_rOT_100_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))    </span>
<span id="cb75-73"><a href="#cb75-73" aria-hidden="true"></a>    </span>
<span id="cb75-74"><a href="#cb75-74" aria-hidden="true"></a>  </span>
<span id="cb75-75"><a href="#cb75-75" aria-hidden="true"></a><span class="co"># Averages from P3</span></span>
<span id="cb75-76"><a href="#cb75-76" aria-hidden="true"></a>  Av_ERP =<span class="st"> </span><span class="kw">as.data.frame</span>(grad_P3_lOT_<span class="dv">20</span><span class="op">$</span>P3_lOT_<span class="dv">20</span>_amp)</span>
<span id="cb75-77"><a href="#cb75-77" aria-hidden="true"></a>  <span class="kw">names</span>(Av_ERP)[<span class="kw">names</span>(Av_ERP) <span class="op">==</span><span class="st"> &#39;grad_P3_lOT_20$P3_lOT_20_amp&#39;</span>] =<span class="st"> &#39;P3_lOT_20_amp&#39;</span></span>
<span id="cb75-78"><a href="#cb75-78" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_lOT_<span class="dv">40</span>_amp =<span class="st"> </span>grad_P3_lOT_<span class="dv">40</span><span class="op">$</span>P3_lOT_<span class="dv">40</span>_amp</span>
<span id="cb75-79"><a href="#cb75-79" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_lOT_<span class="dv">60</span>_amp =<span class="st"> </span>grad_P3_lOT_<span class="dv">60</span><span class="op">$</span>P3_lOT_<span class="dv">60</span>_amp</span>
<span id="cb75-80"><a href="#cb75-80" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_lOT_<span class="dv">80</span>_amp =<span class="st"> </span>grad_P3_lOT_<span class="dv">80</span><span class="op">$</span>P3_lOT_<span class="dv">80</span>_amp</span>
<span id="cb75-81"><a href="#cb75-81" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_lOT_<span class="dv">100</span>_amp =<span class="st"> </span>grad_P3_lOT_<span class="dv">100</span><span class="op">$</span>P3_lOT_<span class="dv">100</span>_amp</span>
<span id="cb75-82"><a href="#cb75-82" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_rOT_<span class="dv">20</span>_amp =<span class="st"> </span>grad_P3_rOT_<span class="dv">20</span><span class="op">$</span>P3_rOT_<span class="dv">20</span>_amp</span>
<span id="cb75-83"><a href="#cb75-83" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_rOT_<span class="dv">40</span>_amp =<span class="st"> </span>grad_P3_rOT_<span class="dv">40</span><span class="op">$</span>P3_rOT_<span class="dv">40</span>_amp</span>
<span id="cb75-84"><a href="#cb75-84" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_rOT_<span class="dv">60</span>_amp =<span class="st"> </span>grad_P3_rOT_<span class="dv">60</span><span class="op">$</span>P3_rOT_<span class="dv">60</span>_amp</span>
<span id="cb75-85"><a href="#cb75-85" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_rOT_<span class="dv">80</span>_amp =<span class="st"> </span>grad_P3_rOT_<span class="dv">80</span><span class="op">$</span>P3_rOT_<span class="dv">80</span>_amp</span>
<span id="cb75-86"><a href="#cb75-86" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_rOT_<span class="dv">100</span>_amp =<span class="st"> </span>grad_P3_rOT_<span class="dv">100</span><span class="op">$</span>P3_rOT_<span class="dv">100</span>_amp</span>
<span id="cb75-87"><a href="#cb75-87" aria-hidden="true"></a></span>
<span id="cb75-88"><a href="#cb75-88" aria-hidden="true"></a><span class="co"># Calculate means/SEs</span></span>
<span id="cb75-89"><a href="#cb75-89" aria-hidden="true"></a>  P3_stats =<span class="st"> </span>Av_ERP <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-90"><a href="#cb75-90" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm=</span>T), <span class="dt">n =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)), <span class="dt">se =</span> <span class="kw">sd</span>(., <span class="dt">na.rm=</span>T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)))))</span>
<span id="cb75-91"><a href="#cb75-91" aria-hidden="true"></a>  </span>
<span id="cb75-92"><a href="#cb75-92" aria-hidden="true"></a><span class="co"># Combine data into one data frame </span></span>
<span id="cb75-93"><a href="#cb75-93" aria-hidden="true"></a>  P3_av =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">intens =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>,<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>)),</span>
<span id="cb75-94"><a href="#cb75-94" aria-hidden="true"></a>                <span class="dt">roi =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>)),</span>
<span id="cb75-95"><a href="#cb75-95" aria-hidden="true"></a>                <span class="dt">amp =</span> <span class="kw">c</span>(P3_stats<span class="op">$</span>P3_lOT_<span class="dv">20</span>_amp_mean,P3_stats<span class="op">$</span>P3_lOT_<span class="dv">40</span>_amp_mean,P3_stats<span class="op">$</span>P3_lOT_<span class="dv">60</span>_amp_mean,</span>
<span id="cb75-96"><a href="#cb75-96" aria-hidden="true"></a>                        P3_stats<span class="op">$</span>P3_lOT_<span class="dv">80</span>_amp_mean,P3_stats<span class="op">$</span>P3_lOT_<span class="dv">100</span>_amp_mean,</span>
<span id="cb75-97"><a href="#cb75-97" aria-hidden="true"></a>                        P3_stats<span class="op">$</span>P3_rOT_<span class="dv">20</span>_amp_mean,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">40</span>_amp_mean,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">60</span>_amp_mean,</span>
<span id="cb75-98"><a href="#cb75-98" aria-hidden="true"></a>                        P3_stats<span class="op">$</span>P3_rOT_<span class="dv">80</span>_amp_mean,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">100</span>_amp_mean),</span>
<span id="cb75-99"><a href="#cb75-99" aria-hidden="true"></a>                <span class="dt">se =</span> <span class="kw">c</span>(P3_stats<span class="op">$</span>P3_lOT_<span class="dv">20</span>_amp_se,P3_stats<span class="op">$</span>P3_lOT_<span class="dv">40</span>_amp_se,P3_stats<span class="op">$</span>P3_lOT_<span class="dv">60</span>_amp_se,</span>
<span id="cb75-100"><a href="#cb75-100" aria-hidden="true"></a>                        P3_stats<span class="op">$</span>P3_lOT_<span class="dv">80</span>_amp_se,P3_stats<span class="op">$</span>P3_lOT_<span class="dv">100</span>_amp_se,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">20</span>_amp_se,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">40</span>_amp_se,</span>
<span id="cb75-101"><a href="#cb75-101" aria-hidden="true"></a>                        P3_stats<span class="op">$</span>P3_rOT_<span class="dv">60</span>_amp_se,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">80</span>_amp_se,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">100</span>_amp_se))</span>
<span id="cb75-102"><a href="#cb75-102" aria-hidden="true"></a>  </span>
<span id="cb75-103"><a href="#cb75-103" aria-hidden="true"></a></span>
<span id="cb75-104"><a href="#cb75-104" aria-hidden="true"></a><span class="co">###### Plotting ###### </span></span>
<span id="cb75-105"><a href="#cb75-105" aria-hidden="true"></a>  </span>
<span id="cb75-106"><a href="#cb75-106" aria-hidden="true"></a>P3_av<span class="op">$</span>roi =<span class="st"> </span><span class="kw">factor</span>(P3_av<span class="op">$</span>roi, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>))</span>
<span id="cb75-107"><a href="#cb75-107" aria-hidden="true"></a>P3_av<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(P3_av<span class="op">$</span>intens, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>))</span>
<span id="cb75-108"><a href="#cb75-108" aria-hidden="true"></a>  </span>
<span id="cb75-109"><a href="#cb75-109" aria-hidden="true"></a>    </span>
<span id="cb75-110"><a href="#cb75-110" aria-hidden="true"></a>P3_lines =<span class="st"> </span><span class="kw">ggplot</span>(P3_av, <span class="kw">aes</span>(<span class="dt">x=</span>roi, <span class="dt">y=</span>amp, <span class="dt">group=</span>intens, <span class="dt">color=</span>intens)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb75-111"><a href="#cb75-111" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>amp<span class="op">-</span>se, <span class="dt">ymax=</span>amp<span class="op">+</span>se), <span class="dt">width=</span>.<span class="dv">2</span>,<span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb75-112"><a href="#cb75-112" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb75-113"><a href="#cb75-113" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb75-114"><a href="#cb75-114" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span> <span class="kw">c</span>(<span class="st">&quot;#cceaff&quot;</span>,<span class="st">&quot;#80ccff&quot;</span>,<span class="st">&quot;#0098ff&quot;</span>,<span class="st">&quot;#005b99&quot;</span>,<span class="st">&quot;#002e4c&quot;</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb75-115"><a href="#cb75-115" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb75-116"><a href="#cb75-116" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;ROI&quot;</span>) <span class="op">+</span></span>
<span id="cb75-117"><a href="#cb75-117" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb75-118"><a href="#cb75-118" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>)) <span class="op">+</span></span>
<span id="cb75-119"><a href="#cb75-119" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">12</span>)<span class="op">+</span></span>
<span id="cb75-120"><a href="#cb75-120" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span><span class="st">&quot;none&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb75-121"><a href="#cb75-121" aria-hidden="true"></a>          <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</span>
<span id="cb75-122"><a href="#cb75-122" aria-hidden="true"></a>          <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="co"># get rid of legend bg</span></span>
<span id="cb75-123"><a href="#cb75-123" aria-hidden="true"></a>          <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb75-124"><a href="#cb75-124" aria-hidden="true"></a>          <span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">size=</span><span class="fl">0.6</span>))</span>
<span id="cb75-125"><a href="#cb75-125" aria-hidden="true"></a>  </span>
<span id="cb75-126"><a href="#cb75-126" aria-hidden="true"></a>  P3_lines</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/grad_line_P3_hap-1.png" width="192" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true"></a><span class="co"># Save plots with transparent background     </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true"></a>  <span class="kw">ggsave</span>(<span class="st">&quot;./figures/fig_grad_P3_hap_lines.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)  </span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true"></a><span class="co">###### Preparing the data ######</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true"></a>  </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true"></a><span class="co"># Average for angry lOT at 20/40/60/80/100%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">20</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">20</span> =</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true"></a><span class="st">      </span>grad_P3_lOT_<span class="dv">20</span> <span class="op">%&gt;%</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_lOT_20_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true"></a>  </span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true"></a>  </span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">40</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">40</span> =</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true"></a><span class="st">      </span>grad_P3_lOT_<span class="dv">40</span> <span class="op">%&gt;%</span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_lOT_40_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true"></a>  </span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true"></a>  </span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">60</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">60</span> =</span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true"></a><span class="st">      </span>grad_P3_lOT_<span class="dv">60</span> <span class="op">%&gt;%</span></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_lOT_60_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true"></a>  </span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true"></a>  </span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">80</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">80</span> =</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true"></a><span class="st">      </span>grad_P3_lOT_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_lOT_80_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true"></a>  </span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true"></a>  </span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">100</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true"></a>  grad_P3_lOT_<span class="dv">100</span> =</span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true"></a><span class="st">      </span>grad_P3_lOT_<span class="dv">100</span> <span class="op">%&gt;%</span></span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_lOT_100_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true"></a>  </span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true"></a>  </span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true"></a><span class="co"># Average for angry rOT at 20/40/60/80/100%</span></span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">20</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;20%&quot;</span>)</span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">20</span> =</span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true"></a><span class="st">      </span>grad_P3_rOT_<span class="dv">20</span> <span class="op">%&gt;%</span></span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_rOT_20_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true"></a>  </span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true"></a>  </span>
<span id="cb77-47"><a href="#cb77-47" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">40</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;40%&quot;</span>)</span>
<span id="cb77-48"><a href="#cb77-48" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">40</span> =</span>
<span id="cb77-49"><a href="#cb77-49" aria-hidden="true"></a><span class="st">      </span>grad_P3_rOT_<span class="dv">40</span> <span class="op">%&gt;%</span></span>
<span id="cb77-50"><a href="#cb77-50" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb77-51"><a href="#cb77-51" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_rOT_40_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb77-52"><a href="#cb77-52" aria-hidden="true"></a>  </span>
<span id="cb77-53"><a href="#cb77-53" aria-hidden="true"></a>  </span>
<span id="cb77-54"><a href="#cb77-54" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">60</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;60%&quot;</span>)</span>
<span id="cb77-55"><a href="#cb77-55" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">60</span> =</span>
<span id="cb77-56"><a href="#cb77-56" aria-hidden="true"></a><span class="st">      </span>grad_P3_rOT_<span class="dv">60</span> <span class="op">%&gt;%</span></span>
<span id="cb77-57"><a href="#cb77-57" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb77-58"><a href="#cb77-58" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_rOT_60_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb77-59"><a href="#cb77-59" aria-hidden="true"></a>  </span>
<span id="cb77-60"><a href="#cb77-60" aria-hidden="true"></a>  </span>
<span id="cb77-61"><a href="#cb77-61" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">80</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;80%&quot;</span>)</span>
<span id="cb77-62"><a href="#cb77-62" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">80</span> =</span>
<span id="cb77-63"><a href="#cb77-63" aria-hidden="true"></a><span class="st">      </span>grad_P3_rOT_<span class="dv">80</span> <span class="op">%&gt;%</span></span>
<span id="cb77-64"><a href="#cb77-64" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb77-65"><a href="#cb77-65" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_rOT_80_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  </span>
<span id="cb77-66"><a href="#cb77-66" aria-hidden="true"></a>  </span>
<span id="cb77-67"><a href="#cb77-67" aria-hidden="true"></a>  </span>
<span id="cb77-68"><a href="#cb77-68" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">100</span> =<span class="st"> </span><span class="kw">subset</span>(grad_P3, emotion <span class="op">==</span><span class="st"> &quot;angry&quot;</span> <span class="op">&amp;</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>  <span class="op">&amp;</span><span class="st"> </span>intens <span class="op">==</span><span class="st"> &quot;100%&quot;</span>)</span>
<span id="cb77-69"><a href="#cb77-69" aria-hidden="true"></a>  grad_P3_rOT_<span class="dv">100</span> =</span>
<span id="cb77-70"><a href="#cb77-70" aria-hidden="true"></a><span class="st">      </span>grad_P3_rOT_<span class="dv">100</span> <span class="op">%&gt;%</span></span>
<span id="cb77-71"><a href="#cb77-71" aria-hidden="true"></a><span class="st">      </span><span class="kw">group_by</span>(ID) <span class="op">%&gt;%</span></span>
<span id="cb77-72"><a href="#cb77-72" aria-hidden="true"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">P3_rOT_100_amp =</span> <span class="kw">mean</span>(amp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))    </span>
<span id="cb77-73"><a href="#cb77-73" aria-hidden="true"></a>    </span>
<span id="cb77-74"><a href="#cb77-74" aria-hidden="true"></a>  </span>
<span id="cb77-75"><a href="#cb77-75" aria-hidden="true"></a><span class="co"># Averages from P3</span></span>
<span id="cb77-76"><a href="#cb77-76" aria-hidden="true"></a>  Av_ERP =<span class="st"> </span><span class="kw">as.data.frame</span>(grad_P3_lOT_<span class="dv">20</span><span class="op">$</span>P3_lOT_<span class="dv">20</span>_amp)</span>
<span id="cb77-77"><a href="#cb77-77" aria-hidden="true"></a>  <span class="kw">names</span>(Av_ERP)[<span class="kw">names</span>(Av_ERP) <span class="op">==</span><span class="st"> &#39;grad_P3_lOT_20$P3_lOT_20_amp&#39;</span>] =<span class="st"> &#39;P3_lOT_20_amp&#39;</span></span>
<span id="cb77-78"><a href="#cb77-78" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_lOT_<span class="dv">40</span>_amp =<span class="st"> </span>grad_P3_lOT_<span class="dv">40</span><span class="op">$</span>P3_lOT_<span class="dv">40</span>_amp</span>
<span id="cb77-79"><a href="#cb77-79" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_lOT_<span class="dv">60</span>_amp =<span class="st"> </span>grad_P3_lOT_<span class="dv">60</span><span class="op">$</span>P3_lOT_<span class="dv">60</span>_amp</span>
<span id="cb77-80"><a href="#cb77-80" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_lOT_<span class="dv">80</span>_amp =<span class="st"> </span>grad_P3_lOT_<span class="dv">80</span><span class="op">$</span>P3_lOT_<span class="dv">80</span>_amp</span>
<span id="cb77-81"><a href="#cb77-81" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_lOT_<span class="dv">100</span>_amp =<span class="st"> </span>grad_P3_lOT_<span class="dv">100</span><span class="op">$</span>P3_lOT_<span class="dv">100</span>_amp</span>
<span id="cb77-82"><a href="#cb77-82" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_rOT_<span class="dv">20</span>_amp =<span class="st"> </span>grad_P3_rOT_<span class="dv">20</span><span class="op">$</span>P3_rOT_<span class="dv">20</span>_amp</span>
<span id="cb77-83"><a href="#cb77-83" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_rOT_<span class="dv">40</span>_amp =<span class="st"> </span>grad_P3_rOT_<span class="dv">40</span><span class="op">$</span>P3_rOT_<span class="dv">40</span>_amp</span>
<span id="cb77-84"><a href="#cb77-84" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_rOT_<span class="dv">60</span>_amp =<span class="st"> </span>grad_P3_rOT_<span class="dv">60</span><span class="op">$</span>P3_rOT_<span class="dv">60</span>_amp</span>
<span id="cb77-85"><a href="#cb77-85" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_rOT_<span class="dv">80</span>_amp =<span class="st"> </span>grad_P3_rOT_<span class="dv">80</span><span class="op">$</span>P3_rOT_<span class="dv">80</span>_amp</span>
<span id="cb77-86"><a href="#cb77-86" aria-hidden="true"></a>  Av_ERP<span class="op">$</span>P3_rOT_<span class="dv">100</span>_amp =<span class="st"> </span>grad_P3_rOT_<span class="dv">100</span><span class="op">$</span>P3_rOT_<span class="dv">100</span>_amp</span>
<span id="cb77-87"><a href="#cb77-87" aria-hidden="true"></a></span>
<span id="cb77-88"><a href="#cb77-88" aria-hidden="true"></a><span class="co"># Calculate means/SEs</span></span>
<span id="cb77-89"><a href="#cb77-89" aria-hidden="true"></a>  P3_stats =<span class="st"> </span>Av_ERP <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb77-90"><a href="#cb77-90" aria-hidden="true"></a><span class="st">  </span><span class="kw">summarise_each</span>(<span class="kw">funs</span>(<span class="kw">mean</span>(., <span class="dt">na.rm=</span>T), <span class="dt">n =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)), <span class="dt">se =</span> <span class="kw">sd</span>(., <span class="dt">na.rm=</span>T)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(.)))))</span>
<span id="cb77-91"><a href="#cb77-91" aria-hidden="true"></a>  </span>
<span id="cb77-92"><a href="#cb77-92" aria-hidden="true"></a><span class="co"># Combine data into one data frame </span></span>
<span id="cb77-93"><a href="#cb77-93" aria-hidden="true"></a>  P3_av =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">intens =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>,<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>)),</span>
<span id="cb77-94"><a href="#cb77-94" aria-hidden="true"></a>                <span class="dt">roi =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>)),</span>
<span id="cb77-95"><a href="#cb77-95" aria-hidden="true"></a>                <span class="dt">amp =</span> <span class="kw">c</span>(P3_stats<span class="op">$</span>P3_lOT_<span class="dv">20</span>_amp_mean,P3_stats<span class="op">$</span>P3_lOT_<span class="dv">40</span>_amp_mean,P3_stats<span class="op">$</span>P3_lOT_<span class="dv">60</span>_amp_mean,</span>
<span id="cb77-96"><a href="#cb77-96" aria-hidden="true"></a>                        P3_stats<span class="op">$</span>P3_lOT_<span class="dv">80</span>_amp_mean,P3_stats<span class="op">$</span>P3_lOT_<span class="dv">100</span>_amp_mean,</span>
<span id="cb77-97"><a href="#cb77-97" aria-hidden="true"></a>                        P3_stats<span class="op">$</span>P3_rOT_<span class="dv">20</span>_amp_mean,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">40</span>_amp_mean,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">60</span>_amp_mean,</span>
<span id="cb77-98"><a href="#cb77-98" aria-hidden="true"></a>                        P3_stats<span class="op">$</span>P3_rOT_<span class="dv">80</span>_amp_mean,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">100</span>_amp_mean),</span>
<span id="cb77-99"><a href="#cb77-99" aria-hidden="true"></a>                <span class="dt">se =</span> <span class="kw">c</span>(P3_stats<span class="op">$</span>P3_lOT_<span class="dv">20</span>_amp_se,P3_stats<span class="op">$</span>P3_lOT_<span class="dv">40</span>_amp_se,P3_stats<span class="op">$</span>P3_lOT_<span class="dv">60</span>_amp_se,</span>
<span id="cb77-100"><a href="#cb77-100" aria-hidden="true"></a>                        P3_stats<span class="op">$</span>P3_lOT_<span class="dv">80</span>_amp_se,P3_stats<span class="op">$</span>P3_lOT_<span class="dv">100</span>_amp_se,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">20</span>_amp_se,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">40</span>_amp_se,</span>
<span id="cb77-101"><a href="#cb77-101" aria-hidden="true"></a>                        P3_stats<span class="op">$</span>P3_rOT_<span class="dv">60</span>_amp_se,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">80</span>_amp_se,P3_stats<span class="op">$</span>P3_rOT_<span class="dv">100</span>_amp_se))</span>
<span id="cb77-102"><a href="#cb77-102" aria-hidden="true"></a>  </span>
<span id="cb77-103"><a href="#cb77-103" aria-hidden="true"></a></span>
<span id="cb77-104"><a href="#cb77-104" aria-hidden="true"></a><span class="co">###### Plotting ###### </span></span>
<span id="cb77-105"><a href="#cb77-105" aria-hidden="true"></a>  </span>
<span id="cb77-106"><a href="#cb77-106" aria-hidden="true"></a>P3_av<span class="op">$</span>roi =<span class="st"> </span><span class="kw">factor</span>(P3_av<span class="op">$</span>roi, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;lOT&quot;</span>,<span class="st">&quot;rOT&quot;</span>))</span>
<span id="cb77-107"><a href="#cb77-107" aria-hidden="true"></a>P3_av<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(P3_av<span class="op">$</span>intens, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>,<span class="st">&quot;40%&quot;</span>,<span class="st">&quot;60%&quot;</span>,<span class="st">&quot;80%&quot;</span>,<span class="st">&quot;100%&quot;</span>))</span>
<span id="cb77-108"><a href="#cb77-108" aria-hidden="true"></a>  </span>
<span id="cb77-109"><a href="#cb77-109" aria-hidden="true"></a>    </span>
<span id="cb77-110"><a href="#cb77-110" aria-hidden="true"></a>P3_lines =<span class="st"> </span><span class="kw">ggplot</span>(P3_av, <span class="kw">aes</span>(<span class="dt">x=</span>roi, <span class="dt">y=</span>amp, <span class="dt">group=</span>intens, <span class="dt">color=</span>intens)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb77-111"><a href="#cb77-111" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>amp<span class="op">-</span>se, <span class="dt">ymax=</span>amp<span class="op">+</span>se), <span class="dt">width=</span>.<span class="dv">2</span>,<span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="fl">0.05</span>), <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb77-112"><a href="#cb77-112" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb77-113"><a href="#cb77-113" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb77-114"><a href="#cb77-114" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span> <span class="kw">c</span>(<span class="st">&quot;gray88&quot;</span>,<span class="st">&quot;gray82&quot;</span>,<span class="st">&quot;gray60&quot;</span>,<span class="st">&quot;gray44&quot;</span>,<span class="st">&quot;gray8&quot;</span>))<span class="op">+</span><span class="st"> </span></span>
<span id="cb77-115"><a href="#cb77-115" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb77-116"><a href="#cb77-116" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;ROI&quot;</span>) <span class="op">+</span></span>
<span id="cb77-117"><a href="#cb77-117" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">1</span>))<span class="op">+</span></span>
<span id="cb77-118"><a href="#cb77-118" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>)) <span class="op">+</span></span>
<span id="cb77-119"><a href="#cb77-119" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">12</span>)<span class="op">+</span></span>
<span id="cb77-120"><a href="#cb77-120" aria-hidden="true"></a><span class="st">          </span><span class="kw">theme</span>(<span class="dt">legend.position =</span><span class="st">&quot;none&quot;</span>, <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb77-121"><a href="#cb77-121" aria-hidden="true"></a>          <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</span>
<span id="cb77-122"><a href="#cb77-122" aria-hidden="true"></a>          <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>), <span class="co"># get rid of legend bg</span></span>
<span id="cb77-123"><a href="#cb77-123" aria-hidden="true"></a>          <span class="dt">legend.box.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</span>
<span id="cb77-124"><a href="#cb77-124" aria-hidden="true"></a>          <span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">size=</span><span class="fl">0.6</span>))</span>
<span id="cb77-125"><a href="#cb77-125" aria-hidden="true"></a>  </span>
<span id="cb77-126"><a href="#cb77-126" aria-hidden="true"></a>  P3_lines</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/grad_line_P3_ang-1.png" width="192" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true"></a><span class="co"># Save plots with transparent background     </span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true"></a>  <span class="kw">ggsave</span>(<span class="st">&quot;./figures/fig_grad_P3_ang_lines.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)  </span></code></pre></div>
</div>
</div>
<div id="single-trial-analyses" class="section level2 tabset tabset-pills">
<h2 class="tabset tabset-pills">Single-trial analyses</h2>
<div id="c1-wo-mo" class="section level3">
<h3>C1 wo MO</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true"></a><span class="co"># Select cluster of interest</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true"></a>grad_P1 =<span class="st"> </span><span class="kw">subset</span>(grad_P1, ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span> <span class="op">|</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true"></a>grad_P1<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(grad_P1<span class="op">$</span>ID)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true"></a>grad_P1<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(grad_P1<span class="op">$</span>emotion)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true"></a>grad_P1<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(grad_P1<span class="op">$</span>group)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true"></a>grad_P1<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(grad_P1<span class="op">$</span>intens, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true"></a>grad_P1<span class="op">$</span>ROI =<span class="st"> </span><span class="kw">factor</span>(grad_P1<span class="op">$</span>ROI)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true"></a></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true"></a><span class="co"># Define effect treatment contrasts</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P1<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P1<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P1<span class="op">$</span>ROI) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P1<span class="op">$</span>intens) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">5</span>)</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true"></a></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true"></a>mod_P1 =<span class="st"> </span><span class="kw">lmer</span>(amp <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_P1, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true"></a></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true"></a>mod_P1_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_P1)</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true"></a>mod_P1_res =<span class="st"> </span><span class="kw">subset</span>(mod_P1_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, etasq, omegasq, </span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true"></a>    partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true"></a>mod_P1_res =<span class="st"> </span><span class="kw">head</span>(mod_P1_res, <span class="dv">-1</span>)</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_P1_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">124877</td>
<td align="right">3.05</td>
<td align="right">0.08</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">124868</td>
<td align="right">7.72</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">group</td>
<td align="right">1</td>
<td align="right">42</td>
<td align="right">0.20</td>
<td align="right">0.66</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">0.06</td>
<td align="right">0.80</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens</td>
<td align="right">4</td>
<td align="right">124873</td>
<td align="right">1.05</td>
<td align="right">0.38</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:group</td>
<td align="right">1</td>
<td align="right">124877</td>
<td align="right">0.79</td>
<td align="right">0.37</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens:group</td>
<td align="right">4</td>
<td align="right">124868</td>
<td align="right">3.01</td>
<td align="right">0.02</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">0.19</td>
<td align="right">0.66</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.33</td>
<td align="right">0.25</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">group:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">10.51</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group</td>
<td align="right">4</td>
<td align="right">124873</td>
<td align="right">3.44</td>
<td align="right">0.01</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">0.71</td>
<td align="right">0.58</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:group:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">0.50</td>
<td align="right">0.48</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens:group:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.41</td>
<td align="right">0.23</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">2.99</td>
<td align="right">0.02</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true"></a><span class="co"># Post-hoc tests</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true"></a>m.roi =<span class="st"> </span><span class="kw">emmeans</span>(mod_P1, <span class="st">&quot;ROI&quot;</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true"></a>ROI =<span class="st"> </span><span class="kw">contrast</span>(m.roi, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(ROI, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ROI</td>
<td align="left">lOT - rOT</td>
<td align="right">0</td>
<td align="right">-0.03</td>
<td align="right">0.11</td>
<td align="right">Inf</td>
<td align="right">-0.25</td>
<td align="right">0.8</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_P1, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true"></a>poly_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;poly&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(poly_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">linear</td>
<td align="right">0</td>
<td align="right">1.70</td>
<td align="right">0.38</td>
<td align="right">Inf</td>
<td align="right">4.52</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">quadratic</td>
<td align="right">0</td>
<td align="right">0.40</td>
<td align="right">0.45</td>
<td align="right">Inf</td>
<td align="right">0.89</td>
<td align="right">0.37</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">cubic</td>
<td align="right">0</td>
<td align="right">0.68</td>
<td align="right">0.38</td>
<td align="right">Inf</td>
<td align="right">1.81</td>
<td align="right">0.07</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_P1, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true"></a>intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 40%</td>
<td align="right">0</td>
<td align="right">-0.48</td>
<td align="right">0.17</td>
<td align="right">Inf</td>
<td align="right">-2.85</td>
<td align="right">0.04</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 60%</td>
<td align="right">0</td>
<td align="right">-0.10</td>
<td align="right">0.17</td>
<td align="right">Inf</td>
<td align="right">-0.60</td>
<td align="right">0.98</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 80%</td>
<td align="right">0</td>
<td align="right">-0.55</td>
<td align="right">0.17</td>
<td align="right">Inf</td>
<td align="right">-3.27</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 100%</td>
<td align="right">0</td>
<td align="right">-0.82</td>
<td align="right">0.17</td>
<td align="right">Inf</td>
<td align="right">-4.86</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">40% - 60%</td>
<td align="right">0</td>
<td align="right">0.38</td>
<td align="right">0.17</td>
<td align="right">Inf</td>
<td align="right">2.23</td>
<td align="right">0.17</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">40% - 80%</td>
<td align="right">0</td>
<td align="right">-0.07</td>
<td align="right">0.17</td>
<td align="right">Inf</td>
<td align="right">-0.39</td>
<td align="right">0.99</td>
</tr>
</tbody>
</table>
<p><em>lOT</em></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true"></a><span class="co"># Select lOT</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true"></a>grad_P1_lOT =<span class="st"> </span><span class="kw">subset</span>(grad_P1, ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true"></a>mod_P1_lOT =<span class="st"> </span><span class="kw">lmer</span>(amp <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_P1_lOT, </span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true"></a>mod_P1_lOT_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_P1_lOT)</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true"></a>mod_P1_lOT_res =<span class="st"> </span><span class="kw">subset</span>(mod_P1_lOT_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, etasq, </span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true"></a>    omegasq, partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true"></a>mod_P1_lOT_res =<span class="st"> </span><span class="kw">head</span>(mod_P1_lOT_res, <span class="dv">-1</span>)</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_P1_lOT_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">62428</td>
<td align="right">0.81</td>
<td align="right">0.37</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">62419</td>
<td align="right">5.14</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">group</td>
<td align="right">1</td>
<td align="right">41</td>
<td align="right">0.20</td>
<td align="right">0.66</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens</td>
<td align="right">4</td>
<td align="right">62425</td>
<td align="right">0.89</td>
<td align="right">0.47</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:group</td>
<td align="right">1</td>
<td align="right">62428</td>
<td align="right">1.29</td>
<td align="right">0.26</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens:group</td>
<td align="right">4</td>
<td align="right">62419</td>
<td align="right">2.16</td>
<td align="right">0.07</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group</td>
<td align="right">4</td>
<td align="right">62425</td>
<td align="right">3.96</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true"></a>int_mod_int =<span class="st"> </span><span class="kw">emmip</span>(mod_P1_lOT, group <span class="op">~</span><span class="st"> </span>intens <span class="op">|</span><span class="st"> </span>emotion, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#333333&quot;</span>, </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true"></a>    <span class="st">&quot;#D97909&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true"></a></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true"></a>int_mod_int</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_P1_lOT_wo_MO-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_P1_lOT_group_emo_intens.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_P1_lOT, pairwise <span class="op">~</span><span class="st"> </span>group <span class="op">|</span><span class="st"> </span>intens <span class="op">|</span><span class="st"> </span>emotion)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">intens</th>
<th align="left">emotion</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">20%</td>
<td align="left">angry</td>
<td align="right">0.21</td>
<td align="right">0.60</td>
<td align="right">Inf</td>
<td align="right">0.36</td>
<td align="right">0.72</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">40%</td>
<td align="left">angry</td>
<td align="right">0.36</td>
<td align="right">0.61</td>
<td align="right">Inf</td>
<td align="right">0.58</td>
<td align="right">0.56</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">60%</td>
<td align="left">angry</td>
<td align="right">-1.08</td>
<td align="right">0.61</td>
<td align="right">Inf</td>
<td align="right">-1.78</td>
<td align="right">0.08</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">80%</td>
<td align="left">angry</td>
<td align="right">-0.94</td>
<td align="right">0.61</td>
<td align="right">Inf</td>
<td align="right">-1.55</td>
<td align="right">0.12</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">100%</td>
<td align="left">angry</td>
<td align="right">1.46</td>
<td align="right">0.60</td>
<td align="right">Inf</td>
<td align="right">2.45</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">20%</td>
<td align="left">happy</td>
<td align="right">-0.65</td>
<td align="right">0.61</td>
<td align="right">Inf</td>
<td align="right">-1.07</td>
<td align="right">0.29</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">40%</td>
<td align="left">happy</td>
<td align="right">0.41</td>
<td align="right">0.61</td>
<td align="right">Inf</td>
<td align="right">0.67</td>
<td align="right">0.50</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">60%</td>
<td align="left">happy</td>
<td align="right">0.81</td>
<td align="right">0.62</td>
<td align="right">Inf</td>
<td align="right">1.31</td>
<td align="right">0.19</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">80%</td>
<td align="left">happy</td>
<td align="right">0.71</td>
<td align="right">0.60</td>
<td align="right">Inf</td>
<td align="right">1.18</td>
<td align="right">0.24</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">100%</td>
<td align="left">happy</td>
<td align="right">0.47</td>
<td align="right">0.61</td>
<td align="right">Inf</td>
<td align="right">0.77</td>
<td align="right">0.44</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_P1_lOT, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true"></a>poly_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;poly&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(poly_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">linear</td>
<td align="right">0</td>
<td align="right">2.17</td>
<td align="right">0.54</td>
<td align="right">Inf</td>
<td align="right">4.04</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">quadratic</td>
<td align="right">0</td>
<td align="right">0.94</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">1.46</td>
<td align="right">0.14</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">cubic</td>
<td align="right">0</td>
<td align="right">0.15</td>
<td align="right">0.54</td>
<td align="right">Inf</td>
<td align="right">0.28</td>
<td align="right">0.78</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_P1_lOT, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true"></a>intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 40%</td>
<td align="right">0</td>
<td align="right">-0.21</td>
<td align="right">0.24</td>
<td align="right">Inf</td>
<td align="right">-0.87</td>
<td align="right">0.91</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 60%</td>
<td align="right">0</td>
<td align="right">-0.04</td>
<td align="right">0.24</td>
<td align="right">Inf</td>
<td align="right">-0.15</td>
<td align="right">1.00</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 80%</td>
<td align="right">0</td>
<td align="right">-0.58</td>
<td align="right">0.24</td>
<td align="right">Inf</td>
<td align="right">-2.43</td>
<td align="right">0.11</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 100%</td>
<td align="right">0</td>
<td align="right">-0.90</td>
<td align="right">0.24</td>
<td align="right">Inf</td>
<td align="right">-3.75</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">40% - 60%</td>
<td align="right">0</td>
<td align="right">0.17</td>
<td align="right">0.24</td>
<td align="right">Inf</td>
<td align="right">0.71</td>
<td align="right">0.95</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">40% - 80%</td>
<td align="right">0</td>
<td align="right">-0.37</td>
<td align="right">0.24</td>
<td align="right">Inf</td>
<td align="right">-1.54</td>
<td align="right">0.54</td>
</tr>
</tbody>
</table>
<p><em>rOT</em></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true"></a><span class="co"># Select rOT</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true"></a>grad_P1_rOT =<span class="st"> </span><span class="kw">subset</span>(grad_P1, ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true"></a></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true"></a>mod_P1_rOT =<span class="st"> </span><span class="kw">lmer</span>(amp <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_P1_rOT, </span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true"></a></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true"></a>mod_P1_rOT_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_P1_rOT)</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true"></a>mod_P1_rOT_res =<span class="st"> </span><span class="kw">subset</span>(mod_P1_rOT_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, etasq, </span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true"></a>    omegasq, partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true"></a>mod_P1_rOT_res =<span class="st"> </span><span class="kw">head</span>(mod_P1_rOT_res, <span class="dv">-1</span>)</span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_P1_rOT_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">62428</td>
<td align="right">2.47</td>
<td align="right">0.12</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">62420</td>
<td align="right">4.08</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">group</td>
<td align="right">1</td>
<td align="right">42</td>
<td align="right">1.54</td>
<td align="right">0.22</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens</td>
<td align="right">4</td>
<td align="right">62425</td>
<td align="right">0.77</td>
<td align="right">0.55</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:group</td>
<td align="right">1</td>
<td align="right">62428</td>
<td align="right">0.01</td>
<td align="right">0.93</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens:group</td>
<td align="right">4</td>
<td align="right">62420</td>
<td align="right">2.16</td>
<td align="right">0.07</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group</td>
<td align="right">4</td>
<td align="right">62425</td>
<td align="right">2.35</td>
<td align="right">0.05</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_P1_rOT, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true"></a>main_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true"></a></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(main_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 40%</td>
<td align="right">0</td>
<td align="right">-0.75</td>
<td align="right">0.24</td>
<td align="right">Inf</td>
<td align="right">-3.18</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 60%</td>
<td align="right">0</td>
<td align="right">-0.17</td>
<td align="right">0.24</td>
<td align="right">Inf</td>
<td align="right">-0.71</td>
<td align="right">0.96</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 80%</td>
<td align="right">0</td>
<td align="right">-0.52</td>
<td align="right">0.24</td>
<td align="right">Inf</td>
<td align="right">-2.19</td>
<td align="right">0.18</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 100%</td>
<td align="right">0</td>
<td align="right">-0.73</td>
<td align="right">0.24</td>
<td align="right">Inf</td>
<td align="right">-3.12</td>
<td align="right">0.02</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">40% - 60%</td>
<td align="right">0</td>
<td align="right">0.59</td>
<td align="right">0.24</td>
<td align="right">Inf</td>
<td align="right">2.45</td>
<td align="right">0.10</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">40% - 80%</td>
<td align="right">0</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">Inf</td>
<td align="right">1.00</td>
<td align="right">0.86</td>
</tr>
</tbody>
</table>
</div>
<div id="c2-wo-mo" class="section level3">
<h3>C2 wo MO</h3>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true"></a><span class="co"># Select cluster of interest</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true"></a>grad_N170 =<span class="st"> </span><span class="kw">subset</span>(grad_N170, ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span> <span class="op">|</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true"></a>grad_N170<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(grad_N170<span class="op">$</span>ID)</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true"></a>grad_N170<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(grad_N170<span class="op">$</span>emotion)</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true"></a>grad_N170<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(grad_N170<span class="op">$</span>group)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true"></a>grad_N170<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(grad_N170<span class="op">$</span>intens, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>, </span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true"></a>    <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true"></a>grad_N170<span class="op">$</span>ROI =<span class="st"> </span><span class="kw">factor</span>(grad_N170<span class="op">$</span>ROI)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true"></a></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true"></a><span class="co"># Define effect treatment contrasts</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_N170<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_N170<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_N170<span class="op">$</span>ROI) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_N170<span class="op">$</span>intens) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">5</span>)</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true"></a></span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true"></a>mod_N170 =<span class="st"> </span><span class="kw">lmer</span>(amp <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_N170, </span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true"></a></span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true"></a>mod_N170_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_N170)</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true"></a>mod_N170_res =<span class="st"> </span><span class="kw">subset</span>(mod_N170_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, etasq, omegasq, </span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true"></a>    partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true"></a>mod_N170_res =<span class="st"> </span><span class="kw">head</span>(mod_N170_res, <span class="dv">-1</span>)</span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_N170_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">124875</td>
<td align="right">112.58</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">124866</td>
<td align="right">3.81</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">group</td>
<td align="right">1</td>
<td align="right">42</td>
<td align="right">0.09</td>
<td align="right">0.77</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">1.24</td>
<td align="right">0.26</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens</td>
<td align="right">4</td>
<td align="right">124872</td>
<td align="right">6.16</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:group</td>
<td align="right">1</td>
<td align="right">124875</td>
<td align="right">11.90</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens:group</td>
<td align="right">4</td>
<td align="right">124866</td>
<td align="right">5.48</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">0.01</td>
<td align="right">0.92</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">2.21</td>
<td align="right">0.06</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">group:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">2.62</td>
<td align="right">0.11</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group</td>
<td align="right">4</td>
<td align="right">124872</td>
<td align="right">1.03</td>
<td align="right">0.39</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.22</td>
<td align="right">0.30</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:group:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">2.06</td>
<td align="right">0.15</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens:group:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">2.43</td>
<td align="right">0.04</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.31</td>
<td align="right">0.26</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_N170, pairwise <span class="op">~</span><span class="st"> </span>emotion <span class="op">|</span><span class="st"> </span>intens)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">intens</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">20%</td>
<td align="right">0.45</td>
<td align="right">0.26</td>
<td align="right">Inf</td>
<td align="right">1.7</td>
<td align="right">0.09</td>
</tr>
<tr class="even">
<td align="left">angry - happy</td>
<td align="left">40%</td>
<td align="right">0.98</td>
<td align="right">0.27</td>
<td align="right">Inf</td>
<td align="right">3.7</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">60%</td>
<td align="right">1.02</td>
<td align="right">0.27</td>
<td align="right">Inf</td>
<td align="right">3.8</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">angry - happy</td>
<td align="left">80%</td>
<td align="right">2.08</td>
<td align="right">0.26</td>
<td align="right">Inf</td>
<td align="right">7.9</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">100%</td>
<td align="right">1.74</td>
<td align="right">0.26</td>
<td align="right">Inf</td>
<td align="right">6.6</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true"></a>int_emo =<span class="st"> </span><span class="kw">emmip</span>(mod_N170, emotion <span class="op">~</span><span class="st"> </span>intens, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#333333&quot;</span>, </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true"></a>    <span class="st">&quot;#0098ff&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true"></a>int_emo</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_N170_wo_MO-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_N170_emo_intens.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_N170, pairwise <span class="op">~</span><span class="st"> </span>group <span class="op">|</span><span class="st"> </span>emotion)</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">emotion</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">angry</td>
<td align="right">0.29</td>
<td align="right">0.42</td>
<td align="right">Inf</td>
<td align="right">0.69</td>
<td align="right">0.49</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">happy</td>
<td align="right">-0.53</td>
<td align="right">0.42</td>
<td align="right">Inf</td>
<td align="right">-1.25</td>
<td align="right">0.21</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true"></a>gr_emo =<span class="st"> </span><span class="kw">emmip</span>(mod_N170, group <span class="op">~</span><span class="st"> </span>emotion, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#333333&quot;</span>, </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true"></a>    <span class="st">&quot;#0098ff&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true"></a>gr_emo</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_N170_wo_MO-2.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_N170_emo_group.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_N170, pairwise <span class="op">~</span><span class="st"> </span>group <span class="op">|</span><span class="st"> </span>intens)</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">intens</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">20%</td>
<td align="right">-0.39</td>
<td align="right">0.46</td>
<td align="right">Inf</td>
<td align="right">-0.85</td>
<td align="right">0.40</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">40%</td>
<td align="right">0.27</td>
<td align="right">0.47</td>
<td align="right">Inf</td>
<td align="right">0.57</td>
<td align="right">0.57</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">60%</td>
<td align="right">-0.93</td>
<td align="right">0.47</td>
<td align="right">Inf</td>
<td align="right">-1.99</td>
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">80%</td>
<td align="right">-0.21</td>
<td align="right">0.47</td>
<td align="right">Inf</td>
<td align="right">-0.46</td>
<td align="right">0.65</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">100%</td>
<td align="right">0.68</td>
<td align="right">0.47</td>
<td align="right">Inf</td>
<td align="right">1.47</td>
<td align="right">0.14</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true"></a>gr_int =<span class="st"> </span><span class="kw">emmip</span>(mod_N170, group <span class="op">~</span><span class="st"> </span>intens, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#333333&quot;</span>, </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true"></a>    <span class="st">&quot;#D97909&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true"></a>gr_int</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_N170_wo_MO-3.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_N170_int_group.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true"></a></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_N170, pairwise <span class="op">~</span><span class="st"> </span>group <span class="op">|</span><span class="st"> </span>intens <span class="op">|</span><span class="st"> </span>ROI)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">intens</th>
<th align="left">ROI</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">20%</td>
<td align="left">lOT</td>
<td align="right">-0.79</td>
<td align="right">0.53</td>
<td align="right">Inf</td>
<td align="right">-1.49</td>
<td align="right">0.14</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">40%</td>
<td align="left">lOT</td>
<td align="right">0.43</td>
<td align="right">0.54</td>
<td align="right">Inf</td>
<td align="right">0.80</td>
<td align="right">0.43</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">60%</td>
<td align="left">lOT</td>
<td align="right">-0.26</td>
<td align="right">0.54</td>
<td align="right">Inf</td>
<td align="right">-0.48</td>
<td align="right">0.63</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">80%</td>
<td align="left">lOT</td>
<td align="right">0.26</td>
<td align="right">0.53</td>
<td align="right">Inf</td>
<td align="right">0.48</td>
<td align="right">0.63</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">100%</td>
<td align="left">lOT</td>
<td align="right">0.74</td>
<td align="right">0.53</td>
<td align="right">Inf</td>
<td align="right">1.38</td>
<td align="right">0.17</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">20%</td>
<td align="left">rOT</td>
<td align="right">0.01</td>
<td align="right">0.53</td>
<td align="right">Inf</td>
<td align="right">0.01</td>
<td align="right">0.99</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">40%</td>
<td align="left">rOT</td>
<td align="right">0.11</td>
<td align="right">0.54</td>
<td align="right">Inf</td>
<td align="right">0.20</td>
<td align="right">0.84</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">60%</td>
<td align="left">rOT</td>
<td align="right">-1.60</td>
<td align="right">0.54</td>
<td align="right">Inf</td>
<td align="right">-2.97</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">80%</td>
<td align="left">rOT</td>
<td align="right">-0.68</td>
<td align="right">0.53</td>
<td align="right">Inf</td>
<td align="right">-1.27</td>
<td align="right">0.20</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">100%</td>
<td align="left">rOT</td>
<td align="right">0.63</td>
<td align="right">0.53</td>
<td align="right">Inf</td>
<td align="right">1.18</td>
<td align="right">0.24</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_N170, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true"></a>main_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true"></a></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(main_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 40%</td>
<td align="right">0</td>
<td align="right">-0.07</td>
<td align="right">0.19</td>
<td align="right">Inf</td>
<td align="right">-0.36</td>
<td align="right">1.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 60%</td>
<td align="right">0</td>
<td align="right">0.45</td>
<td align="right">0.19</td>
<td align="right">Inf</td>
<td align="right">2.41</td>
<td align="right">0.11</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 80%</td>
<td align="right">0</td>
<td align="right">0.48</td>
<td align="right">0.19</td>
<td align="right">Inf</td>
<td align="right">2.59</td>
<td align="right">0.07</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 100%</td>
<td align="right">0</td>
<td align="right">0.37</td>
<td align="right">0.19</td>
<td align="right">Inf</td>
<td align="right">2.00</td>
<td align="right">0.26</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">40% - 60%</td>
<td align="right">0</td>
<td align="right">0.52</td>
<td align="right">0.19</td>
<td align="right">Inf</td>
<td align="right">2.74</td>
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">40% - 80%</td>
<td align="right">0</td>
<td align="right">0.55</td>
<td align="right">0.19</td>
<td align="right">Inf</td>
<td align="right">2.93</td>
<td align="right">0.03</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_N170, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true"></a>poly_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;poly&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(poly_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">linear</td>
<td align="right">0</td>
<td align="right">-1.29</td>
<td align="right">0.42</td>
<td align="right">Inf</td>
<td align="right">-3.1</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">quadratic</td>
<td align="right">0</td>
<td align="right">0.57</td>
<td align="right">0.49</td>
<td align="right">Inf</td>
<td align="right">1.2</td>
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">cubic</td>
<td align="right">0</td>
<td align="right">0.72</td>
<td align="right">0.42</td>
<td align="right">Inf</td>
<td align="right">1.7</td>
<td align="right">0.08</td>
</tr>
</tbody>
</table>
</div>
<div id="c3-wo-mo" class="section level3">
<h3>C3 wo MO</h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true"></a><span class="co"># Select clusters of interest</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true"></a>grad_P3 =<span class="st"> </span><span class="kw">subset</span>(grad_P3, ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span> <span class="op">|</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true"></a><span class="co"># Match group with ID</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true"></a></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true"></a><span class="co"># Load qn_data</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true"></a><span class="kw">load.Rdata</span>(<span class="dt">filename =</span> <span class="st">&quot;./data/qn_data.RData&quot;</span>, <span class="st">&quot;qn_data&quot;</span>)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true"></a></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true"></a><span class="co"># Add group</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true"></a>grad_P3<span class="op">$</span>group =<span class="st"> </span>qn_data<span class="op">$</span>group[<span class="kw">match</span>(grad_P3<span class="op">$</span>ID, qn_data<span class="op">$</span>ID, <span class="dt">nomatch =</span> <span class="ot">NA</span>)]</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true"></a></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true"></a>grad_P3<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(grad_P3<span class="op">$</span>ID)</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true"></a>grad_P3<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(grad_P3<span class="op">$</span>emotion)</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true"></a>grad_P3<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(grad_P3<span class="op">$</span>group)</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true"></a>grad_P3<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(grad_P3<span class="op">$</span>intens, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true"></a>grad_P3<span class="op">$</span>ROI =<span class="st"> </span><span class="kw">factor</span>(grad_P3<span class="op">$</span>ROI)</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true"></a></span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true"></a><span class="co"># Define effect treatment contrasts</span></span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P3<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P3<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P3<span class="op">$</span>ROI) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P3<span class="op">$</span>intens) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">5</span>)</span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true"></a></span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true"></a>mod_P3 =<span class="st"> </span><span class="kw">lmer</span>(amp <span class="op">~</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_P3, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true"></a></span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true"></a>mod_P3_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_P3)</span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true"></a>mod_P3_res =<span class="st"> </span><span class="kw">subset</span>(mod_P3_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, etasq, omegasq, </span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true"></a>    partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true"></a>mod_P3_res =<span class="st"> </span><span class="kw">head</span>(mod_P3_res, <span class="dv">-1</span>)</span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_P3_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">124869</td>
<td align="right">16.56</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">124862</td>
<td align="right">42.26</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">group</td>
<td align="right">1</td>
<td align="right">42</td>
<td align="right">0.03</td>
<td align="right">0.87</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">6.93</td>
<td align="right">0.01</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens</td>
<td align="right">4</td>
<td align="right">124867</td>
<td align="right">3.66</td>
<td align="right">0.01</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:group</td>
<td align="right">1</td>
<td align="right">124869</td>
<td align="right">0.92</td>
<td align="right">0.34</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens:group</td>
<td align="right">4</td>
<td align="right">124862</td>
<td align="right">2.13</td>
<td align="right">0.07</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">5.31</td>
<td align="right">0.02</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.02</td>
<td align="right">0.39</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">group:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">11.57</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group</td>
<td align="right">4</td>
<td align="right">124867</td>
<td align="right">5.56</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.32</td>
<td align="right">0.26</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:group:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">4.18</td>
<td align="right">0.04</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens:group:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.94</td>
<td align="right">0.10</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:group:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.22</td>
<td align="right">0.30</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true"></a>int_emo_group =<span class="st"> </span><span class="kw">emmip</span>(mod_P3, emotion <span class="op">~</span><span class="st"> </span>intens <span class="op">|</span><span class="st"> </span>group, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#333333&quot;</span>, </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true"></a>    <span class="st">&quot;#0098ff&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true"></a>int_emo_group</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_P3_wo_MO-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_P3_group_emo_intens.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, pairwise <span class="op">~</span><span class="st"> </span>group <span class="op">|</span><span class="st"> </span>intens <span class="op">|</span><span class="st"> </span>ROI)</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">intens</th>
<th align="left">ROI</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">20%</td>
<td align="left">lOT</td>
<td align="right">-0.41</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">-0.64</td>
<td align="right">0.52</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">40%</td>
<td align="left">lOT</td>
<td align="right">0.65</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">1.01</td>
<td align="right">0.31</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">60%</td>
<td align="left">lOT</td>
<td align="right">1.09</td>
<td align="right">0.65</td>
<td align="right">Inf</td>
<td align="right">1.68</td>
<td align="right">0.09</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">80%</td>
<td align="left">lOT</td>
<td align="right">-0.25</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">-0.38</td>
<td align="right">0.70</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">100%</td>
<td align="left">lOT</td>
<td align="right">0.70</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">1.09</td>
<td align="right">0.28</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">20%</td>
<td align="left">rOT</td>
<td align="right">-0.34</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">-0.53</td>
<td align="right">0.60</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">40%</td>
<td align="left">rOT</td>
<td align="right">0.03</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">0.05</td>
<td align="right">0.96</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">60%</td>
<td align="left">rOT</td>
<td align="right">-1.09</td>
<td align="right">0.65</td>
<td align="right">Inf</td>
<td align="right">-1.69</td>
<td align="right">0.09</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">80%</td>
<td align="left">rOT</td>
<td align="right">-1.07</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">-1.67</td>
<td align="right">0.09</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">100%</td>
<td align="left">rOT</td>
<td align="right">-0.18</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">-0.28</td>
<td align="right">0.78</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true"></a>gr_emo_roi =<span class="st"> </span><span class="kw">emmip</span>(mod_P3, group <span class="op">~</span><span class="st"> </span>intens <span class="op">|</span><span class="st"> </span>ROI, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#333333&quot;</span>, </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true"></a>    <span class="st">&quot;#D97909&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true"></a>gr_emo_roi</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_P3_wo_MO-2.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_P3_roi_emo_gr.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, pairwise <span class="op">~</span><span class="st"> </span>group <span class="op">|</span><span class="st"> </span>emotion <span class="op">|</span><span class="st"> </span>ROI)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">emotion</th>
<th align="left">ROI</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">angry</td>
<td align="left">lOT</td>
<td align="right">0.21</td>
<td align="right">0.56</td>
<td align="right">Inf</td>
<td align="right">0.39</td>
<td align="right">0.70</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">happy</td>
<td align="left">lOT</td>
<td align="right">0.50</td>
<td align="right">0.56</td>
<td align="right">Inf</td>
<td align="right">0.89</td>
<td align="right">0.37</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">angry</td>
<td align="left">rOT</td>
<td align="right">-0.14</td>
<td align="right">0.56</td>
<td align="right">Inf</td>
<td align="right">-0.25</td>
<td align="right">0.80</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">happy</td>
<td align="left">rOT</td>
<td align="right">-0.92</td>
<td align="right">0.56</td>
<td align="right">Inf</td>
<td align="right">-1.65</td>
<td align="right">0.10</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, pairwise <span class="op">~</span><span class="st"> </span>group <span class="op">|</span><span class="st"> </span>emotion <span class="op">|</span><span class="st"> </span>intens)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">emotion</th>
<th align="left">intens</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">angry</td>
<td align="left">20%</td>
<td align="right">-0.27</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">-0.43</td>
<td align="right">0.67</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">happy</td>
<td align="left">20%</td>
<td align="right">-0.47</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">-0.73</td>
<td align="right">0.47</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">angry</td>
<td align="left">40%</td>
<td align="right">0.67</td>
<td align="right">0.65</td>
<td align="right">Inf</td>
<td align="right">1.03</td>
<td align="right">0.30</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">happy</td>
<td align="left">40%</td>
<td align="right">0.01</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">0.02</td>
<td align="right">0.99</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">angry</td>
<td align="left">60%</td>
<td align="right">-0.36</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">-0.56</td>
<td align="right">0.58</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">happy</td>
<td align="left">60%</td>
<td align="right">0.36</td>
<td align="right">0.65</td>
<td align="right">Inf</td>
<td align="right">0.55</td>
<td align="right">0.58</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">angry</td>
<td align="left">80%</td>
<td align="right">-1.26</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">-1.96</td>
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">happy</td>
<td align="left">80%</td>
<td align="right">-0.06</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">-0.09</td>
<td align="right">0.93</td>
</tr>
<tr class="odd">
<td align="left">CT - ZE</td>
<td align="left">angry</td>
<td align="left">100%</td>
<td align="right">1.42</td>
<td align="right">0.64</td>
<td align="right">Inf</td>
<td align="right">2.23</td>
<td align="right">0.03</td>
</tr>
<tr class="even">
<td align="left">CT - ZE</td>
<td align="left">happy</td>
<td align="left">100%</td>
<td align="right">-0.90</td>
<td align="right">0.65</td>
<td align="right">Inf</td>
<td align="right">-1.39</td>
<td align="right">0.16</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true"></a>poly_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;poly&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true"></a></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(poly_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">linear</td>
<td align="right">0</td>
<td align="right">5.92</td>
<td align="right">0.46</td>
<td align="right">Inf</td>
<td align="right">12.93</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">quadratic</td>
<td align="right">0</td>
<td align="right">-0.24</td>
<td align="right">0.54</td>
<td align="right">Inf</td>
<td align="right">-0.45</td>
<td align="right">0.65</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">cubic</td>
<td align="right">0</td>
<td align="right">0.50</td>
<td align="right">0.46</td>
<td align="right">Inf</td>
<td align="right">1.09</td>
<td align="right">0.28</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true"></a>intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true"></a></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 40%</td>
<td align="right">0</td>
<td align="right">-0.78</td>
<td align="right">0.21</td>
<td align="right">Inf</td>
<td align="right">-3.8</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 60%</td>
<td align="right">0</td>
<td align="right">-1.31</td>
<td align="right">0.21</td>
<td align="right">Inf</td>
<td align="right">-6.4</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 80%</td>
<td align="right">0</td>
<td align="right">-1.77</td>
<td align="right">0.20</td>
<td align="right">Inf</td>
<td align="right">-8.6</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 100%</td>
<td align="right">0</td>
<td align="right">-2.47</td>
<td align="right">0.20</td>
<td align="right">Inf</td>
<td align="right">-12.1</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">40% - 60%</td>
<td align="right">0</td>
<td align="right">-0.53</td>
<td align="right">0.21</td>
<td align="right">Inf</td>
<td align="right">-2.5</td>
<td align="right">0.08</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">40% - 80%</td>
<td align="right">0</td>
<td align="right">-0.98</td>
<td align="right">0.21</td>
<td align="right">Inf</td>
<td align="right">-4.8</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true"></a>m.emo =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, <span class="st">&quot;emotion&quot;</span>)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true"></a>emo =<span class="st"> </span><span class="kw">contrast</span>(m.emo, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true"></a></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emo, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="left">angry - happy</td>
<td align="right">0</td>
<td align="right">-0.53</td>
<td align="right">0.13</td>
<td align="right">Inf</td>
<td align="right">-4.1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true"></a>m.roi =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, <span class="st">&quot;ROI&quot;</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true"></a>roi =<span class="st"> </span><span class="kw">contrast</span>(m.roi, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true"></a></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(roi, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ROI</td>
<td align="left">lOT - rOT</td>
<td align="right">0</td>
<td align="right">-0.34</td>
<td align="right">0.13</td>
<td align="right">Inf</td>
<td align="right">-2.6</td>
<td align="right">0.01</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="single-trial-analyses-pdi" class="section level2 tabset tabset-pills">
<h2 class="tabset tabset-pills">Single-trial analyses PDI</h2>
<div id="p1-wo-mo-pdi" class="section level3">
<h3>P1 wo MO / PDI</h3>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true"></a><span class="co"># Load data</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true"></a>grad_P1_amp_twent =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P1_twent_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true"></a>grad_P1_amp_fort =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P1_fort_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true"></a>grad_P1_amp_sixt =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P1_sixt_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true"></a>grad_P1_amp_eigt =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P1_eigt_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true"></a>grad_P1_amp_oneh =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P1_oneh_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true"></a></span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true"></a>grad_P1_amp_twent =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P1_twent_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true"></a>grad_P1_amp_fort =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P1_fort_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true"></a>grad_P1_amp_sixt =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P1_sixt_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true"></a>grad_P1_amp_eigt =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P1_eigt_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true"></a>grad_P1_amp_oneh =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P1_oneh_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true"></a></span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true"></a></span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true"></a><span class="co"># Add intensity</span></span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true"></a>grad_P1_amp_twent =<span class="st"> </span><span class="kw">mutate</span>(grad_P1_amp_twent, <span class="dt">intens =</span> <span class="st">&quot;20%&quot;</span>)</span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true"></a>grad_P1_amp_fort =<span class="st"> </span><span class="kw">mutate</span>(grad_P1_amp_fort, <span class="dt">intens =</span> <span class="st">&quot;40%&quot;</span>)</span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true"></a>grad_P1_amp_sixt =<span class="st"> </span><span class="kw">mutate</span>(grad_P1_amp_sixt, <span class="dt">intens =</span> <span class="st">&quot;60%&quot;</span>)</span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true"></a>grad_P1_amp_eigt =<span class="st"> </span><span class="kw">mutate</span>(grad_P1_amp_eigt, <span class="dt">intens =</span> <span class="st">&quot;80%&quot;</span>)</span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true"></a>grad_P1_amp_oneh =<span class="st"> </span><span class="kw">mutate</span>(grad_P1_amp_oneh, <span class="dt">intens =</span> <span class="st">&quot;100%&quot;</span>)</span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true"></a></span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true"></a><span class="co"># Combine datasets</span></span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true"></a>grad_P1 =<span class="st"> </span><span class="kw">rbind</span>(grad_P1_amp_twent, grad_P1_amp_fort, grad_P1_amp_sixt, grad_P1_amp_eigt, </span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true"></a>    grad_P1_amp_oneh)</span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true"></a></span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true"></a><span class="co"># Recode emotion condition</span></span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true"></a>grad_P1 =<span class="st"> </span>grad_P1 <span class="op">%&gt;%</span></span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">emotion =</span> dplyr<span class="op">::</span><span class="kw">recode</span>(emotion, <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> &quot;happy&quot;</span>, <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> &quot;angry&quot;</span>))</span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true"></a></span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true"></a><span class="co"># Recode ROI condition</span></span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true"></a></span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true"></a><span class="co"># Transform from wide to long format</span></span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true"></a>grad_P1 =<span class="st"> </span><span class="kw">gather</span>(grad_P1, elec, amp, O1<span class="op">:</span>PO10, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true"></a></span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true"></a>grad_P1<span class="op">$</span>ROI =<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true"></a>grad_P1[grad_P1<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO7&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P1<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO3&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P1<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;P7&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P1<span class="op">$</span>elec <span class="op">==</span><span class="st"> </span></span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true"></a><span class="st">    &quot;PO9&quot;</span>, ]<span class="op">$</span>ROI =<span class="st"> &quot;lOT&quot;</span></span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true"></a>grad_P1[grad_P1<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO8&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P1<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO4&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P1<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;P8&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P1<span class="op">$</span>elec <span class="op">==</span><span class="st"> </span></span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true"></a><span class="st">    &quot;PO10&quot;</span>, ]<span class="op">$</span>ROI =<span class="st"> &quot;rOT&quot;</span></span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true"></a>grad_P1[grad_P1<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;O1&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P1<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;Oz&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P1<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;O2&quot;</span>, ]<span class="op">$</span>ROI =<span class="st"> &quot;MO&quot;</span></span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true"></a></span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true"></a>grad_P1 =<span class="st"> </span><span class="kw">subset</span>(grad_P1, ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span> <span class="op">|</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>)</span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true"></a></span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true"></a><span class="co"># Match group with ID</span></span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true"></a></span>
<span id="cb110-56"><a href="#cb110-56" aria-hidden="true"></a><span class="co"># Load qn_data</span></span>
<span id="cb110-57"><a href="#cb110-57" aria-hidden="true"></a><span class="kw">load.Rdata</span>(<span class="dt">filename =</span> <span class="st">&quot;./data/qn_data.RData&quot;</span>, <span class="st">&quot;qn_data&quot;</span>)</span>
<span id="cb110-58"><a href="#cb110-58" aria-hidden="true"></a></span>
<span id="cb110-59"><a href="#cb110-59" aria-hidden="true"></a><span class="co"># Add group</span></span>
<span id="cb110-60"><a href="#cb110-60" aria-hidden="true"></a>grad_P1<span class="op">$</span>group =<span class="st"> </span>qn_data<span class="op">$</span>group[<span class="kw">match</span>(grad_P1<span class="op">$</span>ID, qn_data<span class="op">$</span>ID, <span class="dt">nomatch =</span> <span class="ot">NA</span>)]</span>
<span id="cb110-61"><a href="#cb110-61" aria-hidden="true"></a></span>
<span id="cb110-62"><a href="#cb110-62" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb110-63"><a href="#cb110-63" aria-hidden="true"></a>grad_P1<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(grad_P1<span class="op">$</span>ID)</span>
<span id="cb110-64"><a href="#cb110-64" aria-hidden="true"></a>grad_P1<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(grad_P1<span class="op">$</span>emotion)</span>
<span id="cb110-65"><a href="#cb110-65" aria-hidden="true"></a>grad_P1<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(grad_P1<span class="op">$</span>group)</span>
<span id="cb110-66"><a href="#cb110-66" aria-hidden="true"></a>grad_P1<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(grad_P1<span class="op">$</span>intens, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb110-67"><a href="#cb110-67" aria-hidden="true"></a>grad_P1<span class="op">$</span>ROI =<span class="st"> </span><span class="kw">factor</span>(grad_P1<span class="op">$</span>ROI)</span>
<span id="cb110-68"><a href="#cb110-68" aria-hidden="true"></a></span>
<span id="cb110-69"><a href="#cb110-69" aria-hidden="true"></a><span class="co"># Define effect treatment contrasts</span></span>
<span id="cb110-70"><a href="#cb110-70" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P1<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb110-71"><a href="#cb110-71" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P1<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb110-72"><a href="#cb110-72" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P1<span class="op">$</span>ROI) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb110-73"><a href="#cb110-73" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P1<span class="op">$</span>intens) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">5</span>)</span>
<span id="cb110-74"><a href="#cb110-74" aria-hidden="true"></a></span>
<span id="cb110-75"><a href="#cb110-75" aria-hidden="true"></a><span class="co"># Load PDI data</span></span>
<span id="cb110-76"><a href="#cb110-76" aria-hidden="true"></a>grad_pdi =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_pdi_values.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb110-77"><a href="#cb110-77" aria-hidden="true"></a></span>
<span id="cb110-78"><a href="#cb110-78" aria-hidden="true"></a><span class="co"># Transpose data frame</span></span>
<span id="cb110-79"><a href="#cb110-79" aria-hidden="true"></a>grad_pdi =<span class="st"> </span><span class="kw">gather</span>(grad_pdi, intens, pdi, twent<span class="op">:</span>oneh, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb110-80"><a href="#cb110-80" aria-hidden="true"></a></span>
<span id="cb110-81"><a href="#cb110-81" aria-hidden="true"></a><span class="co"># Recode intensities</span></span>
<span id="cb110-82"><a href="#cb110-82" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens =<span class="st"> </span><span class="kw">as.numeric</span>(grad_pdi<span class="op">$</span>intens)</span>
<span id="cb110-83"><a href="#cb110-83" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;20%&quot;</span></span>
<span id="cb110-84"><a href="#cb110-84" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;40%&quot;</span></span>
<span id="cb110-85"><a href="#cb110-85" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;60%&quot;</span></span>
<span id="cb110-86"><a href="#cb110-86" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;80%&quot;</span></span>
<span id="cb110-87"><a href="#cb110-87" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;100%&quot;</span></span>
<span id="cb110-88"><a href="#cb110-88" aria-hidden="true"></a></span>
<span id="cb110-89"><a href="#cb110-89" aria-hidden="true"></a><span class="co"># Rename column for emotion</span></span>
<span id="cb110-90"><a href="#cb110-90" aria-hidden="true"></a><span class="kw">names</span>(grad_pdi)[<span class="dv">1</span>] =<span class="st"> &quot;emotion&quot;</span></span>
<span id="cb110-91"><a href="#cb110-91" aria-hidden="true"></a></span>
<span id="cb110-92"><a href="#cb110-92" aria-hidden="true"></a><span class="co"># Bring information together</span></span>
<span id="cb110-93"><a href="#cb110-93" aria-hidden="true"></a>grad_P1_pdi =<span class="st"> </span><span class="kw">merge</span>(grad_P1, grad_pdi, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>, <span class="st">&quot;intens&quot;</span>))</span>
<span id="cb110-94"><a href="#cb110-94" aria-hidden="true"></a></span>
<span id="cb110-95"><a href="#cb110-95" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb110-96"><a href="#cb110-96" aria-hidden="true"></a>mod_P1 =<span class="st"> </span><span class="kw">lmer</span>(amp <span class="op">~</span><span class="st"> </span>pdi <span class="op">+</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_P1_pdi, </span>
<span id="cb110-97"><a href="#cb110-97" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb110-98"><a href="#cb110-98" aria-hidden="true"></a></span>
<span id="cb110-99"><a href="#cb110-99" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb110-100"><a href="#cb110-100" aria-hidden="true"></a>mod_P1_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_P1)</span>
<span id="cb110-101"><a href="#cb110-101" aria-hidden="true"></a>mod_P1_res =<span class="st"> </span><span class="kw">subset</span>(mod_P1_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, etasq, omegasq, </span>
<span id="cb110-102"><a href="#cb110-102" aria-hidden="true"></a>    partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb110-103"><a href="#cb110-103" aria-hidden="true"></a>mod_P1_res =<span class="st"> </span><span class="kw">head</span>(mod_P1_res, <span class="dv">-1</span>)</span>
<span id="cb110-104"><a href="#cb110-104" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_P1_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pdi</td>
<td align="right">1</td>
<td align="right">124859</td>
<td align="right">0.35</td>
<td align="right">0.56</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">124873</td>
<td align="right">0.01</td>
<td align="right">0.92</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">124863</td>
<td align="right">3.40</td>
<td align="right">0.01</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">group</td>
<td align="right">1</td>
<td align="right">42</td>
<td align="right">0.20</td>
<td align="right">0.66</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">0.06</td>
<td align="right">0.80</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens</td>
<td align="right">3</td>
<td align="right">124873</td>
<td align="right">0.48</td>
<td align="right">0.70</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:group</td>
<td align="right">1</td>
<td align="right">124877</td>
<td align="right">0.79</td>
<td align="right">0.37</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens:group</td>
<td align="right">4</td>
<td align="right">124868</td>
<td align="right">3.01</td>
<td align="right">0.02</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">0.19</td>
<td align="right">0.66</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.33</td>
<td align="right">0.25</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">group:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">10.51</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:group</td>
<td align="right">4</td>
<td align="right">124873</td>
<td align="right">3.44</td>
<td align="right">0.01</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">0.71</td>
<td align="right">0.58</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:group:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">0.50</td>
<td align="right">0.48</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens:group:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.41</td>
<td align="right">0.23</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:group:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">2.99</td>
<td align="right">0.02</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true"></a><span class="co"># Post-hoc tests</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true"></a>m.roi =<span class="st"> </span><span class="kw">emmeans</span>(mod_P1, <span class="st">&quot;ROI&quot;</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true"></a></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true"></a>ROI =<span class="st"> </span><span class="kw">contrast</span>(m.roi, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true"></a></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(ROI, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ROI</td>
<td align="left">lOT - rOT</td>
<td align="right">0</td>
<td align="right">-0.03</td>
<td align="right">0.11</td>
<td align="right">Inf</td>
<td align="right">-0.25</td>
<td align="right">0.8</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_P1, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true"></a>poly_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;poly&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(poly_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">linear</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">quadratic</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">cubic</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_P1, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true"></a>intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 40%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 60%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 80%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 100%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">40% - 60%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">40% - 80%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="n170-wo-mo-pdi" class="section level3">
<h3>N170 wo MO / PDI</h3>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true"></a><span class="co"># Load data</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true"></a>grad_N170_amp_twent =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_N170_twent_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true"></a>grad_N170_amp_fort =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_N170_fort_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true"></a>grad_N170_amp_sixt =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_N170_sixt_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true"></a>grad_N170_amp_eigt =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_N170_eigt_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true"></a>grad_N170_amp_oneh =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_N170_oneh_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true"></a></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true"></a>grad_N170_amp_twent =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_N170_twent_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true"></a>grad_N170_amp_fort =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_N170_fort_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true"></a>grad_N170_amp_sixt =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_N170_sixt_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true"></a>grad_N170_amp_eigt =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_N170_eigt_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true"></a>grad_N170_amp_oneh =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_N170_oneh_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true"></a></span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true"></a><span class="co"># Add intensity</span></span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true"></a>grad_N170_amp_twent =<span class="st"> </span><span class="kw">mutate</span>(grad_N170_amp_twent, <span class="dt">intens =</span> <span class="st">&quot;20%&quot;</span>)</span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true"></a>grad_N170_amp_fort =<span class="st"> </span><span class="kw">mutate</span>(grad_N170_amp_fort, <span class="dt">intens =</span> <span class="st">&quot;40%&quot;</span>)</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true"></a>grad_N170_amp_sixt =<span class="st"> </span><span class="kw">mutate</span>(grad_N170_amp_sixt, <span class="dt">intens =</span> <span class="st">&quot;60%&quot;</span>)</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true"></a>grad_N170_amp_eigt =<span class="st"> </span><span class="kw">mutate</span>(grad_N170_amp_eigt, <span class="dt">intens =</span> <span class="st">&quot;80%&quot;</span>)</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true"></a>grad_N170_amp_oneh =<span class="st"> </span><span class="kw">mutate</span>(grad_N170_amp_oneh, <span class="dt">intens =</span> <span class="st">&quot;100%&quot;</span>)</span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true"></a></span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true"></a><span class="co"># Combine datasets</span></span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true"></a>grad_N170 =<span class="st"> </span><span class="kw">rbind</span>(grad_N170_amp_twent, grad_N170_amp_fort, grad_N170_amp_sixt, grad_N170_amp_eigt, </span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true"></a>    grad_N170_amp_oneh)</span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true"></a></span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true"></a><span class="co"># Recode emotion condition</span></span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true"></a>grad_N170 =<span class="st"> </span>grad_N170 <span class="op">%&gt;%</span></span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">emotion =</span> dplyr<span class="op">::</span><span class="kw">recode</span>(emotion, <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> &quot;happy&quot;</span>, <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> &quot;angry&quot;</span>))</span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true"></a></span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true"></a><span class="co"># Recode ROI condition</span></span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true"></a></span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true"></a><span class="co"># Transform from wide to long format</span></span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true"></a>grad_N170 =<span class="st"> </span><span class="kw">gather</span>(grad_N170, elec, amp, O1<span class="op">:</span>PO10, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true"></a></span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true"></a>grad_N170<span class="op">$</span>ROI =<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true"></a>grad_N170[grad_N170<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO7&quot;</span> <span class="op">|</span><span class="st"> </span>grad_N170<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO3&quot;</span> <span class="op">|</span><span class="st"> </span>grad_N170<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;P7&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true"></a><span class="st">    </span>grad_N170<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO9&quot;</span>, ]<span class="op">$</span>ROI =<span class="st"> &quot;lOT&quot;</span></span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true"></a>grad_N170[grad_N170<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO8&quot;</span> <span class="op">|</span><span class="st"> </span>grad_N170<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO4&quot;</span> <span class="op">|</span><span class="st"> </span>grad_N170<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;P8&quot;</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true"></a><span class="st">    </span>grad_N170<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO10&quot;</span>, ]<span class="op">$</span>ROI =<span class="st"> &quot;rOT&quot;</span></span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true"></a>grad_N170[grad_N170<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;O1&quot;</span> <span class="op">|</span><span class="st"> </span>grad_N170<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;Oz&quot;</span> <span class="op">|</span><span class="st"> </span>grad_N170<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;O2&quot;</span>, </span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true"></a>    ]<span class="op">$</span>ROI =<span class="st"> &quot;MO&quot;</span></span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true"></a></span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true"></a>grad_N170 =<span class="st"> </span><span class="kw">subset</span>(grad_N170, ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span> <span class="op">|</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>)</span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true"></a></span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true"></a><span class="co"># Match group with ID</span></span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true"></a></span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true"></a><span class="co"># Load qn_data</span></span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true"></a><span class="kw">load.Rdata</span>(<span class="dt">filename =</span> <span class="st">&quot;./data/qn_data.RData&quot;</span>, <span class="st">&quot;qn_data&quot;</span>)</span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true"></a></span>
<span id="cb114-59"><a href="#cb114-59" aria-hidden="true"></a><span class="co"># Add group</span></span>
<span id="cb114-60"><a href="#cb114-60" aria-hidden="true"></a>grad_N170<span class="op">$</span>group =<span class="st"> </span>qn_data<span class="op">$</span>group[<span class="kw">match</span>(grad_N170<span class="op">$</span>ID, qn_data<span class="op">$</span>ID, <span class="dt">nomatch =</span> <span class="ot">NA</span>)]</span>
<span id="cb114-61"><a href="#cb114-61" aria-hidden="true"></a></span>
<span id="cb114-62"><a href="#cb114-62" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb114-63"><a href="#cb114-63" aria-hidden="true"></a>grad_N170<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(grad_N170<span class="op">$</span>ID)</span>
<span id="cb114-64"><a href="#cb114-64" aria-hidden="true"></a>grad_N170<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(grad_N170<span class="op">$</span>emotion)</span>
<span id="cb114-65"><a href="#cb114-65" aria-hidden="true"></a>grad_N170<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(grad_N170<span class="op">$</span>group)</span>
<span id="cb114-66"><a href="#cb114-66" aria-hidden="true"></a>grad_N170<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(grad_N170<span class="op">$</span>intens, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>, </span>
<span id="cb114-67"><a href="#cb114-67" aria-hidden="true"></a>    <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb114-68"><a href="#cb114-68" aria-hidden="true"></a>grad_N170<span class="op">$</span>ROI =<span class="st"> </span><span class="kw">factor</span>(grad_N170<span class="op">$</span>ROI)</span>
<span id="cb114-69"><a href="#cb114-69" aria-hidden="true"></a></span>
<span id="cb114-70"><a href="#cb114-70" aria-hidden="true"></a><span class="co"># Define effect treatment contrasts</span></span>
<span id="cb114-71"><a href="#cb114-71" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_N170<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb114-72"><a href="#cb114-72" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_N170<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb114-73"><a href="#cb114-73" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_N170<span class="op">$</span>ROI) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb114-74"><a href="#cb114-74" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_N170<span class="op">$</span>intens) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">5</span>)</span>
<span id="cb114-75"><a href="#cb114-75" aria-hidden="true"></a></span>
<span id="cb114-76"><a href="#cb114-76" aria-hidden="true"></a><span class="co"># Load PDI data</span></span>
<span id="cb114-77"><a href="#cb114-77" aria-hidden="true"></a>grad_pdi =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_pdi_values.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb114-78"><a href="#cb114-78" aria-hidden="true"></a></span>
<span id="cb114-79"><a href="#cb114-79" aria-hidden="true"></a><span class="co"># Transpose data frame</span></span>
<span id="cb114-80"><a href="#cb114-80" aria-hidden="true"></a>grad_pdi =<span class="st"> </span><span class="kw">gather</span>(grad_pdi, intens, pdi, twent<span class="op">:</span>oneh, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb114-81"><a href="#cb114-81" aria-hidden="true"></a></span>
<span id="cb114-82"><a href="#cb114-82" aria-hidden="true"></a><span class="co"># Recode intensities</span></span>
<span id="cb114-83"><a href="#cb114-83" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens =<span class="st"> </span><span class="kw">as.numeric</span>(grad_pdi<span class="op">$</span>intens)</span>
<span id="cb114-84"><a href="#cb114-84" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;20%&quot;</span></span>
<span id="cb114-85"><a href="#cb114-85" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;40%&quot;</span></span>
<span id="cb114-86"><a href="#cb114-86" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;60%&quot;</span></span>
<span id="cb114-87"><a href="#cb114-87" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;80%&quot;</span></span>
<span id="cb114-88"><a href="#cb114-88" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;100%&quot;</span></span>
<span id="cb114-89"><a href="#cb114-89" aria-hidden="true"></a></span>
<span id="cb114-90"><a href="#cb114-90" aria-hidden="true"></a><span class="co"># Rename column for emotion</span></span>
<span id="cb114-91"><a href="#cb114-91" aria-hidden="true"></a><span class="kw">names</span>(grad_pdi)[<span class="dv">1</span>] =<span class="st"> &quot;emotion&quot;</span></span>
<span id="cb114-92"><a href="#cb114-92" aria-hidden="true"></a></span>
<span id="cb114-93"><a href="#cb114-93" aria-hidden="true"></a><span class="co"># Bring information together</span></span>
<span id="cb114-94"><a href="#cb114-94" aria-hidden="true"></a>grad_N170_pdi =<span class="st"> </span><span class="kw">merge</span>(grad_pdi, grad_N170, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>, <span class="st">&quot;intens&quot;</span>))</span>
<span id="cb114-95"><a href="#cb114-95" aria-hidden="true"></a></span>
<span id="cb114-96"><a href="#cb114-96" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb114-97"><a href="#cb114-97" aria-hidden="true"></a>mod_N170 =<span class="st"> </span><span class="kw">lmer</span>(amp <span class="op">~</span><span class="st"> </span>pdi <span class="op">+</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_N170_pdi, </span>
<span id="cb114-98"><a href="#cb114-98" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb114-99"><a href="#cb114-99" aria-hidden="true"></a></span>
<span id="cb114-100"><a href="#cb114-100" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb114-101"><a href="#cb114-101" aria-hidden="true"></a>mod_N170_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_N170)</span>
<span id="cb114-102"><a href="#cb114-102" aria-hidden="true"></a>mod_N170_res =<span class="st"> </span><span class="kw">subset</span>(mod_N170_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, etasq, omegasq, </span>
<span id="cb114-103"><a href="#cb114-103" aria-hidden="true"></a>    partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb114-104"><a href="#cb114-104" aria-hidden="true"></a>mod_N170_res =<span class="st"> </span><span class="kw">head</span>(mod_N170_res, <span class="dv">-1</span>)</span>
<span id="cb114-105"><a href="#cb114-105" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_N170_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pdi</td>
<td align="right">1</td>
<td align="right">124856</td>
<td align="right">0.49</td>
<td align="right">0.48</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">124873</td>
<td align="right">20.37</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">124864</td>
<td align="right">4.16</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">group</td>
<td align="right">1</td>
<td align="right">42</td>
<td align="right">0.09</td>
<td align="right">0.77</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">1.24</td>
<td align="right">0.26</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens</td>
<td align="right">3</td>
<td align="right">124871</td>
<td align="right">3.26</td>
<td align="right">0.02</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:group</td>
<td align="right">1</td>
<td align="right">124875</td>
<td align="right">11.90</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens:group</td>
<td align="right">4</td>
<td align="right">124866</td>
<td align="right">5.48</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">0.01</td>
<td align="right">0.92</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">2.21</td>
<td align="right">0.06</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">group:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">2.62</td>
<td align="right">0.11</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:group</td>
<td align="right">4</td>
<td align="right">124872</td>
<td align="right">1.03</td>
<td align="right">0.39</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.22</td>
<td align="right">0.30</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:group:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">2.06</td>
<td align="right">0.15</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens:group:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">2.43</td>
<td align="right">0.04</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:group:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.31</td>
<td align="right">0.26</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_N170, pairwise <span class="op">~</span><span class="st"> </span>emotion <span class="op">|</span><span class="st"> </span>intens)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">intens</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">100%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">angry - happy</td>
<td align="left">20%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">40%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">angry - happy</td>
<td align="left">60%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">80%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true"></a>int_emo =<span class="st"> </span><span class="kw">emmip</span>(mod_N170, emotion <span class="op">~</span><span class="st"> </span>intens, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#333333&quot;</span>, </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true"></a>    <span class="st">&quot;#0098ff&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true"></a></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true"></a>int_emo</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_N170_wo_MO_PDI-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_N170_emo_intens.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_N170, pairwise <span class="op">~</span><span class="st"> </span>emotion <span class="op">|</span><span class="st"> </span>group)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">group</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">CT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">angry - happy</td>
<td align="left">ZE</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true"></a>gr_emo =<span class="st"> </span><span class="kw">emmip</span>(mod_N170, emotion <span class="op">~</span><span class="st"> </span>group, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#333333&quot;</span>, </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true"></a>    <span class="st">&quot;#0098ff&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true"></a></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true"></a>gr_emo</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_N170_wo_MO_PDI-2.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_N170_emo_group.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_N170, pairwise <span class="op">~</span><span class="st"> </span>intens <span class="op">|</span><span class="st"> </span>group)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">group</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">100% - 20%</td>
<td align="left">CT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">100% - 40%</td>
<td align="left">CT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">100% - 60%</td>
<td align="left">CT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">100% - 80%</td>
<td align="left">CT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">20% - 40%</td>
<td align="left">CT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">20% - 60%</td>
<td align="left">CT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">20% - 80%</td>
<td align="left">CT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">40% - 60%</td>
<td align="left">CT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">40% - 80%</td>
<td align="left">CT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">60% - 80%</td>
<td align="left">CT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">100% - 20%</td>
<td align="left">ZE</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">100% - 40%</td>
<td align="left">ZE</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">100% - 60%</td>
<td align="left">ZE</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">100% - 80%</td>
<td align="left">ZE</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">20% - 40%</td>
<td align="left">ZE</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">20% - 60%</td>
<td align="left">ZE</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">20% - 80%</td>
<td align="left">ZE</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">40% - 60%</td>
<td align="left">ZE</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">40% - 80%</td>
<td align="left">ZE</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">60% - 80%</td>
<td align="left">ZE</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true"></a>gr_int =<span class="st"> </span><span class="kw">emmip</span>(mod_N170, group <span class="op">~</span><span class="st"> </span>intens, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#333333&quot;</span>, </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true"></a>    <span class="st">&quot;#D97909&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true"></a></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true"></a>gr_int</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_N170_wo_MO_PDI-3.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_N170_int_group.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true"></a></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_N170, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true"></a>main_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true"></a></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(main_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">100% - 20%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">100% - 40%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">100% - 60%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">100% - 80%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 40%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 60%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_N170, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true"></a>poly_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;poly&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(poly_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">linear</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">quadratic</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">cubic</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="p3-wo-mo-pdi" class="section level3">
<h3>P3 wo MO / PDI</h3>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true"></a><span class="co"># Load data</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true"></a>grad_P3_amp_twent =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P3_twent_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true"></a>grad_P3_amp_fort =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P3_fort_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true"></a>grad_P3_amp_sixt =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P3_sixt_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true"></a>grad_P3_amp_eigt =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P3_eigt_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true"></a>grad_P3_amp_oneh =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P3_oneh_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true"></a></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true"></a>grad_P3_amp_twent =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P3_twent_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true"></a>grad_P3_amp_fort =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P3_fort_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true"></a>grad_P3_amp_sixt =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P3_sixt_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true"></a>grad_P3_amp_eigt =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P3_eigt_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true"></a>grad_P3_amp_oneh =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_P3_oneh_singl_trials.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, </span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true"></a>    <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true"></a></span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true"></a></span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true"></a><span class="co"># Add intensity</span></span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true"></a>grad_P3_amp_twent =<span class="st"> </span><span class="kw">mutate</span>(grad_P3_amp_twent, <span class="dt">intens =</span> <span class="st">&quot;20%&quot;</span>)</span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true"></a>grad_P3_amp_fort =<span class="st"> </span><span class="kw">mutate</span>(grad_P3_amp_fort, <span class="dt">intens =</span> <span class="st">&quot;40%&quot;</span>)</span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true"></a>grad_P3_amp_sixt =<span class="st"> </span><span class="kw">mutate</span>(grad_P3_amp_sixt, <span class="dt">intens =</span> <span class="st">&quot;60%&quot;</span>)</span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true"></a>grad_P3_amp_eigt =<span class="st"> </span><span class="kw">mutate</span>(grad_P3_amp_eigt, <span class="dt">intens =</span> <span class="st">&quot;80%&quot;</span>)</span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true"></a>grad_P3_amp_oneh =<span class="st"> </span><span class="kw">mutate</span>(grad_P3_amp_oneh, <span class="dt">intens =</span> <span class="st">&quot;100%&quot;</span>)</span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true"></a></span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true"></a><span class="co"># Combine datasets</span></span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true"></a>grad_P3 =<span class="st"> </span><span class="kw">rbind</span>(grad_P3_amp_twent, grad_P3_amp_fort, grad_P3_amp_sixt, grad_P3_amp_eigt, </span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true"></a>    grad_P3_amp_oneh)</span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true"></a></span>
<span id="cb123-36"><a href="#cb123-36" aria-hidden="true"></a><span class="co"># Recode emotion condition</span></span>
<span id="cb123-37"><a href="#cb123-37" aria-hidden="true"></a>grad_P3 =<span class="st"> </span>grad_P3 <span class="op">%&gt;%</span></span>
<span id="cb123-38"><a href="#cb123-38" aria-hidden="true"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">emotion =</span> dplyr<span class="op">::</span><span class="kw">recode</span>(emotion, <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> &quot;happy&quot;</span>, <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> &quot;angry&quot;</span>))</span>
<span id="cb123-39"><a href="#cb123-39" aria-hidden="true"></a></span>
<span id="cb123-40"><a href="#cb123-40" aria-hidden="true"></a><span class="co"># Recode ROI condition</span></span>
<span id="cb123-41"><a href="#cb123-41" aria-hidden="true"></a></span>
<span id="cb123-42"><a href="#cb123-42" aria-hidden="true"></a><span class="co"># Transform from wide to long format</span></span>
<span id="cb123-43"><a href="#cb123-43" aria-hidden="true"></a>grad_P3 =<span class="st"> </span><span class="kw">gather</span>(grad_P3, elec, amp, O1<span class="op">:</span>PO10, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb123-44"><a href="#cb123-44" aria-hidden="true"></a></span>
<span id="cb123-45"><a href="#cb123-45" aria-hidden="true"></a>grad_P3<span class="op">$</span>ROI =<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb123-46"><a href="#cb123-46" aria-hidden="true"></a>grad_P3[grad_P3<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO7&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P3<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO3&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P3<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;P7&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P3<span class="op">$</span>elec <span class="op">==</span><span class="st"> </span></span>
<span id="cb123-47"><a href="#cb123-47" aria-hidden="true"></a><span class="st">    &quot;PO9&quot;</span>, ]<span class="op">$</span>ROI =<span class="st"> &quot;lOT&quot;</span></span>
<span id="cb123-48"><a href="#cb123-48" aria-hidden="true"></a>grad_P3[grad_P3<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO8&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P3<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;PO4&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P3<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;P8&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P3<span class="op">$</span>elec <span class="op">==</span><span class="st"> </span></span>
<span id="cb123-49"><a href="#cb123-49" aria-hidden="true"></a><span class="st">    &quot;PO10&quot;</span>, ]<span class="op">$</span>ROI =<span class="st"> &quot;rOT&quot;</span></span>
<span id="cb123-50"><a href="#cb123-50" aria-hidden="true"></a>grad_P3[grad_P3<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;O1&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P3<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;Oz&quot;</span> <span class="op">|</span><span class="st"> </span>grad_P3<span class="op">$</span>elec <span class="op">==</span><span class="st"> &quot;O2&quot;</span>, ]<span class="op">$</span>ROI =<span class="st"> &quot;MO&quot;</span></span>
<span id="cb123-51"><a href="#cb123-51" aria-hidden="true"></a></span>
<span id="cb123-52"><a href="#cb123-52" aria-hidden="true"></a>grad_P3 =<span class="st"> </span><span class="kw">subset</span>(grad_P3, ROI <span class="op">==</span><span class="st"> &quot;lOT&quot;</span> <span class="op">|</span><span class="st"> </span>ROI <span class="op">==</span><span class="st"> &quot;rOT&quot;</span>)</span>
<span id="cb123-53"><a href="#cb123-53" aria-hidden="true"></a></span>
<span id="cb123-54"><a href="#cb123-54" aria-hidden="true"></a><span class="co"># Match group with ID</span></span>
<span id="cb123-55"><a href="#cb123-55" aria-hidden="true"></a></span>
<span id="cb123-56"><a href="#cb123-56" aria-hidden="true"></a><span class="co"># Load qn_data</span></span>
<span id="cb123-57"><a href="#cb123-57" aria-hidden="true"></a><span class="kw">load.Rdata</span>(<span class="dt">filename =</span> <span class="st">&quot;./data/qn_data.RData&quot;</span>, <span class="st">&quot;qn_data&quot;</span>)</span>
<span id="cb123-58"><a href="#cb123-58" aria-hidden="true"></a></span>
<span id="cb123-59"><a href="#cb123-59" aria-hidden="true"></a><span class="co"># Add group</span></span>
<span id="cb123-60"><a href="#cb123-60" aria-hidden="true"></a>grad_P3<span class="op">$</span>group =<span class="st"> </span>qn_data<span class="op">$</span>group[<span class="kw">match</span>(grad_P3<span class="op">$</span>ID, qn_data<span class="op">$</span>ID, <span class="dt">nomatch =</span> <span class="ot">NA</span>)]</span>
<span id="cb123-61"><a href="#cb123-61" aria-hidden="true"></a></span>
<span id="cb123-62"><a href="#cb123-62" aria-hidden="true"></a></span>
<span id="cb123-63"><a href="#cb123-63" aria-hidden="true"></a><span class="co"># Convert ID, group &amp; emotion into factor variables</span></span>
<span id="cb123-64"><a href="#cb123-64" aria-hidden="true"></a>grad_P3<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(grad_P3<span class="op">$</span>ID)</span>
<span id="cb123-65"><a href="#cb123-65" aria-hidden="true"></a>grad_P3<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(grad_P3<span class="op">$</span>emotion)</span>
<span id="cb123-66"><a href="#cb123-66" aria-hidden="true"></a>grad_P3<span class="op">$</span>group =<span class="st"> </span><span class="kw">factor</span>(grad_P3<span class="op">$</span>group)</span>
<span id="cb123-67"><a href="#cb123-67" aria-hidden="true"></a>grad_P3<span class="op">$</span>intens =<span class="st"> </span><span class="kw">factor</span>(grad_P3<span class="op">$</span>intens, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;20%&quot;</span>, <span class="st">&quot;40%&quot;</span>, <span class="st">&quot;60%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;100%&quot;</span>))</span>
<span id="cb123-68"><a href="#cb123-68" aria-hidden="true"></a>grad_P3<span class="op">$</span>ROI =<span class="st"> </span><span class="kw">factor</span>(grad_P3<span class="op">$</span>ROI)</span>
<span id="cb123-69"><a href="#cb123-69" aria-hidden="true"></a></span>
<span id="cb123-70"><a href="#cb123-70" aria-hidden="true"></a><span class="co"># Define effect treatment contrasts</span></span>
<span id="cb123-71"><a href="#cb123-71" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P3<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb123-72"><a href="#cb123-72" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P3<span class="op">$</span>group) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb123-73"><a href="#cb123-73" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P3<span class="op">$</span>ROI) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">2</span>)</span>
<span id="cb123-74"><a href="#cb123-74" aria-hidden="true"></a><span class="kw">contrasts</span>(grad_P3<span class="op">$</span>intens) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">5</span>)</span>
<span id="cb123-75"><a href="#cb123-75" aria-hidden="true"></a></span>
<span id="cb123-76"><a href="#cb123-76" aria-hidden="true"></a><span class="co"># Load PDI data</span></span>
<span id="cb123-77"><a href="#cb123-77" aria-hidden="true"></a>grad_pdi =<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;./data/grad_pdi_values.txt&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>, <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>)</span>
<span id="cb123-78"><a href="#cb123-78" aria-hidden="true"></a></span>
<span id="cb123-79"><a href="#cb123-79" aria-hidden="true"></a><span class="co"># Transpose data frame</span></span>
<span id="cb123-80"><a href="#cb123-80" aria-hidden="true"></a>grad_pdi =<span class="st"> </span><span class="kw">gather</span>(grad_pdi, intens, pdi, twent<span class="op">:</span>oneh, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb123-81"><a href="#cb123-81" aria-hidden="true"></a></span>
<span id="cb123-82"><a href="#cb123-82" aria-hidden="true"></a><span class="co"># Recode intensities</span></span>
<span id="cb123-83"><a href="#cb123-83" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens =<span class="st"> </span><span class="kw">as.numeric</span>(grad_pdi<span class="op">$</span>intens)</span>
<span id="cb123-84"><a href="#cb123-84" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;20%&quot;</span></span>
<span id="cb123-85"><a href="#cb123-85" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;40%&quot;</span></span>
<span id="cb123-86"><a href="#cb123-86" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;60%&quot;</span></span>
<span id="cb123-87"><a href="#cb123-87" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;80%&quot;</span></span>
<span id="cb123-88"><a href="#cb123-88" aria-hidden="true"></a>grad_pdi<span class="op">$</span>intens[grad_pdi<span class="op">$</span>intens <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;100%&quot;</span></span>
<span id="cb123-89"><a href="#cb123-89" aria-hidden="true"></a></span>
<span id="cb123-90"><a href="#cb123-90" aria-hidden="true"></a><span class="co"># Rename column for emotion</span></span>
<span id="cb123-91"><a href="#cb123-91" aria-hidden="true"></a><span class="kw">names</span>(grad_pdi)[<span class="dv">1</span>] =<span class="st"> &quot;emotion&quot;</span></span>
<span id="cb123-92"><a href="#cb123-92" aria-hidden="true"></a></span>
<span id="cb123-93"><a href="#cb123-93" aria-hidden="true"></a><span class="co"># Bring information together</span></span>
<span id="cb123-94"><a href="#cb123-94" aria-hidden="true"></a>grad_P3_pdi =<span class="st"> </span><span class="kw">merge</span>(grad_P3, grad_pdi, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>, <span class="st">&quot;intens&quot;</span>))</span>
<span id="cb123-95"><a href="#cb123-95" aria-hidden="true"></a></span>
<span id="cb123-96"><a href="#cb123-96" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb123-97"><a href="#cb123-97" aria-hidden="true"></a>mod_P3 =<span class="st"> </span><span class="kw">lmer</span>(amp <span class="op">~</span><span class="st"> </span>pdi <span class="op">+</span><span class="st"> </span>emotion <span class="op">*</span><span class="st"> </span>intens <span class="op">*</span><span class="st"> </span>group <span class="op">*</span><span class="st"> </span>ROI <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> grad_P3_pdi, </span>
<span id="cb123-98"><a href="#cb123-98" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb123-99"><a href="#cb123-99" aria-hidden="true"></a></span>
<span id="cb123-100"><a href="#cb123-100" aria-hidden="true"></a><span class="co"># Calculate and print ANOVA</span></span>
<span id="cb123-101"><a href="#cb123-101" aria-hidden="true"></a>mod_P3_res =<span class="st"> </span><span class="kw">anova_stats</span>(mod_P3)</span>
<span id="cb123-102"><a href="#cb123-102" aria-hidden="true"></a>mod_P3_res =<span class="st"> </span><span class="kw">subset</span>(mod_P3_res, <span class="dt">select =</span> <span class="op">-</span><span class="kw">c</span>(term, sumsq, meansq, df, etasq, omegasq, </span>
<span id="cb123-103"><a href="#cb123-103" aria-hidden="true"></a>    partial.omegasq, epsilonsq, cohens.f, power))</span>
<span id="cb123-104"><a href="#cb123-104" aria-hidden="true"></a>mod_P3_res =<span class="st"> </span><span class="kw">head</span>(mod_P3_res, <span class="dv">-1</span>)</span>
<span id="cb123-105"><a href="#cb123-105" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(mod_P3_res, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NumDF</th>
<th align="right">DenDF</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">partial.etasq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">pdi</td>
<td align="right">1</td>
<td align="right">124855</td>
<td align="right">0.02</td>
<td align="right">0.90</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion</td>
<td align="right">1</td>
<td align="right">124866</td>
<td align="right">6.79</td>
<td align="right">0.01</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="right">4</td>
<td align="right">124858</td>
<td align="right">0.56</td>
<td align="right">0.69</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">group</td>
<td align="right">1</td>
<td align="right">42</td>
<td align="right">0.03</td>
<td align="right">0.87</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">6.93</td>
<td align="right">0.01</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens</td>
<td align="right">3</td>
<td align="right">124866</td>
<td align="right">4.93</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:group</td>
<td align="right">1</td>
<td align="right">124869</td>
<td align="right">0.92</td>
<td align="right">0.34</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens:group</td>
<td align="right">4</td>
<td align="right">124862</td>
<td align="right">2.13</td>
<td align="right">0.07</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">5.31</td>
<td align="right">0.02</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">intens:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.02</td>
<td align="right">0.39</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">group:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">11.57</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:group</td>
<td align="right">4</td>
<td align="right">124867</td>
<td align="right">5.56</td>
<td align="right">0.00</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">emotion:intens:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.32</td>
<td align="right">0.26</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:group:ROI</td>
<td align="right">1</td>
<td align="right">124846</td>
<td align="right">4.18</td>
<td align="right">0.04</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">intens:group:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.94</td>
<td align="right">0.10</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emotion:intens:group:ROI</td>
<td align="right">4</td>
<td align="right">124846</td>
<td align="right">1.22</td>
<td align="right">0.30</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true"></a>int_emo_group =<span class="st"> </span><span class="kw">emmip</span>(mod_P3, emotion <span class="op">~</span><span class="st"> </span>intens <span class="op">|</span><span class="st"> </span>group, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#333333&quot;</span>, </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true"></a>    <span class="st">&quot;#0098ff&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true"></a></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true"></a>int_emo_group</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_P3_wo_MO_PDI-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_P3_group_emo_intens.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, pairwise <span class="op">~</span><span class="st"> </span>emotion <span class="op">|</span><span class="st"> </span>group <span class="op">|</span><span class="st"> </span>intens)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">group</th>
<th align="left">intens</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">CT</td>
<td align="left">20%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">angry - happy</td>
<td align="left">ZE</td>
<td align="left">20%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">CT</td>
<td align="left">40%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">angry - happy</td>
<td align="left">ZE</td>
<td align="left">40%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">CT</td>
<td align="left">60%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">angry - happy</td>
<td align="left">ZE</td>
<td align="left">60%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">CT</td>
<td align="left">80%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">angry - happy</td>
<td align="left">ZE</td>
<td align="left">80%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">CT</td>
<td align="left">100%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">angry - happy</td>
<td align="left">ZE</td>
<td align="left">100%</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true"></a><span class="co"># Examine interaction</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true"></a>gr_emo_roi =<span class="st"> </span><span class="kw">emmip</span>(mod_P3, group <span class="op">~</span><span class="st"> </span>emotion <span class="op">|</span><span class="st"> </span>ROI, <span class="dt">CIs =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#333333&quot;</span>, </span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true"></a>    <span class="st">&quot;#D97909&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_prism</span>(<span class="dt">base_size =</span> <span class="dv">18</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Expression intensity&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true"></a></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true"></a>gr_emo_roi</span></code></pre></div>
<p><img src="Script_4_Grad_Int_files/figure-html/LMM_grad_P3_wo_MO_PDI-2.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true"></a><span class="co"># Save without white background</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true"></a><span class="kw">ggsave</span>(<span class="st">&quot;./figures/grad_P3_roi_emo_gr.png&quot;</span>, <span class="dt">bg =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true"></a><span class="co"># Calculate and print post-hoc tests</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true"></a>emm_s.t =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, pairwise <span class="op">~</span><span class="st"> </span>emotion <span class="op">|</span><span class="st"> </span>group <span class="op">|</span><span class="st"> </span>ROI)</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emm_s.t<span class="op">$</span>contrasts, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="left">group</th>
<th align="left">ROI</th>
<th align="right">estimate</th>
<th align="right">SE</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">CT</td>
<td align="left">lOT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">angry - happy</td>
<td align="left">ZE</td>
<td align="left">lOT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">angry - happy</td>
<td align="left">CT</td>
<td align="left">rOT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">angry - happy</td>
<td align="left">ZE</td>
<td align="left">rOT</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true"></a>poly_intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;poly&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">3</span>)</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(poly_intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">linear</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">quadratic</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">cubic</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true"></a>m.intens =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, <span class="st">&quot;intens&quot;</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true"></a>intens =<span class="st"> </span><span class="kw">contrast</span>(m.intens, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(intens, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 40%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 60%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">20% - 80%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">20% - 100%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">intens</td>
<td align="left">40% - 60%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">intens</td>
<td align="left">40% - 80%</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true"></a>m.emo =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, <span class="st">&quot;emotion&quot;</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true"></a>emo =<span class="st"> </span><span class="kw">contrast</span>(m.emo, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true"></a></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(emo, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emotion</td>
<td align="left">angry - happy</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true"></a>m.roi =<span class="st"> </span><span class="kw">emmeans</span>(mod_P3, <span class="st">&quot;ROI&quot;</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true"></a>roi =<span class="st"> </span><span class="kw">contrast</span>(m.roi, <span class="st">&quot;tukey&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true"></a><span class="st">    </span>broom<span class="op">::</span><span class="kw">tidy</span>() <span class="op">%&gt;%</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">head</span>(<span class="dv">6</span>)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true"></a></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">kable</span>(roi, <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">df</th>
<th align="right">z.ratio</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ROI</td>
<td align="left">lOT - rOT</td>
<td align="right">0</td>
<td align="right">-0.34</td>
<td align="right">0.13</td>
<td align="right">Inf</td>
<td align="right">-2.6</td>
<td align="right">0.01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<!-- Provide session info  -->
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true"></a><span class="co"># Get session info</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.2 (2020-06-22)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19044)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] sjlabelled_1.1.7   sjmisc_2.8.6       Rmisc_1.5          plyr_1.8.6        
 [5] lattice_0.20-41    png_0.1-7          multcomp_1.4-16    TH.data_1.0-10    
 [9] MASS_7.3-53.1      survival_3.2-10    mvtnorm_1.1-1      ggstatsplot_0.7.2 
[13] ggpubr_0.4.0       ggpmisc_0.3.9      EnvStats_2.4.0     eegUtils_0.5.0    
[17] eegkit_1.0-4       signal_0.7-6       rgl_0.106.8        ica_1.0-2         
[21] bigsplines_1.1-1   quadprog_1.5-8     eegkitdata_1.0     cowplot_1.1.1     
[25] sjstats_0.18.1     sjPlot_2.8.7       psycho_0.6.1       pander_0.6.3      
[29] lmerTest_3.1-3     ggprism_1.0.3      emmeans_1.5.5-1    corrplot_0.84     
[33] car_3.0-10         carData_3.0-4      afex_0.28-1        lme4_1.1-26       
[37] Matrix_1.3-2       summarytools_0.9.9 rmdformats_1.0.2   gtsummary_1.4.0   
[41] XLConnect_1.0.3    tidyr_1.1.3        rstatix_0.7.0      miceadds_3.11-6   
[45] mice_3.13.0        kableExtra_1.3.4   expss_0.10.7       eeptools_1.2.4    
[49] ggplot2_3.3.3      dplyr_1.0.5       

loaded via a namespace (and not attached):
 [1] estimability_1.3       R.methodsS3_1.8.1      coda_0.19-4           
 [4] knitr_1.32             R.utils_2.10.1         data.table_1.14.0     
 [7] rpart_4.1-15           generics_0.1.0         commonmark_1.7        
[10] future_1.21.0          correlation_0.6.1      webshot_0.5.2         
[13] xml2_1.3.2             lubridate_1.7.10       httpuv_1.5.5          
[16] assertthat_0.2.1       viridis_0.6.0          WRS2_1.1-1            
[19] xfun_0.22              hms_1.0.0              jquerylib_0.1.3       
[22] rJava_0.9-13           evaluate_0.14          promises_1.2.0.1      
[25] fansi_0.4.2            readxl_1.3.1           DBI_1.1.1             
[28] htmlwidgets_1.5.3      reshape_0.8.8          kSamples_1.2-9        
[31] paletteer_1.3.0        Rmpfr_0.8-4            purrr_0.3.4           
[34] ellipsis_0.3.1         crosstalk_1.1.1        backports_1.2.1       
[37] bookdown_0.21          insight_0.13.2         ggcorrplot_0.1.3      
[40] rapportools_1.0        pwr_1.3-0              vctrs_0.3.7           
[43] abind_1.4-5            cachem_1.0.4           withr_2.4.2           
[46] pryr_0.1.4             checkmate_2.0.0        vcd_1.4-8             
[49] svglite_2.0.0          cluster_2.1.2          lazyeval_0.2.2        
[52] crayon_1.4.1           SuppDists_1.1-9.5      pkgconfig_2.0.3       
[55] labeling_0.4.2         statsExpressions_1.0.1 nlme_3.1-152          
[58] nnet_7.3-15            rlang_0.4.10           globals_0.14.0        
[61] lifecycle_1.0.0        miniUI_0.1.1.1         MatrixModels_0.5-0    
[64] sandwich_3.0-0         extrafontdb_1.0        modelr_0.1.8          
[67] cellranger_1.1.0       tcltk_4.0.2            matrixStats_0.58.0    
[70] lmtest_0.9-38          mc2d_0.1-19            boot_1.3-27           
[73] zoo_1.8-9              base64enc_0.1-3        viridisLite_0.4.0     
 [ reached getOption(&quot;max.print&quot;) -- omitted 102 entries ]</code></pre>
</div>
</div>

<div class="col-xs-2">

<div class = "btn-toolbar">
<div class="btn-group">
<a class="btn btn-raised btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="#"><span>Code</span> <span class="caret"></span></a>
<ul class="dropdown-menu" style="min-width: 50px;">

<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>

</ul>
</div>
</div>

</div>
</div>
	


</div>
</div>

 <script>
    $(document).ready(function () {
	// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');
	
	
		$('.pages img').addClass("image-lb");
	$('.pages').magnificPopup({
	    type:'image',
	    closeOnContentClick: false,
	    closeBtnInside: false,
            delegate: '.image-lb',
	    gallery: {enabled: true },
            removalDelay: 500,
            callbacks: {
		beforeOpen: function() {
                    // just a hack that adds mfp-anim class to markup
                    this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
		}
            },
            mainClass: 'mfp-move-from-top',
	    image: {
	        verticalFit: true,
		titleSrc: 'alt'
	    }
 	});
 	
	  
	$('#toc ul li').first().addClass("active");
	$('#toc ul li').attr("data-target", function() {
            return($(this).children("a").attr("href"));
	})
	$('body .section.level1').first().addClass("active");
	$('body .section.level1').not('.active').hide();
	
	$('#toc a[href*="#"], a[href^="#"]').click(function() {
	    var id = $(this).attr("href");
	    if (id === "#") return;
	    if (id.substring(0, 8) === "#dyntab-") return;
	    // Menu
	    var menu_entry = $(".menu li[data-target='"+id+"']");
	    if (menu_entry.length == 0) {
		window.location.hash = id;
		return;
	    }
	    menu_entry.addClass("active");
	    $(".menu li").not(menu_entry).removeClass("active"); 
	    toggle_page(id);
	});

	function toggle_page(id) {
	    $(".page").not(page).removeClass("active").hide();
	    window.page = id;
	    var page = $(window.page);
	    window.location.hash = window.page;
	    //$(this).addClass("active");
	    page.show();

	    var totop = setInterval(function () {
		$(".pages").animate({scrollTop: 0}, 0);
	    }, 10);

	    setTimeout(function () {
		page.addClass("active");
		setTimeout(function () {
		    clearInterval(totop);
		}, 1000);
	    }, 100);
	    
	    window.dispatchEvent(new Event('resize'));
	}


	$(".menu li").click(function () {
	    toggle_page($(this).data("target"));
	    // Menu
	    if (!$(this).data("target")) return;
	    if ($(this).is(".active")) return;
	    $(".menu li").not($(this)).removeClass("active");
	    $(this).addClass("active");
	});
  
	  
	window.page = window.location.hash;
	if (window.page != "") {
	    $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
	}
	/* init material bootstrap js */
	$.material.init();
    });
 </script>


  <!-- dynamically load mathjax for compatibility with self-contained -->
 <script>
   (function () {
       var script = document.createElement("script");
       script.type = "text/javascript";
       script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
       document.getElementsByTagName("head")[0].appendChild(script);
   })();
 </script>
 
</body>
</html>
